<!DOCTYPE html><html>

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prescriptive Topology Manager P T M | Cumulus Networks Documentation</title>

<link href="https://fonts.googleapis.com/css?family=Oxygen|Oxygen+Mono:300,400,700" rel="stylesheet">
<link rel="stylesheet" href="/normalize.min.css">

<link rel="stylesheet" href="/book.min.20b2cb98a9208e1e7497525a9f78f7f8eb0ca4b5f4551e9610f12c5b317e6be8.css">

<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>

<body>
  <input type="checkbox" style="display: none" id="menu-control" />
  <main class="flex container">

    <aside class="book-menu fixed">
      <nav role="navigation">
<h2 class="book-brand">
  <a href="http://example.org/">Cumulus Networks Documentation</a>
</h2>



    


  
  
    
  
 
  <ul>
    
    <li><a href="/Cumulus-Linux/installation-management/">
    Installation Management</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/installation-management/Adding_and_Updating_Packages/">Adding and Updating Packages</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/installation-management/Installing_a_New_Cumulus_Linux_Image/">Installing a New Cumulus Linux Image</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/installation-management/Managing_Cumulus_Linux_Disk_Images/">Managing Cumulus Linux Disk Images</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/installation-management/Upgrading_Cumulus_Linux/">Upgrading Cumulus Linux</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/installation-management/Using_Snapshots/">Using Snapshots</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/installation-management/Zero_Touch_Provisioning_-_ZTP/">Zero Touch Provisioning Z T P</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/Cumulus-Linux/layer1-switch-ports/">
    Layer1 Switch Ports</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/802.1X_Interfaces/">802.1 X Interfaces</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/Buffer_and_Queue_Management/">Buffer and Queue Management</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/DHCP_Relays/">D H C P Relays</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/DHCP_Servers/">D H C P Servers</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/Facebook_Voyager_Optical_Interfaces/">Facebook Voyager Optical Interfaces</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/Prescriptive_Topology_Manager_-_PTM/" class="active">Prescriptive Topology Manager P T M</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/interface_configuration_and_management/Interface_Configuration_and_Management/">Interface Configuration and Management</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/interface_configuration_and_management/switch_port_attributes/Switch_Port_Attributes/">Switch Port Attributes</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/Cumulus-Linux/layer2/">
    Layer2</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/layer2/Copy_of_Prescriptive_Topology_Manager_-_PTM/">Copy of Prescriptive Topology Manager P T M</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/Copy_of_Spanning_Tree_and_Rapid_Spanning_Tree/">Copy of Spanning Tree and Rapid Spanning Tree</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/Ethernet_Bridging_-_VLANs/">Ethernet Bridging v L a Ns</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/IGMP_and_MLD_Snooping/">I G M P and M L D Snooping</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/LACP_Bypass/">L a C P Bypass</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/Link_Layer_Discovery_Protocol/">Link Layer Discovery Protocol</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/Multi-Chassis_Link_Aggregation_-_MLAG/">Multi Chassis Link Aggregation M L a G</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/Spanning_Tree_and_Rapid_Spanning_Tree/">Spanning Tree and Rapid Spanning Tree</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/Virtual_Router_Redundancy_-_VRR/">Virtual Router Redundancy v R R</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/bonding_link_aggregation/Bonding_-_Link_Aggregation/">Bonding Link Aggregation</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/ethernet_bridging_vlans/Traditional_Bridge_Mode/">Traditional Bridge Mode</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/ethernet_bridging_vlans/VLAN-aware_Bridge_Mode/">V L a N Aware Bridge Mode</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/ethernet_bridging_vlans/VLAN_Tagging/">V L a N Tagging</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/link_layer_discovery_protocol/voice_vlan/Voice_VLAN/">Voice v L a N</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/virtual_router_redundancy/ifplugd/ifplugd/">Ifplugd</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/Cumulus-Linux/layer3/">
    Layer3</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/layer3/Address_Resolution_Protocol_-_ARP/">Address Resolution Protocol a R P</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Bidirectional_Forwarding_Detection_-_BFD/">Bidirectional Forwarding Detection B F D</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Border_Gateway_Protocol_-_BGP/">Border Gateway Protocol B G P</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Configuring_FRRouting/">Configuring F R Routing</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Equal_Cost_Multipath_Load_Sharing_-_Hardware_ECMP/">Equal Cost Multipath Load Sharing Hardware E C M P</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/FRRouting_Overview/">F R Routing Overview</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/GRE_Tunneling/">G R E Tunneling</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Introduction_to_Routing_Protocols/">Introduction to Routing Protocols</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Management_VRF/">Management v R F</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Network_Topology/">Network Topology</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Open_Shortest_Path_First_-_OSPF/">Open Shortest Path First O S P F</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Open_Shortest_Path_First_v3_-_OSPFv3/">Open Shortest Path First V3 O S P Fv3</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Policy-based_Routing/">Policy Based Routing</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Protocol_Independent_Multicast_-_PIM/">Protocol Independent Multicast P I M</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Redistribute_Neighbor/">Redistribute Neighbor</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Routing/">Routing</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Segment_Routing/">Segment Routing</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Virtual_Routing_and_Forwarding_-_VRF/">Virtual Routing and Forwarding v R F</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/configuring_frrouting/comparing_nclu_and_vtysh_commands/Comparing_NCLU_and_vtysh_Commands/">Comparing N C L U and Vtysh Commands</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/frrouting_overview/Upgrading_from_Quagga_to_FRRouting/">Upgrading From Quagga to F R Routing</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/Cumulus-Linux/monitoring-troubleshooting/">
    Monitoring Troubleshooting</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/ASIC_Monitoring/">A S I C Monitoring</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/FRRouting_Log_Message_Reference/">F R Routing Log Message Reference</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Monitoring_Best_Practices/">Monitoring Best Practices</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Monitoring_System_Hardware/">Monitoring System Hardware</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Monitoring_Virtual_Device_Counters/">Monitoring Virtual Device Counters</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Network_Troubleshooting/">Network Troubleshooting</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Resource_Diagnostics_Using_cl-resource-query/">Resource Diagnostics Using Cl Resource Query</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Simple_Network_Management_Protocol_SNMP_Monitoring/">Simple Network Management Protocol S N M P Monitoring</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Single_User_Mode_-_Boot_Recovery/">Single User Mode Boot Recovery</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Troubleshooting_Network_Interfaces/">Troubleshooting Network Interfaces</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Understanding_the_cl-support_Output_File/">Understanding the Cl Support Output File</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/monitoring_system_hardware/network_switch_port_led_and_stats_led/Network_Switch_Port_LED_and_Status_LED_Guidelines/">Network Switch Port L E D and Status L E D Guidelines</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/network_troubleshooting/monitoring_system_statistics/Monitoring_System_Statistics_and_Network_Traffic_with_sFlow/">Monitoring System Statistics and Network Traffic With S Flow</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/network_troubleshooting/using_nclu_to_troubleshoot/Using_NCLU_to_Troubleshoot_Your_Network_Configuration/">Using N C L U to Troubleshoot Your Network Configuration</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/simple_network_management/using_nutanix_prisim_as_monitoring_tool/Using_Nutanix_Prism_as_a_Monitoring_Tool/">Using Nutanix Prism as a Monitoring Tool</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/switchd_Log_Message_Reference/">Switchd Log Message Reference</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/troubleshooting_network_interfaces/monitoring_interfaces_and_transcievers_using_ethtool/Monitoring_Interfaces_and_Transceivers_Using_ethtool/">Monitoring Interfaces and Transceivers Using Ethtool</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/understanding_cl-support_output_file/troubleshooting_log_files/Troubleshooting_Log_Files/">Troubleshooting Log Files</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/understanding_cl-support_output_file/troubleshooting_the_etc_directory/Troubleshooting_the_etc_Directory/">Troubleshooting the Etc Directory</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/Cumulus-Linux/network-solutions/">
    Network Solutions</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/network-solutions/Anycast_Design_Guide/">Anycast Design Guide</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-solutions/Cumulus_Hyperconverged_Solution_with_Nutanix/">Cumulus Hyperconverged Solution With Nutanix</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-solutions/Cumulus_Networks_Services_Demos/">Cumulus Networks Services Demos</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-solutions/Data_Center_Host_to_ToR_Architecture/">Data Center Host to to R Architecture</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-solutions/Docker_on_Cumulus_Linux/">Docker on Cumulus Linux</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-solutions/OpenStack_Neutron_ML2_and_Cumulus_Linux/">Open Stack Neutron M L2 and Cumulus Linux</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-solutions/RDMA_over_Converged_Ethernet_-_RoCE/">R D M a Over Converged Ethernet Ro C E</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/Cumulus-Linux/network-visualization/">
    Network Visualization</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/network-visualization/Eng_Update_of_VXLAN_Hyperloop/">Eng Update of v X L a N Hyperloop</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/Ethernet_Virtual_Private_Network_-_EVPN/">Ethernet Virtual Private Network E v P N</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/Hybrid_Cloud_Connectivity_with_QinQ_and_VXLANs/">Hybrid Cloud Connectivity With Qin Q and v X L a Ns</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/LNV_Full_Example/">L N v Full Example</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/Lightweight_Network_Virtualization_Overview/">Lightweight Network Virtualization Overview</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/Static_VXLAN_Configurations/">Static v X L a N Configurations</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/VXLAN_Routing/">V X L a N Routing</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/VXLAN_Scale/">V X L a N Scale</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/VXLAN_Tunnel_DSCP_Operations__DRAFT/">V X L a N Tunnel D S C P Operations — D R a F T</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/Virtualization_Integrations/">Virtualization Integrations</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/static_vxlan_configurations/static_mac_bindings/Static_MAC_Bindings_with_VXLAN/">Static M a C Bindings With v X L a N</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/static_vxlan_configurations/static_vxlan_tunnels/Static_VXLAN_Tunnels/">Static v X L a N Tunnels</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/virtualization_integrations/integrating_hardware_vteps_vmware_nsx-mh/Integrating_Hardware_VTEPs_with_VMware_NSX-MH/">Integrating Hardware v T E Ps With v Mware N S X M H</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/virtualization_integrations/integrating_vteps_midonet_openstack/Integrating_Hardware_VTEPs_with_Midokura_MidoNet_and_OpenStack/">Integrating Hardware v T E Ps With Midokura Mido Net and Open Stack</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/virtualization_integrations/integrating_vteps_vmware_nsx-v/Integrating_Hardware_VTEPs_with_VMware_NSX-V/">Integrating Hardware v T E Ps With v Mware N S X V</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/virtualization_integrations/ovsdb_server_high_availability/OVSDB_Server_High_Availability/">O v S D B Server High Availability</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/Cumulus-Linux/system-config/">
    System Config</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/system-config/Authentication_Authorization_and_Accounting/">Authentication Authorization and Accounting</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Configuring_a_Global_Proxy/">Configuring a Global Proxy</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Configuring_switchd/">Configuring Switchd</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Copy_of_Netfilter_-_ACLs/">Copy of Netfilter a C Ls</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/HTTP_API/">H T T P a P I</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Netfilter_-_ACLs/">Netfilter a C Ls</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Network_Command_Line_Utility_-_NCLU/">Network Command Line Utility N C L U</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Power_over_Ethernet_-_PoE/">Power Over Ethernet Po E</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Services_and_Daemons_in_Cumulus_Linux/">Services and Daemons in Cumulus Linux</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Setting_Date_and_Time/">Setting Date and Time</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/authentication_authorization_accounting/LDAP_Authentication_and_Authorization/">L D a P Authentication and Authorization</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/authentication_authorization_accounting/RADIUS_AAA/">R a D I U S a a A</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/authentication_authorization_accounting/SSH_for_Remote_Access/">S S H for Remote Access</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/authentication_authorization_accounting/TACACS_Plus/">T a C a C S Plus</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/authentication_authorization_accounting/User_Accounts/">User Accounts</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/authentication_authorization_accounting/Using_sudo_to_Delegate_Privileges/">Using Sudo to Delegate Privileges</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/netfilter_acls/default_cumulus_linux_acl_config/Default_Cumulus_Linux_ACL_Configuration/">Default Cumulus Linux a C L Configuration</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/netfilter_acls/default_cumulus_linux_acl_config/Filtering_Learned_MAC_Addresses/">Filtering Learned M a C Addresses</a>
    </li>
    
  </ul>

    </li>
    

    
    <li>
      <a href="/Cumulus-Linux/whats-new/">What&#39;s New</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/cumulus-linux-index/Cumulus_Linux_Index/">Cumulus Linux Index</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/quick-start/Quick_Start_Guide/">Quick Start Guide</a>
    </li>
    
  </ul>
 
  <ul>
    
    <li><a href="/NetQ/Cumulus_NetQ_UI_User_Guide/">
    Cumulus Net Q U I User Guide</a> 
  <ul>
    
    <li><a href="/NetQ/Cumulus_NetQ_UI_User_Guide/monitor_the_network/">
    Monitor the Network</a> 
  <ul>
    

    
    <li>
      <a href="/NetQ/Cumulus_NetQ_UI_User_Guide/monitor_the_network/Monitor_Alarm_Events/">Monitor Alarm Events</a>
    </li>
    
    <li>
      <a href="/NetQ/Cumulus_NetQ_UI_User_Guide/monitor_the_network/Monitor_Informational_Events/">Monitor Informational Events</a>
    </li>
    
    <li>
      <a href="/NetQ/Cumulus_NetQ_UI_User_Guide/monitor_the_network/Monitor_Network_Health/">Monitor Network Health</a>
    </li>
    
    <li>
      <a href="/NetQ/Cumulus_NetQ_UI_User_Guide/monitor_the_network/Monitor_Network_Inventory/">Monitor Network Inventory</a>
    </li>
    
    <li>
      <a href="/NetQ/Cumulus_NetQ_UI_User_Guide/monitor_the_network/Monitor_Network_Protocols_and_Services/">Monitor Network Protocols and Services</a>
    </li>
    
    <li>
      <a href="/NetQ/Cumulus_NetQ_UI_User_Guide/monitor_the_network/NetQ_User_Interface_Overview/">Net Q User Interface Overview</a>
    </li>
    
  </ul>

    </li>
    

    
    <li>
      <a href="/NetQ/Cumulus_NetQ_UI_User_Guide/Monitor_Switches/">Monitor Switches</a>
    </li>
    
    <li>
      <a href="/NetQ/Cumulus_NetQ_UI_User_Guide/NetQ_User_Interface_Overview/">Net Q User Interface Overview</a>
    </li>
    
    <li>
      <a href="/NetQ/Cumulus_NetQ_UI_User_Guide/UI_Preface/">U I Preface</a>
    </li>
    
    <li>
      <a href="/NetQ/Cumulus_NetQ_UI_User_Guide/Validate_Network_Protocol_and_Service_Operations/">Validate Network Protocol and Service Operations</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/NetQ/cli_user_guide/">
    Cli User Guide</a> 
  <ul>
    

    
    <li>
      <a href="/NetQ/cli_user_guide/CLI_Preface/CLI_Preface/">C L I Preface</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/automate_common_tasks/Automate_Common_and_Repetitive_Tasks/">Automate Common and Repetitive Tasks</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/command_line_overview/NetQ_Command_Line_Overview/">Net Q Command Line Overview</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/monitor_containter_environments/Monitor_Container_Environments/">Monitor Container Environments</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/monitor_data_link_layer/Monitor_Data_Link_Layer_Devices_and_Protocols/">Monitor Data Link Layer Devices and Protocols</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/monitor_linux_hosts/Monitor_Linux_Hosts/">Monitor Linux Hosts</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/monitor_network_health/Monitor_Overall_Network_Health/">Monitor Overall Network Health</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/monitor_network_layer/Monitor_Network_Protocols_and_Services/">Monitor Network Protocols and Services</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/monitor_physical_layer/Monitor_Physical_Layer_Components/">Monitor Physical Layer Components</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/monitor_switch_hardware/Monitor_Switch_Hardware_and_Software/">Monitor Switch Hardware and Software</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/monitor_virtual_overlays/Monitor_Virtual_Network_Overlays/">Monitor Virtual Network Overlays</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/resolve_issues/Resolve_Issues/">Resolve Issues</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/resolve_issues/Resolve_MLAG_Issues/">Resolve M L a G Issues</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/resolve_issues/investiage_netq_issues/Investigate_NetQ_Issues/">Investigate Net Q Issues</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/resolve_issues/methods_for_diagnosing_issues/Methods_for_Diagnosing_Network_Issues/">Methods for Diagnosing Network Issues</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/NetQ/deployment_guide/">
    Deployment Guide</a> 
  <ul>
    

    
    <li>
      <a href="/NetQ/deployment_guide/config_optional_netq/Configuring_Optional_NetQ_Capabilities/">Configuring Optional Net Q Capabilities</a>
    </li>
    
    <li>
      <a href="/NetQ/deployment_guide/deployment_preface/Deployment_Preface/">Deployment Preface</a>
    </li>
    
    <li>
      <a href="/NetQ/deployment_guide/install_netq/Install_NetQ/">Install Net Q</a>
    </li>
    
    <li>
      <a href="/NetQ/deployment_guide/maintain_netq/Maintain_NetQ/">Maintain Net Q</a>
    </li>
    
    <li>
      <a href="/NetQ/deployment_guide/netq_primer/Cumulus_NetQ_Primer/">Cumulus Net Q Primer</a>
    </li>
    
  </ul>

    </li>
    

    
    <li>
      <a href="/NetQ/Release_Notes/Cumulus_NetQ_2.0_Release_Notes/">Cumulus Net Q 2.0 Release Notes</a>
    </li>
    
    <li>
      <a href="/NetQ/getting_started/Getting_Started_with_the_Cumulus_NetQ_Appliance/">Getting Started With the Cumulus Net Q Appliance</a>
    </li>
    
    <li>
      <a href="/NetQ/software_installation_guide/Cumulus_NetQ_Appliance_Software_Installation_Guide/">Cumulus Net Q Appliance Software Installation Guide</a>
    </li>
    
  </ul>








</nav>

    </aside>

    <div class="book-page">
      <header class="align-center justify-between book-header">
  <label for="menu-control">
    <img src="/svg/menu.svg" />
  </label>
  <strong>Prescriptive Topology Manager P T M</strong>
</header>

      
<article class="markdown">

<h1 id="prescriptive-topology-manager-ptm">Prescriptive Topology Manager - PTM</h1>

<p>In data center topologies, right cabling is a time-consuming endeavor
and is error prone. Prescriptive Topology Manager (PTM) is a dynamic
cabling verification tool to help detect and eliminate such errors. It
takes a Graphviz-DOT specified network cabling plan (something many
operators already generate), stored in a <code>topology.dot</code> file, and
couples it with runtime information derived from LLDP to verify that the
cabling matches the specification. The check is performed on every link
transition on each node in the network.</p>

<p>You can customize the <code>topology.dot</code> file to control <code>ptmd</code> at both the
global/network level and the node/port level.</p>

<p>PTM runs as a daemon, named <code>ptmd</code>.</p>

<p>For more information, see <code>man ptmd(8)</code>.</p>

<h2 id="contents">Contents</h2>

<p><img src="images/icons/grey_arrow_down.png" alt="" />{.expand-control-image}This topic
describes &hellip;</p>

<ul>
<li><a href="#PrescriptiveTopologyManager-PTM-SupportedFeatures">Supported
Features</a></li>
<li><a href="#PrescriptiveTopologyManager-PTM-configuringConfigurePTM">Configure
PTM</a></li>
<li><a href="#PrescriptiveTopologyManager-PTM-exampleBasicTopologyExample">Basic Topology
Example</a></li>
<li><a href="#PrescriptiveTopologyManager-PTM-advancedptmdScripts">ptmd Scripts</a></li>
<li><a href="#PrescriptiveTopologyManager-PTM-ConfigurationParameters">Configuration
Parameters</a>

<ul>
<li><a href="#PrescriptiveTopologyManager-PTM-Host-onlyParameters">Host-only
Parameters</a></li>
<li><a href="#PrescriptiveTopologyManager-PTM-GlobalParameters">Global
Parameters</a></li>
<li><a href="#PrescriptiveTopologyManager-PTM-Per-portParameters">Per-port
Parameters</a></li>
<li><a href="#PrescriptiveTopologyManager-PTM-Templates">Templates</a></li>
<li><a href="#PrescriptiveTopologyManager-PTM-SupportedBFDandLLDPParameters">Supported BFD and LLDP
Parameters</a></li>
</ul></li>
<li><a href="#PrescriptiveTopologyManager-PTM-bfdBidirectionalForwardingDetection(BFD)">Bidirectional Forwarding Detection
(BFD)</a></li>
<li><a href="#PrescriptiveTopologyManager-PTM-frrCheckLinkStatewithFRRouting">Check Link State with
FRRouting</a></li>
<li><a href="#PrescriptiveTopologyManager-PTM-ptmd_commandsptmdServiceCommands">ptmd Service
Commands</a></li>
<li><a href="#PrescriptiveTopologyManager-PTM-ptmctlCommands">ptmctl Commands</a>

<ul>
<li><a href="#PrescriptiveTopologyManager-PTM-ptmctlExamples">ptmctl
Examples</a></li>
<li><a href="#PrescriptiveTopologyManager-PTM-ptmctlErrorOutputs">ptmctl Error
Outputs</a></li>
</ul></li>
<li><a href="#PrescriptiveTopologyManager-PTM-CaveatsandErrata">Caveats and
Errata</a></li>
<li><a href="#PrescriptiveTopologyManager-PTM-RelatedInformation">Related
Information</a></li>
</ul>

<h2 id="supported-features">Supported Features</h2>

<ul>
<li>Topology verification using LLDP. <code>ptmd</code> creates a client connection
to the LLDP daemon, <code>lldpd</code>, and retrieves the neighbor relationship
between the nodes/ports in the network and compares them against the
prescribed topology specified in the <code>topology.dot</code> file.</li>
<li>Only physical interfaces, like swp1 or eth0, are currently
supported. Cumulus Linux does not support specifying virtual
interfaces like bonds or subinterfaces like eth0.200 in the topology
file.</li>
<li>Forwarding path failure detection using <a href="http://tools.ietf.org/html/rfc5880">Bidirectional Forwarding
Detection</a> (BFD); however,
demand mode is not supported. For more information on how BFD
operates in Cumulus Linux, read the <a href="Bidirectional_Forwarding_Detection_-_BFD">Bidirectional Forwarding
Detection - BFD</a> chapter
and read <code>man ptmd(8)</code>.</li>
<li>Integration with FRRouting (PTM to FRRouting notification).</li>
<li>Client management: <code>ptmd</code> creates an abstract named socket
<code>/var/run/ptmd.socket</code> on startup. Other applications can connect to
this socket to receive notifications and send commands.</li>
<li>Event notifications: see Scripts below.</li>
<li>User configuration via a <code>topology.dot</code> file; <a href="#PrescriptiveTopologyManager-PTM-configuring">see
below</a>.</li>
</ul>

<h2 id="configure-ptm">Configure PTM</h2>

<p><code>ptmd</code> verifies the physical network topology against a DOT-specified
network graph file, <code>/etc/ptm.d/topology.dot</code>.</p>

<p>PTM supports <a href="http://en.wikipedia.org/wiki/DOT_%28graph_description_language%29">undirected
graphs</a>.</p>

<p>At startup, <code>ptmd</code> connects to <code>lldpd</code>, the LLDP daemon, over a Unix
socket and retrieves the neighbor name and port information. It then
compares the retrieved port information with the configuration
information that it read from the topology file. If there is a match,
then it is a PASS, else it is a FAIL.</p>

<p>PTM performs its LLDP neighbor check using the PortID ifname TLV
information. Previously, it used the PortID port description TLV
information.</p>

<h2 id="basic-topology-example">Basic Topology Example</h2>

<p>This is a basic example DOT file and its corresponding topology diagram.
You should use the same <code>topology.dot</code> file on all switches, and don&rsquo;t
split the file per device; this allows for easy automation by
pushing/pulling the same exact file on each device!</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">graph G {
    &#34;spine1&#34;:&#34;swp1&#34; -- &#34;leaf1&#34;:&#34;swp1&#34;;
    &#34;spine1&#34;:&#34;swp2&#34; -- &#34;leaf2&#34;:&#34;swp1&#34;;
    &#34;spine2&#34;:&#34;swp1&#34; -- &#34;leaf1&#34;:&#34;swp2&#34;;
    &#34;spine2&#34;:&#34;swp2&#34; -- &#34;leaf2&#34;:&#34;swp2&#34;;
    &#34;leaf1&#34;:&#34;swp3&#34; -- &#34;leaf2&#34;:&#34;swp3&#34;;
    &#34;leaf1&#34;:&#34;swp4&#34; -- &#34;leaf2&#34;:&#34;swp4&#34;;
    &#34;leaf1&#34;:&#34;swp5s0&#34; -- &#34;server1&#34;:&#34;eth1&#34;;
    &#34;leaf2&#34;:&#34;swp5s0&#34; -- &#34;server2&#34;:&#34;eth1&#34;;
}</code></pre></div>
<p><img src="attachments/8363021/8363020.png" alt="" />{width=&ldquo;500&rdquo;}</p>

<h2 id="ptmd-scripts">ptmd Scripts</h2>

<p><code>ptmd</code> executes scripts at <code>/etc/ptm.d/if-topo-pass</code> and
<code>/etc/ptm.d/if-topo-fail </code>for each interface that goes through a change,
running <code>if-topo-pass</code> when an LLDP or BFD check passes and running
<code>if-topo-fails</code> when the check fails. The scripts receive an argument
string that is the result of the <code>ptmctl</code> command, described in the 
<a href="#PrescriptiveTopologyManager-PTM-ptmd_commands"><code>ptmd</code> commands section
below</a>.</p>

<p>You should modify these default scripts as needed.</p>

<h2 id="configuration-parameters">Configuration Parameters</h2>

<p>You can configure <code>ptmd</code> parameters in the topology file. The parameters
are classified as host-only, global, per-port/node and templates.</p>

<h3 id="host-only-parameters">Host-only Parameters</h3>

<p><em>Host-only parameters</em> apply to the entire host on which PTM is running.
You can include the <code>hostnametype</code> host-only parameter, which specifies
whether PTM should use only the host name (<code>hostname</code>) or the
fully-qualified domain name (<code>fqdn</code>) while looking for the <code>self-node</code>
in the graph file. For example, in the graph file below, PTM will ignore
the FQDN and only look for <em>switch04</em>, since that is the host name of
the switch it&rsquo;s running on:</p>

<p>It’s a good idea to always wrap the hostname in double quotes, like
<em>&ldquo;www.example.com&rdquo;</em>. Otherwise, <code>ptmd</code> can fail if you specify a
fully-qualified domain name as the hostname and do not wrap it in double
quotes.</p>

<p>Further, to avoid errors when starting the <code>ptmd</code> process, make sure
that <code>/etc/hosts</code> and <code>/etc/hostname</code> both reflect the hostname you are
using in the <code>topology.dot</code> file.</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">graph G {
         hostnametype=&#34;hostname&#34;
         BFD=&#34;upMinTx=150,requiredMinRx=250&#34;
         &#34;cumulus&#34;:&#34;swp44&#34; -- &#34;switch04.cumulusnetworks.com&#34;:&#34;swp20&#34;
         &#34;cumulus&#34;:&#34;swp46&#34; -- &#34;switch04.cumulusnetworks.com&#34;:&#34;swp22&#34;
}</code></pre></div>
<p>However, in this next example, PTM will compare using the FQDN and look
for <em>switch05.cumulusnetworks.com</em>, which is the FQDN of the switch it’s
running on:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">graph G {
         hostnametype=&#34;fqdn&#34;
         &#34;cumulus&#34;:&#34;swp44&#34; -- &#34;switch05.cumulusnetworks.com&#34;:&#34;swp20&#34;
         &#34;cumulus&#34;:&#34;swp46&#34; -- &#34;switch05.cumulusnetworks.com&#34;:&#34;swp22&#34;
}</code></pre></div>
<h3 id="global-parameters">Global Parameters</h3>

<p><em>Global parameters</em> apply to every port listed in the topology file.
There are two global parameters: LLDP and BFD. LLDP is enabled by
default; if no keyword is present, default values are used for all
ports. However, BFD is disabled if no keyword is present, unless there
is a per-port override configured. For example:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">graph G {
         LLDP=&#34;&#34;
         BFD=&#34;upMinTx=150,requiredMinRx=250,afi=both&#34;
         &#34;cumulus&#34;:&#34;swp44&#34; -- &#34;qct-ly2-04&#34;:&#34;swp20&#34;
         &#34;cumulus&#34;:&#34;swp46&#34; -- &#34;qct-ly2-04&#34;:&#34;swp22&#34;
}</code></pre></div>
<h3 id="per-port-parameters">Per-port Parameters</h3>

<p><em>Per-port parameters</em> provide finer-grained control at the port level.
These parameters override any global or compiled defaults. For example:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">graph G {
         LLDP=&#34;&#34;
         BFD=&#34;upMinTx=300,requiredMinRx=100&#34;
         &#34;cumulus&#34;:&#34;swp44&#34; -- &#34;qct-ly2-04&#34;:&#34;swp20&#34; [BFD=&#34;upMinTx=150,requiredMinRx=250,afi=both&#34;]
         &#34;cumulus&#34;:&#34;swp46&#34; -- &#34;qct-ly2-04&#34;:&#34;swp22&#34;
}</code></pre></div>
<h3 id="templates">Templates</h3>

<p><em>Templates</em> provide flexibility in choosing different parameter
combinations and applying them to a given port. A template
instructs <code>ptmd</code> to reference a named parameter string instead of a
default one. There are two parameter strings <code>ptmd</code> supports:</p>

<ul>
<li><code>bfdtmpl</code>, which specifies a custom parameter tuple for BFD.</li>
<li><code>lldptmpl</code>, which specifies a custom parameter tuple for LLDP.</li>
</ul>

<p>For example:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">graph G {
         LLDP=&#34;&#34;
         BFD=&#34;upMinTx=300,requiredMinRx=100&#34;
         BFD1=&#34;upMinTx=200,requiredMinRx=200&#34;
         BFD2=&#34;upMinTx=100,requiredMinRx=300&#34;
         LLDP1=&#34;match_type=ifname&#34;
         LLDP2=&#34;match_type=portdescr&#34;
         &#34;cumulus&#34;:&#34;swp44&#34; -- &#34;qct-ly2-04&#34;:&#34;swp20&#34; [BFD=&#34;bfdtmpl=BFD1&#34;, LLDP=&#34;lldptmpl=LLDP1&#34;]
         &#34;cumulus&#34;:&#34;swp46&#34; -- &#34;qct-ly2-04&#34;:&#34;swp22&#34; [BFD=&#34;bfdtmpl=BFD2&#34;, LLDP=&#34;lldptmpl=LLDP2&#34;]
         &#34;cumulus&#34;:&#34;swp46&#34; -- &#34;qct-ly2-04&#34;:&#34;swp22&#34;
}</code></pre></div>
<p>In this template, LLDP1 and LLDP2 are templates for LLDP parameters
while BFD1 and BFD2 are templates for BFD parameters.</p>

<h3 id="supported-bfd-and-lldp-parameters">Supported BFD and LLDP Parameters</h3>

<p><code>ptmd</code> supports the following BFD parameters:</p>

<ul>
<li><code>upMinTx</code>: the minimum transmit interval, which defaults to <em>300ms</em>,
specified in milliseconds.</li>
<li><code>requiredMinRx</code>: the minimum interval between received BFD packets,
which defaults to <em>300ms</em>, specified in milliseconds.</li>
<li><code>detectMult</code>: the detect multiplier, which defaults to <em>3</em>, and can
be any non-zero value.</li>
<li><code>afi</code>: the address family to be supported for the edge. The address
family must be one of the following:

<ul>
<li><em>v4</em>: BFD sessions will be built for only IPv4 connected peer.
This is the default value.</li>
<li><em>v6</em>: BFD sessions will be built for only IPv6 connected peer.</li>
<li><em>both</em>: BFD sessions will be built for both IPv4 and IPv6
connected peers.</li>
</ul></li>
</ul>

<p>The following is an example of a topology with BFD applied at the port
level:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">graph G {
         &#34;cumulus-1&#34;:&#34;swp44&#34; -- &#34;cumulus-2&#34;:&#34;swp20&#34; [BFD=&#34;upMinTx=300,requiredMinRx=100,afi=v6&#34;]
         &#34;cumulus-1&#34;:&#34;swp46&#34; -- &#34;cumulus-2&#34;:&#34;swp22&#34; [BFD=&#34;detectMult=4&#34;]
}</code></pre></div>
<p><code>ptmd</code> supports the following LLDP parameters:</p>

<ul>
<li><code>match_type</code>, which defaults to the interface name (<code>ifname</code>), but
can accept a port description (<code>portdescr</code>) instead if you want
<code>lldpd</code> to compare the topology against the port description instead
of the interface name. You can set this parameter globally or at the
per-port level.</li>
<li><code>match_hostname</code>, which defaults to the host name (<code>hostname</code>), but
enables PTM to match the topology using the fully-qualified domain
name (<code>fqdn</code>) supplied by LLDP.</li>
</ul>

<p>The following is an example of a topology with LLDP applied at the port
level:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">graph G {
         &#34;cumulus-1&#34;:&#34;swp44&#34; -- &#34;cumulus-2&#34;:&#34;swp20&#34; [LLDP=&#34;match_hostname=fqdn&#34;]
         &#34;cumulus-1&#34;:&#34;swp46&#34; -- &#34;cumulus-2&#34;:&#34;swp22&#34; [LLDP=&#34;match_type=portdescr&#34;]
}</code></pre></div>
<p>When you specify <code>match_hostname=fqdn</code>, <code>ptmd</code> will match the entire
FQDN, like <em>cumulus-2.domain.com</em> in the example below. If you do not
specify anything for <code>match_hostname</code>, <code>ptmd</code> will match based on
hostname only, like <em>cumulus-3</em> below, and ignore the rest of the URL:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">graph G { 
         &#34;cumulus-1&#34;:&#34;swp44&#34; -- &#34;cumulus-2.domain.com&#34;:&#34;swp20&#34; [LLDP=&#34;match_hostname=fqdn&#34;] 
         &#34;cumulus-1&#34;:&#34;swp46&#34; -- &#34;cumulus-3&#34;:&#34;swp22&#34; [LLDP=&#34;match_type=portdescr&#34;] 
}</code></pre></div>
<h2 id="bidirectional-forwarding-detection-bfd">Bidirectional Forwarding Detection (BFD)</h2>

<p>BFD provides low overhead and rapid detection of failures in the paths
between two network devices. It provides a unified mechanism for link
detection over all media and protocol layers. Use BFD to detect failures
for IPv4 and IPv6 single or multihop paths between any two network
devices, including unidirectional path failure detection. For
information about configuring BFD using PTM, see the <a href="Bidirectional_Forwarding_Detection_-_BFD">BFD
topic</a>.</p>

<h2 id="check-link-state-with-frrouting">Check Link State with FRRouting</h2>

<p>The FRRouting routing suite enables additional checks to ensure that
routing adjacencies are formed only on links that have connectivity
conformant to the specification, as determined by <code>ptmd</code>.</p>

<p>You only need to do this to check link state; you don&rsquo;t need to enable
PTM to determine BFD status.</p>

<p>The check is enabled by default. Every interface has an implied
<code>ptm-enable</code> line in the configuration stanza in the interfaces file.</p>

<p>To disable the checks, delete the <code>ptm-enable</code> parameter from the
interface. For example:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ net del interface swp51 ptm-enable 
cumulus@switch:~$ net pending
cumulus@switch:~$ net commit</code></pre></div>
<p>If you need to re-enable PTM for that interface, run:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ net add interface swp51 ptm-enable 
cumulus@switch:~$ net pending
cumulus@switch:~$ net commit</code></pre></div>
<p>With PTM enabled on an interface, the <code>zebra</code> daemon connects to <code>ptmd</code>
over a Unix socket. Any time there is a change of status for an
interface, <code>ptmd</code> sends notifications to <code>zebra</code>. Zebra maintains a
<code>ptm-status</code> flag per interface and evaluates routing adjacency based on
this flag. To check the per-interface <code>ptm-status</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ net show interface swp1

Interface swp1 is up, line protocol is up
  Link ups:       0    last: (never)
  Link downs:     0    last: (never)
  PTM status: disabled
  vrf: Default-IP-Routing-Table
  index 3 metric 0 mtu 1550 
  flags: &lt;UP,BROADCAST,RUNNING,MULTICAST&gt;
  HWaddr: c4:54:44:bd:01:41</code></pre></div>
<h2 id="ptmd-service-commands">ptmd Service Commands</h2>

<p>PTM sends client notifications in CSV format.</p>

<p><code>cumulus@switch:~$ sudo systemctl start|restart|force-reload ptmd.service</code>:
Starts or restarts the <code>ptmd</code> service. The <code>topology.dot</code> file must be
present in order for the service to start.</p>

<p><code>cumulus@switch:~$ sudo systemctl reload ptmd.service</code>: Instructs <code>ptmd</code>
to read the <code>topology.dot</code> file again without restarting, applying the
new configuration to the running state.</p>

<p><code>cumulus@switch:~$ sudo systemctl stop ptmd.service</code>: Stops the <code>ptmd</code>
service.</p>

<p><code>cumulus@switch:~$ sudo systemctl status ptmd.service</code>: Retrieves the
current running state of <code>ptmd</code>.</p>

<h2 id="ptmctl-commands">ptmctl Commands</h2>

<p><code>ptmctl</code> is a client of <code>ptmd</code>; it retrieves the operational state of
the ports configured on the switch and information about BFD sessions
from <code>ptmd</code>. <code>ptmctl</code> parses the CSV notifications sent by <code>ptmd</code>.</p>

<p>See <code>man ptmctl</code> for more information.</p>

<h3 id="ptmctl-examples">ptmctl Examples</h3>

<p>The examples below contain the following keywords in the output of the
cbl status column, which are described here:</p>

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>cbl status Keyword</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>pass</td>
<td>The interface is defined in the topology file, LLDP information is received on the interface, and the LLDP information for the interface matches the information in the topology file.</td>
</tr>
<tr class="even">
<td>fail</td>
<td>The interface is defined in the topology file, LLDP information is received on the interface, and the LLDP information for the interface does <strong>not</strong> match the information in the topology file.</td>
</tr>
<tr class="odd">
<td>N/A</td>
<td><p>The interface is defined in the topology file, but no LLDP information is received on the interface. The interface may be down or disconnected, or the neighbor is not sending LLDP packets.</p>
<p>The "N/A" and "fail" statuses may indicate a wiring problem to investigate.</p>
<p>The "N/A" status is not shown when using the <code>-l</code> option with <code>ptmctl</code>. If you specify the <code>-l</code> option, <code>ptmctl</code> displays only those interfaces that are receiving LLDP information.</p></td>
</tr>
</tbody>
</table>

<p>For basic output, use <code>ptmctl</code> without any options:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ sudo ptmctl

-------------------------------------------------------------
port  cbl     BFD     BFD                  BFD    BFD       
      status  status  peer                 local  type      
-------------------------------------------------------------
swp1  pass    pass    11.0.0.2             N/A    singlehop 
swp2  pass    N/A     N/A                  N/A    N/A        
swp3  pass    N/A     N/A                  N/A    N/A  </code></pre></div>
<p>For more detailed output, use the <code>-d</code> option:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ sudo ptmctl -d

--------------------------------------------------------------------------------------
port  cbl    exp     act      sysname  portID  portDescr  match  last    BFD   BFD    
      status nbr     nbr                                  on     upd     Type  state  
--------------------------------------------------------------------------------------
swp45 pass   h1:swp1 h1:swp1  h1       swp1    swp1       IfName 5m: 5s  N/A   N/A    
swp46 fail   h2:swp1 h2:swp1  h2       swp1    swp1       IfName 5m: 5s  N/A   N/A    
 
#continuation of the output
-------------------------------------------------------------------------------------------------
BFD   BFD       det_mult  tx_timeout  rx_timeout  echo_tx_timeout  echo_rx_timeout  max_hop_cnt
peer  DownDiag
-------------------------------------------------------------------------------------------------
N/A   N/A       N/A       N/A         N/A         N/A              N/A              N/A
N/A   N/A       N/A       N/A         N/A         N/A              N/A              N/A
 </code></pre></div>
<p>To return information on active BFD sessions <code>ptmd</code> is tracking, use the
<code>-b</code> option:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ sudo ptmctl -b

----------------------------------------------------------
port  peer        state  local         type       diag 
                                                         
----------------------------------------------------------
swp1  11.0.0.2    Up     N/A           singlehop  N/A  
N/A   12.12.12.1  Up     12.12.12.4    multihop   N/A    </code></pre></div>
<p>To return LLDP information, use the <code>-l</code> option. It returns only the
active neighbors currently being tracked by <code>ptmd</code>. </p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ sudo ptmctl -l

---------------------------------------------
port  sysname  portID  port   match  last
                       descr  on     upd
---------------------------------------------
swp45 h1       swp1    swp1   IfName 5m:59s
swp46 h2       swp1    swp1   IfName 5m:59s </code></pre></div>
<p>To return detailed information on active BFD sessions <code>ptmd</code> is
tracking, use the <code>-b</code> and <code>-d</code> options (results are for an
IPv6-connected peer):</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ sudo ptmctl -b -d

----------------------------------------------------------------------------------------
port  peer                 state  local  type       diag  det   tx_timeout  rx_timeout  
                                                          mult                          
----------------------------------------------------------------------------------------
swp1  fe80::202:ff:fe00:1  Up     N/A    singlehop  N/A   3     300         900         
swp1  3101:abc:bcad::2     Up     N/A    singlehop  N/A   3     300         900         
 
#continuation of output
---------------------------------------------------------------------
echo        echo        max      rx_ctrl  tx_ctrl  rx_echo  tx_echo 
tx_timeout  rx_timeout  hop_cnt                                     
---------------------------------------------------------------------
0           0           N/A      187172   185986   0        0       
0           0           N/A      501      533      0        0       </code></pre></div>
<h3 id="ptmctl-error-outputs">ptmctl Error Outputs</h3>

<p>If there are errors in the topology file or there isn’t a session, PTM
will return appropriate outputs. Typical error strings are:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">Topology file error [/etc/ptm.d/topology.dot] [cannot find node cumulus] -
please check /var/log/ptmd.log for more info

Topology file error [/etc/ptm.d/topology.dot] [cannot open file (errno 2)] -
please check /var/log/ptmd.log for more info

No Hostname/MgmtIP found [Check LLDPD daemon status] -
please check /var/log/ptmd.log for more info

No BFD sessions . Check connections

No LLDP ports detected. Check connections

Unsupported command</code></pre></div>
<p>For example:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ sudo ptmctl
-------------------------------------------------------------------------
cmd         error
-------------------------------------------------------------------------
get-status  Topology file error [/etc/ptm.d/topology.dot] 
            [cannot open file (errno 2)] - please check /var/log/ptmd.log 
            for more info</code></pre></div>
<p>If you encounter errors with the <code>topology.dot</code> file, you can
use <code>dot</code> (included in the Graphviz package) to validate the syntax of
the topology file.</p>

<p>By simply opening the topology file with Graphviz, you can ensure that
it is readable and that the file format is correct.</p>

<p>If you edit <code>topology.dot</code> file from a Windows system, be sure to double
check the file formatting; there may be extra characters that keep the
graph from working correctly.</p>

<h2 id="caveats-and-errata">Caveats and Errata</h2>

<ul>
<li><p>Prior to version 2.1, Cumulus Linux stored the <code>ptmd</code> configuration
files in <code>/etc/cumulus/ptm.d</code>. When you upgrade to version 2.1 or
later, all the existing <code>ptmd</code> files are copied from their original
location to <code>/etc/ptm.d</code> with a <code>dpkg-old</code> extension, except for
<code>topology.dot</code>, which gets copied to <code>/etc/ptm.d</code>.</p>

<p>If you customized the <code>if-topo-pass</code> and <code>if-topo-fail</code> scripts,
they are also copied to <code>dpkg-old</code>, and you must modify them so they
can parse the CSV output correctly.</p>

<p>Sample <code>if-topo-pass</code> and <code>if-topo-fail</code> scripts are available in
<code>/etc/ptm.d</code>. A sample <code>topology.dot</code> file is available in
<code>/usr/share/doc/ptmd/examples</code>.</p></li>

<li><p>When PTMD is incorrectly in a failure state and the Zebra interface
is enabled, PIF BGP sessions are not establishing the route, but the
subinterface on top of it does establish routes.</p>

<p>If the subinterface is configured on the physical interface and the
physical interface is incorrectly marked as being in a PTM FAIL
state, routes on the physical interface are not processed in Quagga,
but the subinterface is working.</p></li>
</ul>

<h2 id="related-information">Related Information</h2>

<ul>
<li><a href="http://tools.ietf.org/html/rfc5880">Bidirectional Forwarding Detection
(BFD)</a></li>
<li><a href="http://www.graphviz.org">Graphviz</a></li>
<li><a href="http://en.wikipedia.org/wiki/Link_Layer_Discovery_Protocol">LLDP on
Wikipedia</a></li>
<li><a href="https://github.com/CumulusNetworks/ptm">PTMd GitHub repo</a></li>
</ul>

<h2 id="attachments">Attachments:</h2>

<p><img src="images/icons/bullet_blue.gif" alt="" />{width=&ldquo;8&rdquo; height=&ldquo;8&rdquo;}
<a href="attachments/8363021/8363020.png">2s2l2s_DOT.png</a> (image/png)</p>
</article>

      
<div class="align-center book-git-footer justify-between">
  
  <div>
    <a href="https://github.com/cawleyflower/testDocs/commit/0f1fa77f244c4b4642688df1f5e961e88daa6e08" title='Last modified March 4, 2019 16:11 EST by Cawleyflower' target="_blank" rel="noopener">
      <img src="/svg/code-merge.svg" /> Last Modified Mar 4, 2019
    </a>
  </div>
  
  
</div>


    </div>

    
  
  
  <aside class="book-toc fixed">
    <nav id="TableOfContents">
<ul>
<li><a href="#prescriptive-topology-manager-ptm">Prescriptive Topology Manager - PTM</a>
<ul>
<li><a href="#contents">Contents</a></li>
<li><a href="#supported-features">Supported Features</a></li>
<li><a href="#configure-ptm">Configure PTM</a></li>
<li><a href="#basic-topology-example">Basic Topology Example</a></li>
<li><a href="#ptmd-scripts">ptmd Scripts</a></li>
<li><a href="#configuration-parameters">Configuration Parameters</a>
<ul>
<li><a href="#host-only-parameters">Host-only Parameters</a></li>
<li><a href="#global-parameters">Global Parameters</a></li>
<li><a href="#per-port-parameters">Per-port Parameters</a></li>
<li><a href="#templates">Templates</a></li>
<li><a href="#supported-bfd-and-lldp-parameters">Supported BFD and LLDP Parameters</a></li>
</ul></li>
<li><a href="#bidirectional-forwarding-detection-bfd">Bidirectional Forwarding Detection (BFD)</a></li>
<li><a href="#check-link-state-with-frrouting">Check Link State with FRRouting</a></li>
<li><a href="#ptmd-service-commands">ptmd Service Commands</a></li>
<li><a href="#ptmctl-commands">ptmctl Commands</a>
<ul>
<li><a href="#ptmctl-examples">ptmctl Examples</a></li>
<li><a href="#ptmctl-error-outputs">ptmctl Error Outputs</a></li>
</ul></li>
<li><a href="#caveats-and-errata">Caveats and Errata</a></li>
<li><a href="#related-information">Related Information</a></li>
<li><a href="#attachments">Attachments:</a></li>
</ul></li>
</ul>
</nav>
  </aside>



  </main>

  
  
</body>

</html>
