<!DOCTYPE html><html>

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Open Shortest Path First O S P F | Cumulus Networks Documentation</title>

<link href="https://fonts.googleapis.com/css?family=Oxygen|Oxygen+Mono:300,400,700" rel="stylesheet">
<link rel="stylesheet" href="/normalize.min.css">

<link rel="stylesheet" href="/book.min.50a619ce4c0e99594908d162684f42218608aa6fde2bd83cca5025d59ba535e3.css">

<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>

<body>
  <input type="checkbox" style="display: none" id="menu-control" />
  <main class="flex container">

    <aside class="book-menu fixed">
      <nav role="navigation">
<h2 class="book-brand">
  <a href="http://example.org/">Cumulus Networks Documentation</a>
</h2>



    


  
  
    
    
  
 
  <ul>
    
    <li><a href="/Cumulus-Linux/installation-management/">
    Installation Management</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/installation-management/Adding_and_Updating_Packages/">Adding and Updating Packages</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/installation-management/Installing_a_New_Cumulus_Linux_Image/">Installing a New Cumulus Linux Image</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/installation-management/Managing_Cumulus_Linux_Disk_Images/">Managing Cumulus Linux Disk Images</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/installation-management/Upgrading_Cumulus_Linux/">Upgrading Cumulus Linux</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/installation-management/Using_Snapshots/">Using Snapshots</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/installation-management/Zero_Touch_Provisioning_-_ZTP/">Zero Touch Provisioning Z T P</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/Cumulus-Linux/layer1-switch-ports/">
    Layer1 Switch Ports</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/802.1X_Interfaces/">802.1 X Interfaces</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/Buffer_and_Queue_Management/">Buffer and Queue Management</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/DHCP_Relays/">D H C P Relays</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/DHCP_Servers/">D H C P Servers</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/Facebook_Voyager_Optical_Interfaces/">Facebook Voyager Optical Interfaces</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/Prescriptive_Topology_Manager_-_PTM/">Prescriptive Topology Manager P T M</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/interface_configuration_and_management/Interface_Configuration_and_Management/">Interface Configuration and Management</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/interface_configuration_and_management/switch_port_attributes/Switch_Port_Attributes/">Switch Port Attributes</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/Cumulus-Linux/layer2/">
    Layer2</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/layer2/Copy_of_Prescriptive_Topology_Manager_-_PTM/">Copy of Prescriptive Topology Manager P T M</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/Copy_of_Spanning_Tree_and_Rapid_Spanning_Tree/">Copy of Spanning Tree and Rapid Spanning Tree</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/Ethernet_Bridging_-_VLANs/">Ethernet Bridging v L a Ns</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/IGMP_and_MLD_Snooping/">I G M P and M L D Snooping</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/LACP_Bypass/">L a C P Bypass</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/Link_Layer_Discovery_Protocol/">Link Layer Discovery Protocol</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/Multi-Chassis_Link_Aggregation_-_MLAG/">Multi Chassis Link Aggregation M L a G</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/Spanning_Tree_and_Rapid_Spanning_Tree/">Spanning Tree and Rapid Spanning Tree</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/Virtual_Router_Redundancy_-_VRR/">Virtual Router Redundancy v R R</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/bonding_link_aggregation/Bonding_-_Link_Aggregation/">Bonding Link Aggregation</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/ethernet_bridging_vlans/Traditional_Bridge_Mode/">Traditional Bridge Mode</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/ethernet_bridging_vlans/VLAN-aware_Bridge_Mode/">V L a N Aware Bridge Mode</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/ethernet_bridging_vlans/VLAN_Tagging/">V L a N Tagging</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/link_layer_discovery_protocol/voice_vlan/Voice_VLAN/">Voice v L a N</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/virtual_router_redundancy/ifplugd/ifplugd/">Ifplugd</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/Cumulus-Linux/layer3/">
    Layer3</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/layer3/Address_Resolution_Protocol_-_ARP/">Address Resolution Protocol a R P</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Bidirectional_Forwarding_Detection_-_BFD/">Bidirectional Forwarding Detection B F D</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Border_Gateway_Protocol_-_BGP/">Border Gateway Protocol B G P</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Configuring_FRRouting/">Configuring F R Routing</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Equal_Cost_Multipath_Load_Sharing_-_Hardware_ECMP/">Equal Cost Multipath Load Sharing Hardware E C M P</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/FRRouting_Overview/">F R Routing Overview</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/GRE_Tunneling/">G R E Tunneling</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Introduction_to_Routing_Protocols/">Introduction to Routing Protocols</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Management_VRF/">Management v R F</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Network_Topology/">Network Topology</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Open_Shortest_Path_First_-_OSPF/" class="active">Open Shortest Path First O S P F</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Open_Shortest_Path_First_v3_-_OSPFv3/">Open Shortest Path First V3 O S P Fv3</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Policy-based_Routing/">Policy Based Routing</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Protocol_Independent_Multicast_-_PIM/">Protocol Independent Multicast P I M</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Redistribute_Neighbor/">Redistribute Neighbor</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Routing/">Routing</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Segment_Routing/">Segment Routing</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Virtual_Routing_and_Forwarding_-_VRF/">Virtual Routing and Forwarding v R F</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/configuring_frrouting/comparing_nclu_and_vtysh_commands/Comparing_NCLU_and_vtysh_Commands/">Comparing N C L U and Vtysh Commands</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/frrouting_overview/Upgrading_from_Quagga_to_FRRouting/">Upgrading From Quagga to F R Routing</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/Cumulus-Linux/monitoring-troubleshooting/">
    Monitoring Troubleshooting</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/ASIC_Monitoring/">A S I C Monitoring</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/FRRouting_Log_Message_Reference/">F R Routing Log Message Reference</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Monitoring_Best_Practices/">Monitoring Best Practices</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Monitoring_System_Hardware/">Monitoring System Hardware</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Monitoring_Virtual_Device_Counters/">Monitoring Virtual Device Counters</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Network_Troubleshooting/">Network Troubleshooting</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Resource_Diagnostics_Using_cl-resource-query/">Resource Diagnostics Using Cl Resource Query</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Simple_Network_Management_Protocol_SNMP_Monitoring/">Simple Network Management Protocol S N M P Monitoring</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Single_User_Mode_-_Boot_Recovery/">Single User Mode Boot Recovery</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Troubleshooting_Network_Interfaces/">Troubleshooting Network Interfaces</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Understanding_the_cl-support_Output_File/">Understanding the Cl Support Output File</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/monitoring_system_hardware/network_switch_port_led_and_stats_led/Network_Switch_Port_LED_and_Status_LED_Guidelines/">Network Switch Port L E D and Status L E D Guidelines</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/network_troubleshooting/monitoring_system_statistics/Monitoring_System_Statistics_and_Network_Traffic_with_sFlow/">Monitoring System Statistics and Network Traffic With S Flow</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/network_troubleshooting/using_nclu_to_troubleshoot/Using_NCLU_to_Troubleshoot_Your_Network_Configuration/">Using N C L U to Troubleshoot Your Network Configuration</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/simple_network_management/using_nutanix_prisim_as_monitoring_tool/Using_Nutanix_Prism_as_a_Monitoring_Tool/">Using Nutanix Prism as a Monitoring Tool</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/switchd_Log_Message_Reference/">Switchd Log Message Reference</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/troubleshooting_network_interfaces/monitoring_interfaces_and_transcievers_using_ethtool/Monitoring_Interfaces_and_Transceivers_Using_ethtool/">Monitoring Interfaces and Transceivers Using Ethtool</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/understanding_cl-support_output_file/troubleshooting_log_files/Troubleshooting_Log_Files/">Troubleshooting Log Files</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/understanding_cl-support_output_file/troubleshooting_the_etc_directory/Troubleshooting_the_etc_Directory/">Troubleshooting the Etc Directory</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/Cumulus-Linux/network-solutions/">
    Network Solutions</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/network-solutions/Anycast_Design_Guide/">Anycast Design Guide</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-solutions/Cumulus_Hyperconverged_Solution_with_Nutanix/">Cumulus Hyperconverged Solution With Nutanix</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-solutions/Cumulus_Networks_Services_Demos/">Cumulus Networks Services Demos</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-solutions/Data_Center_Host_to_ToR_Architecture/">Data Center Host to to R Architecture</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-solutions/Docker_on_Cumulus_Linux/">Docker on Cumulus Linux</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-solutions/OpenStack_Neutron_ML2_and_Cumulus_Linux/">Open Stack Neutron M L2 and Cumulus Linux</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-solutions/RDMA_over_Converged_Ethernet_-_RoCE/">R D M a Over Converged Ethernet Ro C E</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/Cumulus-Linux/network-visualization/">
    Network Visualization</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/network-visualization/Eng_Update_of_VXLAN_Hyperloop/">Eng Update of v X L a N Hyperloop</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/Ethernet_Virtual_Private_Network_-_EVPN/">Ethernet Virtual Private Network E v P N</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/Hybrid_Cloud_Connectivity_with_QinQ_and_VXLANs/">Hybrid Cloud Connectivity With Qin Q and v X L a Ns</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/LNV_Full_Example/">L N v Full Example</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/Lightweight_Network_Virtualization_Overview/">Lightweight Network Virtualization Overview</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/Static_VXLAN_Configurations/">Static v X L a N Configurations</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/VXLAN_Routing/">V X L a N Routing</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/VXLAN_Scale/">V X L a N Scale</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/VXLAN_Tunnel_DSCP_Operations__DRAFT/">V X L a N Tunnel D S C P Operations — D R a F T</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/Virtualization_Integrations/">Virtualization Integrations</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/static_vxlan_configurations/static_mac_bindings/Static_MAC_Bindings_with_VXLAN/">Static M a C Bindings With v X L a N</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/static_vxlan_configurations/static_vxlan_tunnels/Static_VXLAN_Tunnels/">Static v X L a N Tunnels</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/virtualization_integrations/integrating_hardware_vteps_vmware_nsx-mh/Integrating_Hardware_VTEPs_with_VMware_NSX-MH/">Integrating Hardware v T E Ps With v Mware N S X M H</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/virtualization_integrations/integrating_vteps_midonet_openstack/Integrating_Hardware_VTEPs_with_Midokura_MidoNet_and_OpenStack/">Integrating Hardware v T E Ps With Midokura Mido Net and Open Stack</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/virtualization_integrations/integrating_vteps_vmware_nsx-v/Integrating_Hardware_VTEPs_with_VMware_NSX-V/">Integrating Hardware v T E Ps With v Mware N S X V</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/virtualization_integrations/ovsdb_server_high_availability/OVSDB_Server_High_Availability/">O v S D B Server High Availability</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/Cumulus-Linux/system-config/">
    System Config</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/system-config/Authentication_Authorization_and_Accounting/">Authentication Authorization and Accounting</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Configuring_a_Global_Proxy/">Configuring a Global Proxy</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Configuring_switchd/">Configuring Switchd</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Copy_of_Netfilter_-_ACLs/">Copy of Netfilter a C Ls</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/HTTP_API/">H T T P a P I</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Netfilter_-_ACLs/">Netfilter a C Ls</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Network_Command_Line_Utility_-_NCLU/">Network Command Line Utility N C L U</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Power_over_Ethernet_-_PoE/">Power Over Ethernet Po E</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Services_and_Daemons_in_Cumulus_Linux/">Services and Daemons in Cumulus Linux</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Setting_Date_and_Time/">Setting Date and Time</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/authentication_authorization_accounting/LDAP_Authentication_and_Authorization/">L D a P Authentication and Authorization</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/authentication_authorization_accounting/RADIUS_AAA/">R a D I U S a a A</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/authentication_authorization_accounting/SSH_for_Remote_Access/">S S H for Remote Access</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/authentication_authorization_accounting/TACACS_Plus/">T a C a C S Plus</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/authentication_authorization_accounting/User_Accounts/">User Accounts</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/authentication_authorization_accounting/Using_sudo_to_Delegate_Privileges/">Using Sudo to Delegate Privileges</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/netfilter_acls/default_cumulus_linux_acl_config/Default_Cumulus_Linux_ACL_Configuration/">Default Cumulus Linux a C L Configuration</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/netfilter_acls/default_cumulus_linux_acl_config/Filtering_Learned_MAC_Addresses/">Filtering Learned M a C Addresses</a>
    </li>
    
  </ul>

    </li>
    

    
    <li>
      <a href="/Cumulus-Linux/whats-new/">What&#39;s New</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/cumulus-linux-index/Cumulus_Linux_Index/">Cumulus Linux Index</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/quick-start/Quick_Start_Guide/">Quick Start Guide</a>
    </li>
    
  </ul>








</nav>

    </aside>

    <div class="book-page">
      <header class="align-center justify-between book-header">
  <label for="menu-control">
    <img src="/svg/menu.svg" />
  </label>
  <strong>Open Shortest Path First O S P F</strong>
</header>

      
<article class="markdown">

<h1 id="open-shortest-path-first-ospf">Open Shortest Path First - OSPF</h1>

<p>OSPF maintains the view of the network topology conceptually as a
directed graph. Each router represents a vertex in the graph. Each link
between neighboring routers represents a unidirectional edge and each
link has an associated weight (called cost) that is either automatically
derived from its bandwidth or administratively assigned. Using the
weighted topology graph, each router computes a shortest path tree (SPT)
with itself as the root, and applies the results to build its forwarding
table. The computation is generally referred to as <em>SPF computation</em> and
the resultant tree as the <em>SPF tree</em>.</p>

<p>An LSA (<em>link-state advertisement</em>) is the fundamental quantum of
information that OSPF routers exchange with each other. It seeds the
graph building process on the node and triggers SPF computation. LSAs
originated by a node are distributed to all the other nodes in the
network through a mechanism called <em>flooding</em>. Flooding is done
hop-by-hop. OSPF ensures reliability by using link state acknowledgement
packets. The set of LSAs in a router’s memory is termed <em>link-state
database</em> (LSDB), a representation of the network graph. Therefore, OSPF
ensures a consistent view of LSDB on each node in the network in a
distributed fashion (eventual consistency model); this is key to the
protocol’s correctness.</p>

<p>This topic describes OSPFv2, which is a <a href="http://en.wikipedia.org/wiki/Link-state_routing_protocol">link-state routing
protocol</a> for
IPv4. For IPv6 commands, refer to <a href="Open_Shortest_Path_First_v3_-_OSPFv3">Open Shortest Path First v3 -
OSPFv3</a></p>

<h2 id="contents">Contents</h2>

<p><img src="images/icons/grey_arrow_down.png" alt="" />{.expand-control-image}This topic
describes &hellip;</p>

<ul>
<li><a href="#OpenShortestPathFirst-OSPF-ScalabilityandAreas">Scalability and
Areas</a></li>
<li><a href="#OpenShortestPathFirst-OSPF-ConfigureOSPFv2">Configure OSPFv2</a>

<ul>
<li><a href="#OpenShortestPathFirst-OSPF-EnabletheOSPFandZebraDaemons">Enable the OSPF and Zebra
Daemons</a></li>
<li><a href="#OpenShortestPathFirst-OSPF-ConfigureOSPF">Configure OSPF</a></li>
<li><a href="#OpenShortestPathFirst-OSPF-DefineCustomOSPFParametersontheInterfaces">Define Custom OSPF Parameters on the
Interfaces</a></li>
<li><a href="#OpenShortestPathFirst-OSPF-OSPFSPFTimerDefaults">OSPF SPF Timer
Defaults</a></li>
<li><a href="#OpenShortestPathFirst-OSPF-ConfigureMD5AuthenticationforOSPFNeighbors">Configure MD5 Authentication for OSPF
Neighbors</a></li>
</ul></li>
<li><a href="#OpenShortestPathFirst-OSPF-ScalingTips">Scaling Tips</a>

<ul>
<li><a href="#OpenShortestPathFirst-OSPF-Summarization">Summarization</a></li>
<li><a href="#OpenShortestPathFirst-OSPF-StubAreas">Stub Areas</a></li>
<li><a href="#OpenShortestPathFirst-OSPF-multi-instanceMultipleospfdInstances">Multiple ospfd
Instances</a></li>
<li><a href="#OpenShortestPathFirst-OSPF-acrbAuto-costReferenceBandwidth">Auto-cost Reference
Bandwidth</a></li>
</ul></li>
<li><a href="#OpenShortestPathFirst-OSPF-ospf_unnumUnnumberedInterfaces">Unnumbered
Interfaces</a></li>
<li><a href="#OpenShortestPathFirst-OSPF-ApplyaRouteMapforRouteUpdates">Apply a Route Map for Route
Updates</a></li>
<li><a href="#OpenShortestPathFirst-OSPF-ECMP">ECMP</a></li>
<li><a href="#OpenShortestPathFirst-OSPF-TopologyChangesandOSPFReconvergence">Topology Changes and OSPF
Reconvergence</a></li>
<li><a href="#OpenShortestPathFirst-OSPF-ospf_debugTroubleshooting">Troubleshooting</a></li>
<li><a href="#OpenShortestPathFirst-OSPF-RelatedInformation">Related
Information</a></li>
</ul>

<h2 id="scalability-and-areas">Scalability and Areas</h2>

<p>An increase in the number of nodes affects:</p>

<ul>
<li>Memory footprint to hold the entire network topology</li>
<li>Flooding performance </li>
<li>SPF computation efficiency</li>
</ul>

<p>The OSPF protocol advocates hierarchy as a <em>divide and conquer</em> approach
to achieve high scale. You can divide the topology into areas, resulting
in a two-level hierarchy. Area 0 (or 0.0.0.0), called the backbone area,
is the top level of the hierarchy. Packets traveling from one non-zero
area to another must go through the backbone area. For example, you can
divide the leaf-spine topology into the following areas:</p>

<p><img src="attachments/8362922/8362923.png" alt="" />{width=&ldquo;500&rdquo;}</p>

<ul>
<li>Routers R3, R4, R5, R6 are <em>area border routers </em>(ABRs).
These routers have links to multiple areas and perform a set of
specialized tasks, such as SPF computation per area and
summarization of routes across areas.</li>
<li>Most of the LSAs have an area-level flooding scope. These include
router LSA, network LSA, and summary LSA.</li>
<li>Where ABRs do not connect to multiple non-zero areas, you can use
the same area address.</li>
</ul>

<h2 id="configure-ospfv2">Configure OSPFv2</h2>

<p>To configure OSPF, you need to:</p>

<ul>
<li>Enable the OSPF daemon</li>
<li>Enable OSPF</li>
<li>Define custom OSPF parameters on the interfaces</li>
</ul>

<h3 id="enable-the-ospf-and-zebra-daemons">Enable the OSPF and Zebra Daemons</h3>

<p>To enable OSPF, enable the <code>zebra</code> and <code>ospf</code> daemons, as described
in <a href="Configuring_FRRouting">Configuring FRRouting</a>, then start the
FRRouting service:</p>
<div class="highlight"><pre class="chroma"><code class="language-plain" data-lang="plain">cumulus@switch:~$ sudo systemctl enable frr.service
cumulus@switch:~$ sudo systemctl start frr.service</code></pre></div>
<h3 id="configure-ospf">Configure OSPF</h3>

<p>Before you configure OSPF, you need to identify:</p>

<ul>
<li>Which router has the router ID</li>
<li>With which device the router communicates</li>
<li>What information to advertise (the prefix reachability) </li>
</ul>

<p>To configure OSPF:</p>

<ol>
<li><p>Specify the router ID, an IP subnet prefix, and an area address.
 The statement is specified with an IP subnet prefix and an area
address. All the interfaces on the router whose IP address matches
the <code>network</code> subnet are put into the specified area. The OSPF
process starts bringing up peering adjacency on those interfaces. It
also advertises the interface IP addresses formatted into LSAs (of
various types) to the neighbors for proper reachability.</p>
<div class="highlight"><pre class="chroma"><code class="language-plain" data-lang="plain">cumulus@switch:~$ net add ospf router-id 0.0.0.1
cumulus@switch:~$ net add ospf network 10.0.0.0/16 area 0.0.0.0
cumulus@switch:~$ net add ospf network 192.0.2.0/16 area 0.0.0.1</code></pre></div>
<p>The subnets can be as coarse as possible to cover the most number of
interfaces on the router that should run OSPF.</p>

<p>If you do not want to bring up OSPF adjacency,
use the <code>passive-interface</code> option. For example, in a data center
topology, the host-facing interfaces do not need to run OSPF;
however the corresponding IP addresses still need to be advertised
to neighbors.</p>
<div class="highlight"><pre class="chroma"><code class="language-plain" data-lang="plain">cumulus@switch:~$ net add ospf passive-interface swp10
cumulus@switch:~$ net add ospf passive-interface swp11</code></pre></div>
<p>Or use the <code>passive-interface default</code> command to put all interfaces
as passive and selectively remove certain interfaces to bring up
protocol adjacency:</p>
<div class="highlight"><pre class="chroma"><code class="language-plain" data-lang="plain">R3# configure terminal
R3(config)# router ospf
R3(config-router)# passive-interface default
R3(config-router)# no passive-interface swp1</code></pre></div></li>

<li><p>Enable OSPF for each interface:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ net add interface swp1 ospf area 0.0.0.0</code></pre></div>
<p>If you do not want to bring up OSPF adjacency, configure the
corresponding interfaces as passive as explained above. This model
of configuration is required for unnumbered interfaces as discussed
later in this guide.</p>

<p>To specify what information to advertise (the prefix reachability),
you can use the redistribution method. For example:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ net add ospf redistribute connected</code></pre></div>
<p>Redistribution loads the database unnecessarily with type-5 LSAs.
Only use this method to generate real external prefixes (for
example, prefixes learned from BGP). Generate local prefixes
using <code>network</code> and/or <code>passive-interface</code> statements.</p>

<p>By default, OSPF logs a single message when a peer transitions
to/from FULL state.</p></li>
</ol>

<h3 id="define-custom-ospf-parameters-on-the-interfaces">Define Custom OSPF Parameters on the Interfaces</h3>

<p>You can define additional custom parameters for OSPF, such as the
network type (point-to-point or broadcast) and the timer tuning, such as
a hello interval.</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ net add interface swp1 ospf network point-to-point
cumulus@switch:~$ net add interface swp1 ospf hello-interval 5</code></pre></div>
<p>The OSPF configuration is saved in the <code>/etc/frr/ospfd.conf</code> file.</p>

<h3 id="ospf-spf-timer-defaults">OSPF SPF Timer Defaults</h3>

<p>OSPF uses the following timers to prevent consecutive SPFs from
overburdening the CPU: </p>

<ul>
<li>0 ms from initial event until SPF runs</li>
<li>50 ms between consecutive SPF runs (the number doubles with each
SPF, until it reaches the value of C)</li>
<li>5000 ms maximum between SPFs</li>
</ul>

<h3 id="configure-md5-authentication-for-ospf-neighbors">Configure MD5 Authentication for OSPF Neighbors</h3>

<p>Simple text passwords have largely been deprecated in FRRouting, in
favor of MD5 hash authentication.</p>

<p>To configure MD5 authentication:</p>

<ol>
<li><p>Create a key and a key ID for MD5 with
the <code>net add interface &lt;interface&gt; ospf message-digest-key &lt;KEYID&gt; md5 &lt;KEY&gt;</code> command.<code>KEYID</code> is
a value between 1 and 255 that represents the key used to create the
message digest. This value must be consistent across all routers on
a link.<code>KEY</code> is a value that has an upper range of 16 characters
(longer strings are truncated) and represents the actual message
digest key that is associated with the given <code>KEYID</code>.The following
example command creates key ID *1* with the message digest
key ***thisisthekey:</p>

<hr />
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ net add interface swp1 ospf message-digest-key 1 md5 thisisthekey</code></pre></div>
<p>You can remove existing MD5 authentication hashes with the
<code>net del interface &lt;interface&gt; ospf message-digest-key &lt;KEYID&gt; md5 &lt;KEY&gt;</code>
command.</p></li>

<li><p>Enable authorization with
the <code>net add interface &lt;interface&gt; ospf authentication message-digest</code> command. </p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ net add interface swp1 ospf authentication message-digest
cumulus@switch:~$ net pending
cumulus@switch:~$ net commit</code></pre></div>
<p>These commands creates the following configuration in
the <code>/etc/frr/frr.conf</code> file:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ sudo cat /etc/frr/frr.conf 
... 
interface swp1
 ip ospf area 0.0.0.0
 ip ospf authentication message-digest
 ip ospf message-digest-key 1 md5 thisisthekey
 ip ospf network point-to-point
 ...</code></pre></div></li>
</ol>

<h2 id="scaling-tips">Scaling Tips</h2>

<p>Here are some tips for how to scale out OSPF.</p>

<h3 id="summarization">Summarization</h3>

<p>By default, an ABR creates a summary (type-3) LSA for each route in an
area and advertises it in adjacent areas. Prefix range configuration
optimizes this behavior by creating and advertising one summary LSA for
multiple routes.</p>

<p>To configure a range:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ sudo vtysh
switch# configure terminal
switch(config)# router ospf
switch(config-router)# area 0.0.0.1 range 30.0.0.0/8
switch(config-router)# exit
switch(config)# exit
switch# write mem
switch# exit
cumulus@switch:~$ </code></pre></div>
<p>Summarize in the direction to the backbone. The backbone receives
summarized routes and injects them to other areas already summarized.</p>

<p>Summarization can cause non-optimal forwarding of packets during
failures. Here is an example scenario:</p>

<p><img src="attachments/8362922/8362921.png" alt="" />{width=&ldquo;500&rdquo;}</p>

<p>As shown in the diagram, the ABRs in the right non-zero area summarize
the host prefixes as 10.1.0.0/16. When the link between R5 and R10
fails, R5 will send a worse metric for the summary route (metric for the
summary route is the maximum of the metrics of intra-area routes that
are covered by the summary route. Upon failure of the R5-R10 link, the
metric for 10.1.2.0/24 goes higher at R5 as the path is R5-R9-R6-R10).
As a result, other backbone routers shift traffic destined to
10.1.0.0/16 towards R6. This breaks ECMP and is an under-utilization of
network capacity for traffic destined to 10.1.1.0/24.</p>

<h3 id="stub-areas">Stub Areas</h3>

<p>Nodes in an area receive and store intra-area routing information and
summarized information about other areas from the ABRs. In particular, a
good summarization practice about inter-area routes through prefix range
configuration helps scale the routers and keeps the network stable.</p>

<p>Then there are external routes. External routes are the routes
redistributed into OSPF from another protocol. They have an AS-wide
flooding scope. In many cases, external link states make up a large
percentage of the LSDB.</p>

<p><em>Stub areas</em> alleviate this scaling problem. A stub area is an area that
does not receive external route advertisements.</p>

<p>To configure a stub area:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ net add ospf area 0.0.0.1 stub</code></pre></div>
<p>Stub areas still receive information about networks that belong to other
areas of the same OSPF domain. Especially, if summarization is not
configured (or is not comprehensive), the information can be
overwhelming for the nodes. <em>Totally stubby areas</em> address this issue.
Routers in totally stubby areas keep in their LSDB information about
routing within their area, plus the default route.</p>

<p>To configure a totally stubby area:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ net add ospf area 0.0.0.1 stub no-summary</code></pre></div>
<p>Here is a brief tabular summary of the area type differences:</p>

<table>
<thead>
<tr>
<th>Type</th>
<th>Behavior</th>
</tr>
</thead>

<tbody>
<tr>
<td>Normal non- zero area</td>
<td>LSA types 1, 2, 3, 4 area-scoped, type 5 externals, inter-area routes summarized</td>
</tr>

<tr>
<td>Stub area</td>
<td>LSA types 1, 2, 3, 4 area-scoped, No type 5 externals, inter-area routes summarized</td>
</tr>

<tr>
<td>Totally stubby area</td>
<td>LSA types 1, 2 area-scoped, default summary, No type 3, 4, 5 LSA types allowed</td>
</tr>
</tbody>
</table>

<h3 id="multiple-ospfd-instances">Multiple ospfd Instances</h3>

<p>The best way to configure multi-instance OSPF, where a single OSPF
instance is tied to the default VRF; OSPF with multiple VRFs is
discussed in the <a href="Virtual-Routing-and-Forwarding---VRF_8362942.html#VirtualRoutingandForwarding-VRF-frr">VRF
chapter</a>.</p>

<p>However, you can configure multi-instance OSPF
using multiple <code>ospfd</code> processes, but this is a legacy method and is not
recommended in most cases because:</p>

<ul>
<li>Multiple <code>ospfd</code> processes are only supported in the default routing
table/VRF. </li>
<li>You can run multiple <code>ospfd</code> instances with OSPFv2 only, not with
OSPFv3. </li>
<li>FRRouting supports up to 5 instances currently, and the instance ID
must be within the range of 1 through 65535.</li>
</ul>

<p>To configure multi-instance OSPF, do the following:</p>

<ol>
<li><p>Edit <code>/etc/frr/daemons</code> and add <em>ospfd_instances=&ldquo;instance1
instance2 &hellip;&rdquo;</em> to the <code>ospfd</code> line, specifying an instance ID for
each separate instance. For example, the following configuration has
OSPF enabled with 2 <code>ospfd</code> instances, 11 and 22:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ cat /etc/frr/daemons
zebra=yes
bgpd=no
ospfd=yes ospfd_instances=&#34;11 22&#34;
ospf6d=no
ripd=no
ripngd=no
isisd=no</code></pre></div></li>

<li><p>After you modify the <code>daemons</code> file, restart FRRouting:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ sudo systemctl restart frr.service</code></pre></div></li>

<li><p>Configure each instance:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ net add interface swp1 ospf instance-id 11 
cumulus@switch:~$ net add interface swp1 ospf area 0.0.0.0 
cumulus@switch:~$ net add ospf router-id 1.1.1.1
cumulus@switch:~$ net add interface swp2 ospf instance-id 22
cumulus@switch:~$ net add interface swp2 ospf area 0.0.0.0
cumulus@switch:~$ net add ospf router-id 1.1.1.1</code></pre></div></li>

<li><p>Confirm the configuration:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ net show configuration ospf

hostname zebra
log file /var/log/frr/zebra.log
username cumulus nopassword

service integrated-vtysh-config

interface eth0
 ipv6 nd suppress-ra
 link-detect

interface lo
 link-detect

interface swp1
 ip ospf 11 area 0.0.0.0
 link-detect

interface swp2
 ip ospf 22 area 0.0.0.0
 link-detect

interface swp45
 link-detect

interface swp46
 link-detect

interface swp47
 link-detect

interface swp48
 link-detect

interface swp49
 link-detect

interface swp50
 link-detect

interface swp51
 link-detect

interface swp52
 link-detect

interface vagrant
 link-detect

router ospf 11
 ospf router-id 1.1.1.1

router ospf 22
 ospf router-id 1.1.1.1

ip forwarding
ipv6 forwarding

line vty

end</code></pre></div></li>

<li><p>Confirm that all the OSPF instances are running:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ ps -ax | grep ospf
21135 ?        S&lt;s    0:00 /usr/lib/frr/ospfd --daemon -A 127.0.0.1 -n 11
21139 ?        S&lt;s    0:00 /usr/lib/frr/ospfd --daemon -A 127.0.0.1 -n 22
21160 ?        S&lt;s    0:01 /usr/lib/frr/watchfrr -adz -r /usr/sbin/servicebBfrrbBrestartbB%s -s /usr/sbin/servicebBquaggabBstartbB%s -k /usr/sbin/servicebBfrrbBstopbB%s -b bB -t 30 zebra ospfd-11 ospfd-22 pimd
22021 pts/3    S+     0:00 grep ospf</code></pre></div></li>
</ol>

<h4 id="caveats">Caveats</h4>

<p>You can use the <code>redistribute ospf</code> option in your <code>frr.conf</code> file works
with this so you can route between the instances. Specify the instance
ID for the other OSPF instance. For example:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ cat /etc/frr/frr.conf
hostname zebra
log file /var/log/frr/zebra.log
username cumulus nopassword
!
service integrated-vtysh-config
!

...

!
router ospf 11
 ospf router-id 1.1.1.1
!
router ospf 22
 ospf router-id 1.1.1.1
 redistribute ospf 11
!

...</code></pre></div>
<p>Don&rsquo;t specify a process ID unless you are using multi-instance OSPF.</p>

<p>If you disabled
the <a href="Configuring-FRRouting_8362919.html#ConfiguringFRRouting-integrated_cfg">integrated</a>
FRRouting configuration, you must create a
separate <code>ospfd</code> configuration file for each instance. The <code>ospfd.conf</code>
file must include the instance ID in the file name. Continuing with our
example, you would create <code>/etc/frr/ospfd-11.conf</code> and
<code>/etc/frr/ospfd-22.conf</code>.</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ cat /etc/frr/ospfd-11.conf 
!
hostname zebra
log file /var/log/frr/zebra.log
username cumulus nopassword
!
service integrated-vtysh-config
!
interface eth0
 ipv6 nd suppress-ra
 link-detect
!
interface lo
 link-detect
!
interface swp1
 ip ospf 11 area 0.0.0.0
 link-detect
!
interface swp2
 ip ospf 22 area 0.0.0.0
 link-detect
!
interface swp45
 link-detect
!
interface swp46
 link-detect
!
interface swp47
 link-detect
!
interface swp48
 link-detect
!
interface swp49
 link-detect
!
interface swp50
 link-detect
!
interface swp51
 link-detect
!
interface swp52
 link-detect
!
interface vagrant
 link-detect
!
router ospf 11
 ospf router-id 1.1.1.1
!
router ospf 22
 ospf router-id 1.1.1.1
!
ip forwarding
ipv6 forwarding
!
line vty
!</code></pre></div>
<h3 id="auto-cost-reference-bandwidth">Auto-cost Reference Bandwidth</h3>

<p>*Auto-cost reference bandwidth* provides the ability to dynamically
calculate the OSPF interface cost to cater for higher speed links. You
specify the bandwidth in Mbps and this value is used to calculate the
link speed. The default value is <em>100000</em>, for 100Gbps link speed. The
cost of interfaces with link speeds lower than 100Gbps is higher. </p>

<p>It is a good idea to specify that the bandwidth setting should be a
consistent value across all OSPF routers; otherwise routing loops can
occur.</p>

<p>To configure the auto-cost reference bandwidth for 90Gbps, run the
following commands:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ net add ospf auto-cost reference-bandwidth 90000
cumulus@switch:~$ net pending
cumulus@switch:~$ net commit</code></pre></div>
<p>These commands create the following configuration in the
<code>/etc/frr/frr.conf</code> file:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ cat /etc/frr/frr.conf
 
...

router ospf
auto-cost reference-bandwidth 90000
 
...</code></pre></div>
<h2 id="unnumbered-interfaces">Unnumbered Interfaces</h2>

<p>Unnumbered interfaces are interfaces without unique IP addresses. In
OSPFv2, configuring unnumbered interfaces reduces the links between
routers into pure topological elements, which dramatically simplifies
network configuration and reconfiguration. In addition, the routing
database contains only the real networks, so the memory footprint is
reduced and SPF is faster.</p>

<p>Unnumbered is usable for point-to-point interfaces only.</p>

<p>If there is a <code>network &lt;network number&gt;/&lt;mask&gt; area &lt;area ID&gt;</code> command
present in the FRRouting configuration, the <code>ip ospf area &lt;area ID&gt;</code>
command is rejected with the error “Please remove network command
first.” This prevents you from configuring other areas on some of the
unnumbered interfaces. You can use either the <code>network area</code> command or
the <code>ospf area</code> command in the configuration, but not both.</p>

<p>Unless the Ethernet media is intended to be used as a LAN with multiple
connected routers, we recommend configuring the interface as
point-to-point. It has the additional advantage of a simplified
adjacency state machine; there is no need for DR/BDR election and <em>LSA
reflection</em>. See <a href="http://tools.ietf.org/rfc/rfc5309">RFC5309</a> for a more
detailed discussion.</p>

<p>To configure an unnumbered interface, take the IP address of another
interface (called the <em>anchor</em>) and use that as the IP address of the
unnumbered interface:</p>
<div class="highlight"><pre class="chroma"><code class="language-plain" data-lang="plain">cumulus@switch:~$ net add loopback lo ip address 192.0.2.1/32
cumulus@switch:~$ net add interface swp1 ip address 192.0.2.1/32
cumulus@switch:~$ net add interface swp2 ip address 192.0.2.1/32</code></pre></div>
<p>These commands create the following configuration in the
<code>/etc/network/interfaces</code> file:</p>
<div class="highlight"><pre class="chroma"><code class="language-plain" data-lang="plain">auto lo
iface lo inet loopback
  address 192.0.2.1/32

auto swp1
iface swp1
  address 192.0.2.1/32

auto swp2
iface swp2
  address 192.0.2.1/32</code></pre></div>
<p>To enable OSPF on an unnumbered interface:</p>
<div class="highlight"><pre class="chroma"><code class="language-plain" data-lang="plain">cumulus@switch:~$ net add interface swp1 ospf area 0.0.0.1</code></pre></div>
<h2 id="apply-a-route-map-for-route-updates">Apply a Route Map for Route Updates</h2>

<p>To apply a <a href="https://frrouting.org/user-guide/routemap.html">route
map</a> to filter route
updates from Zebra into the Linux kernel:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:$ net add routing protocol ospf route-map &lt;route-map-name&gt;</code></pre></div>
<h2 id="ecmp">ECMP</h2>

<p>During SPF computation for an area, if OSPF finds multiple paths with
equal cost (metric), all those paths are used for forwarding. For
example, in the reference topology diagram, R8 uses both R3 and R4 as
next hops to reach a destination attached to R9.</p>

<h2 id="topology-changes-and-ospf-reconvergence">Topology Changes and OSPF Reconvergence</h2>

<p>Topology changes usually occur due to one of four events:</p>

<ol>
<li>Maintenance of a router node</li>
<li>Maintenance of a link</li>
<li>Failure of a router node</li>
<li>Failure of a link</li>
</ol>

<p>For the maintenance events, operators typically raise the OSPF
administrative weight of the link(s) to ensure that all traffic is
diverted from the link or the node (referred to as <em>costing out</em>). The
speed of reconvergence does not matter. Indeed, changing the OSPF cost
causes LSAs to be reissued, but the links remain in service during the
SPF computation process of all routers in the network.</p>

<p>For the failure events, traffic may be lost during reconvergence; that
is, until SPF on all nodes computes an alternative path around the
failed link or node to each of the destinations. The reconvergence
depends on layer 1 failure detection capabilities and at the worst case
<em>DeadInterval</em> OSPF timer.</p>

<p><strong>Example configuration for event 1, using <code>vtysh</code></strong>:</p>
<div class="highlight"><pre class="chroma"><code class="language-plain" data-lang="plain">cumulus@switch:~$ sudo vtysh
switch# configure terminal
switch(config)# router ospf
switch(config-router)# max-metric router-lsa administrative
switch(config-router)# exit
switch(config)# exit
switch# write mem
switch# exit
cumulus@switch:~$ </code></pre></div>
<p><strong>Example configuration for event 2</strong>:</p>
<div class="highlight"><pre class="chroma"><code class="language-plain" data-lang="plain">cumulus@switch:~$ net add interface swp1 ospf cost 65535</code></pre></div>
<h2 id="troubleshooting">Troubleshooting</h2>

<p><a href="http://www.nongnu.org/quagga/docs/docs-info.html#Showing-OSPF-information">OperState</a>
lists all the commands to view the operational state of OSPF.</p>

<p>The three most important states while troubleshooting the protocol are:</p>

<ol>
<li><p>Neighbors, with <code>net show ospf neighbor</code>. This is the starting point
to debug neighbor states (also see <code>tcpdump</code> below).</p></li>

<li><p>Database, with <code>net show ospf database</code>. This is the starting point
to verify that the LSDB is, in fact, synchronized across all routers
in the network. For example, sweeping through the output of
<code>show ip ospf database router</code> taken from all routers in an area
will ensure if the topology graph building process is complete; that
is, every node has seen all the other nodes in the area.</p></li>

<li><p>Routes, with <code>net show route ospf</code>. This is the outcome of SPF
computation that gets downloaded to the forwarding table, and is the
starting point to debug, for example, why an OSPF route is not being
forwarded correctly.</p></li>
</ol>

<p><a href="http://www.nongnu.org/quagga/docs/docs-info.html#Debugging-OSPF">Debugging-OSPF</a>
lists all of the OSPF debug options.</p>

<p>Using <code>zebra</code> under <code>vtysh</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-plain" data-lang="plain">cumulus@switch:~$ sudo vtysh
switch# show [zebra]

IOBJECT := { events | status | timers }
OOBJECT := { interface | redistribute }
POBJECT := { all | dd | hello | ls-ack | ls-request | ls-update }
ZOBJECT := { all | events | kernel | packet | rib |</code></pre></div>
<p>Using <code>tcpdump</code> to capture OSPF packets:</p>
<div class="highlight"><pre class="chroma"><code class="language-plain" data-lang="plain">cumulus@switch:~$ sudo tcpdump -v -i swp1 ip proto ospf</code></pre></div>
<h2 id="related-information">Related Information</h2>

<ul>
<li><a href="Bidirectional_Forwarding_Detection_-_BFD">Bidirectional forwarding
detection</a> (BFD) and OSPF</li>
<li><a href="http://en.wikipedia.org/wiki/Open_Shortest_Path_First">en.wikipedia.org/wiki/Open_Shortest_Path_First</a></li>
<li><a href="https://frrouting.org/user-guide/ospfd.html">FRR OSPFv2</a></li>
<li>Perlman, Radia (1999). Interconnections: Bridges, Routers, Switches,
and Internetworking Protocols (2 ed.). Addison-Wesley.</li>
<li>Moy, John T. OSPF: Anatomy of an Internet Routing Protocol.
Addison-Wesley.</li>
<li>RFC 2328 OSPFv2</li>
<li>RFC 3101 OSPFv2 Not-So-Stubby Area (NSSA)</li>
</ul>

<h2 id="attachments">Attachments:</h2>

<p><img src="images/icons/bullet_blue.gif" alt="" />{width=&ldquo;8&rdquo; height=&ldquo;8&rdquo;}
<a href="attachments/8362922/8362921.png">ospf-summarization.png</a> (image/png)<br />
<img src="images/icons/bullet_blue.gif" alt="" />{width=&ldquo;8&rdquo; height=&ldquo;8&rdquo;}
<a href="attachments/8362922/8362923.png">ospf-areas.png</a> (image/png)</p>
</article>

      
<div class="align-center book-git-footer justify-between">
  
  <div>
    <a href="https://github.com/cawleyflower/testDocs/commit/0f1fa77f244c4b4642688df1f5e961e88daa6e08" title='Last modified March 4, 2019 16:11 EST by Cawleyflower' target="_blank" rel="noopener">
      <img src="/svg/code-merge.svg" /> Last Modified Mar 4, 2019
    </a>
  </div>
  
  
</div>


    </div>

    
  
  
  <aside class="book-toc fixed">
    <nav id="TableOfContents">
<ul>
<li><a href="#open-shortest-path-first-ospf">Open Shortest Path First - OSPF</a>
<ul>
<li><a href="#contents">Contents</a></li>
<li><a href="#scalability-and-areas">Scalability and Areas</a></li>
<li><a href="#configure-ospfv2">Configure OSPFv2</a>
<ul>
<li><a href="#enable-the-ospf-and-zebra-daemons">Enable the OSPF and Zebra Daemons</a></li>
<li><a href="#configure-ospf">Configure OSPF</a></li>
<li><a href="#define-custom-ospf-parameters-on-the-interfaces">Define Custom OSPF Parameters on the Interfaces</a></li>
<li><a href="#ospf-spf-timer-defaults">OSPF SPF Timer Defaults</a></li>
<li><a href="#configure-md5-authentication-for-ospf-neighbors">Configure MD5 Authentication for OSPF Neighbors</a></li>
</ul></li>
<li><a href="#scaling-tips">Scaling Tips</a>
<ul>
<li><a href="#summarization">Summarization</a></li>
<li><a href="#stub-areas">Stub Areas</a></li>
<li><a href="#multiple-ospfd-instances">Multiple ospfd Instances</a>
<ul>
<li><a href="#caveats">Caveats</a></li>
</ul></li>
<li><a href="#auto-cost-reference-bandwidth">Auto-cost Reference Bandwidth</a></li>
</ul></li>
<li><a href="#unnumbered-interfaces">Unnumbered Interfaces</a></li>
<li><a href="#apply-a-route-map-for-route-updates">Apply a Route Map for Route Updates</a></li>
<li><a href="#ecmp">ECMP</a></li>
<li><a href="#topology-changes-and-ospf-reconvergence">Topology Changes and OSPF Reconvergence</a></li>
<li><a href="#troubleshooting">Troubleshooting</a></li>
<li><a href="#related-information">Related Information</a></li>
<li><a href="#attachments">Attachments:</a></li>
</ul></li>
</ul>
</nav>
  </aside>



  </main>

  
  
</body>

</html>
