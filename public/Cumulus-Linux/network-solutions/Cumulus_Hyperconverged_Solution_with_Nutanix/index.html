<!DOCTYPE html><html>

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cumulus Hyperconverged Solution With Nutanix | Cumulus Networks Documentation</title>

<link href="https://fonts.googleapis.com/css?family=Oxygen|Oxygen+Mono:300,400,700" rel="stylesheet">
<link rel="stylesheet" href="/normalize.min.css">

<link rel="stylesheet" href="/book.min.20b2cb98a9208e1e7497525a9f78f7f8eb0ca4b5f4551e9610f12c5b317e6be8.css">

<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>

<body>
  <input type="checkbox" style="display: none" id="menu-control" />
  <main class="flex container">

    <aside class="book-menu fixed">
      <nav role="navigation">
<h2 class="book-brand">
  <a href="http://example.org/">Cumulus Networks Documentation</a>
</h2>



    


  
  
    
  
 
  <ul>
    
    <li><a href="/Cumulus-Linux/installation-management/">
    Installation Management</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/installation-management/Adding_and_Updating_Packages/">Adding and Updating Packages</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/installation-management/Installing_a_New_Cumulus_Linux_Image/">Installing a New Cumulus Linux Image</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/installation-management/Managing_Cumulus_Linux_Disk_Images/">Managing Cumulus Linux Disk Images</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/installation-management/Upgrading_Cumulus_Linux/">Upgrading Cumulus Linux</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/installation-management/Using_Snapshots/">Using Snapshots</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/installation-management/Zero_Touch_Provisioning_-_ZTP/">Zero Touch Provisioning Z T P</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/Cumulus-Linux/layer1-switch-ports/">
    Layer1 Switch Ports</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/802.1X_Interfaces/">802.1 X Interfaces</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/Buffer_and_Queue_Management/">Buffer and Queue Management</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/DHCP_Relays/">D H C P Relays</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/DHCP_Servers/">D H C P Servers</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/Facebook_Voyager_Optical_Interfaces/">Facebook Voyager Optical Interfaces</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/Prescriptive_Topology_Manager_-_PTM/">Prescriptive Topology Manager P T M</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/interface_configuration_and_management/Interface_Configuration_and_Management/">Interface Configuration and Management</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/interface_configuration_and_management/switch_port_attributes/Switch_Port_Attributes/">Switch Port Attributes</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/Cumulus-Linux/layer2/">
    Layer2</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/layer2/Copy_of_Prescriptive_Topology_Manager_-_PTM/">Copy of Prescriptive Topology Manager P T M</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/Copy_of_Spanning_Tree_and_Rapid_Spanning_Tree/">Copy of Spanning Tree and Rapid Spanning Tree</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/Ethernet_Bridging_-_VLANs/">Ethernet Bridging v L a Ns</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/IGMP_and_MLD_Snooping/">I G M P and M L D Snooping</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/LACP_Bypass/">L a C P Bypass</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/Link_Layer_Discovery_Protocol/">Link Layer Discovery Protocol</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/Multi-Chassis_Link_Aggregation_-_MLAG/">Multi Chassis Link Aggregation M L a G</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/Spanning_Tree_and_Rapid_Spanning_Tree/">Spanning Tree and Rapid Spanning Tree</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/Virtual_Router_Redundancy_-_VRR/">Virtual Router Redundancy v R R</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/bonding_link_aggregation/Bonding_-_Link_Aggregation/">Bonding Link Aggregation</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/ethernet_bridging_vlans/Traditional_Bridge_Mode/">Traditional Bridge Mode</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/ethernet_bridging_vlans/VLAN-aware_Bridge_Mode/">V L a N Aware Bridge Mode</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/ethernet_bridging_vlans/VLAN_Tagging/">V L a N Tagging</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/link_layer_discovery_protocol/voice_vlan/Voice_VLAN/">Voice v L a N</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/virtual_router_redundancy/ifplugd/ifplugd/">Ifplugd</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/Cumulus-Linux/layer3/">
    Layer3</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/layer3/Address_Resolution_Protocol_-_ARP/">Address Resolution Protocol a R P</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Bidirectional_Forwarding_Detection_-_BFD/">Bidirectional Forwarding Detection B F D</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Border_Gateway_Protocol_-_BGP/">Border Gateway Protocol B G P</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Configuring_FRRouting/">Configuring F R Routing</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Equal_Cost_Multipath_Load_Sharing_-_Hardware_ECMP/">Equal Cost Multipath Load Sharing Hardware E C M P</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/FRRouting_Overview/">F R Routing Overview</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/GRE_Tunneling/">G R E Tunneling</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Introduction_to_Routing_Protocols/">Introduction to Routing Protocols</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Management_VRF/">Management v R F</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Network_Topology/">Network Topology</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Open_Shortest_Path_First_-_OSPF/">Open Shortest Path First O S P F</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Open_Shortest_Path_First_v3_-_OSPFv3/">Open Shortest Path First V3 O S P Fv3</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Policy-based_Routing/">Policy Based Routing</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Protocol_Independent_Multicast_-_PIM/">Protocol Independent Multicast P I M</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Redistribute_Neighbor/">Redistribute Neighbor</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Routing/">Routing</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Segment_Routing/">Segment Routing</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Virtual_Routing_and_Forwarding_-_VRF/">Virtual Routing and Forwarding v R F</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/configuring_frrouting/comparing_nclu_and_vtysh_commands/Comparing_NCLU_and_vtysh_Commands/">Comparing N C L U and Vtysh Commands</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/frrouting_overview/Upgrading_from_Quagga_to_FRRouting/">Upgrading From Quagga to F R Routing</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/Cumulus-Linux/monitoring-troubleshooting/">
    Monitoring Troubleshooting</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/ASIC_Monitoring/">A S I C Monitoring</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/FRRouting_Log_Message_Reference/">F R Routing Log Message Reference</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Monitoring_Best_Practices/">Monitoring Best Practices</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Monitoring_System_Hardware/">Monitoring System Hardware</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Monitoring_Virtual_Device_Counters/">Monitoring Virtual Device Counters</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Network_Troubleshooting/">Network Troubleshooting</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Resource_Diagnostics_Using_cl-resource-query/">Resource Diagnostics Using Cl Resource Query</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Simple_Network_Management_Protocol_SNMP_Monitoring/">Simple Network Management Protocol S N M P Monitoring</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Single_User_Mode_-_Boot_Recovery/">Single User Mode Boot Recovery</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Troubleshooting_Network_Interfaces/">Troubleshooting Network Interfaces</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Understanding_the_cl-support_Output_File/">Understanding the Cl Support Output File</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/monitoring_system_hardware/network_switch_port_led_and_stats_led/Network_Switch_Port_LED_and_Status_LED_Guidelines/">Network Switch Port L E D and Status L E D Guidelines</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/network_troubleshooting/monitoring_system_statistics/Monitoring_System_Statistics_and_Network_Traffic_with_sFlow/">Monitoring System Statistics and Network Traffic With S Flow</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/network_troubleshooting/using_nclu_to_troubleshoot/Using_NCLU_to_Troubleshoot_Your_Network_Configuration/">Using N C L U to Troubleshoot Your Network Configuration</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/simple_network_management/using_nutanix_prisim_as_monitoring_tool/Using_Nutanix_Prism_as_a_Monitoring_Tool/">Using Nutanix Prism as a Monitoring Tool</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/switchd_Log_Message_Reference/">Switchd Log Message Reference</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/troubleshooting_network_interfaces/monitoring_interfaces_and_transcievers_using_ethtool/Monitoring_Interfaces_and_Transceivers_Using_ethtool/">Monitoring Interfaces and Transceivers Using Ethtool</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/understanding_cl-support_output_file/troubleshooting_log_files/Troubleshooting_Log_Files/">Troubleshooting Log Files</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/understanding_cl-support_output_file/troubleshooting_the_etc_directory/Troubleshooting_the_etc_Directory/">Troubleshooting the Etc Directory</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/Cumulus-Linux/network-solutions/">
    Network Solutions</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/network-solutions/Anycast_Design_Guide/">Anycast Design Guide</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-solutions/Cumulus_Hyperconverged_Solution_with_Nutanix/" class="active">Cumulus Hyperconverged Solution With Nutanix</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-solutions/Cumulus_Networks_Services_Demos/">Cumulus Networks Services Demos</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-solutions/Data_Center_Host_to_ToR_Architecture/">Data Center Host to to R Architecture</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-solutions/Docker_on_Cumulus_Linux/">Docker on Cumulus Linux</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-solutions/OpenStack_Neutron_ML2_and_Cumulus_Linux/">Open Stack Neutron M L2 and Cumulus Linux</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-solutions/RDMA_over_Converged_Ethernet_-_RoCE/">R D M a Over Converged Ethernet Ro C E</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/Cumulus-Linux/network-visualization/">
    Network Visualization</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/network-visualization/Eng_Update_of_VXLAN_Hyperloop/">Eng Update of v X L a N Hyperloop</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/Ethernet_Virtual_Private_Network_-_EVPN/">Ethernet Virtual Private Network E v P N</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/Hybrid_Cloud_Connectivity_with_QinQ_and_VXLANs/">Hybrid Cloud Connectivity With Qin Q and v X L a Ns</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/LNV_Full_Example/">L N v Full Example</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/Lightweight_Network_Virtualization_Overview/">Lightweight Network Virtualization Overview</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/Static_VXLAN_Configurations/">Static v X L a N Configurations</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/VXLAN_Routing/">V X L a N Routing</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/VXLAN_Scale/">V X L a N Scale</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/VXLAN_Tunnel_DSCP_Operations__DRAFT/">V X L a N Tunnel D S C P Operations — D R a F T</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/Virtualization_Integrations/">Virtualization Integrations</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/static_vxlan_configurations/static_mac_bindings/Static_MAC_Bindings_with_VXLAN/">Static M a C Bindings With v X L a N</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/static_vxlan_configurations/static_vxlan_tunnels/Static_VXLAN_Tunnels/">Static v X L a N Tunnels</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/virtualization_integrations/integrating_hardware_vteps_vmware_nsx-mh/Integrating_Hardware_VTEPs_with_VMware_NSX-MH/">Integrating Hardware v T E Ps With v Mware N S X M H</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/virtualization_integrations/integrating_vteps_midonet_openstack/Integrating_Hardware_VTEPs_with_Midokura_MidoNet_and_OpenStack/">Integrating Hardware v T E Ps With Midokura Mido Net and Open Stack</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/virtualization_integrations/integrating_vteps_vmware_nsx-v/Integrating_Hardware_VTEPs_with_VMware_NSX-V/">Integrating Hardware v T E Ps With v Mware N S X V</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/virtualization_integrations/ovsdb_server_high_availability/OVSDB_Server_High_Availability/">O v S D B Server High Availability</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/Cumulus-Linux/system-config/">
    System Config</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/system-config/Authentication_Authorization_and_Accounting/">Authentication Authorization and Accounting</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Configuring_a_Global_Proxy/">Configuring a Global Proxy</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Configuring_switchd/">Configuring Switchd</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Copy_of_Netfilter_-_ACLs/">Copy of Netfilter a C Ls</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/HTTP_API/">H T T P a P I</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Netfilter_-_ACLs/">Netfilter a C Ls</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Network_Command_Line_Utility_-_NCLU/">Network Command Line Utility N C L U</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Power_over_Ethernet_-_PoE/">Power Over Ethernet Po E</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Services_and_Daemons_in_Cumulus_Linux/">Services and Daemons in Cumulus Linux</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Setting_Date_and_Time/">Setting Date and Time</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/authentication_authorization_accounting/LDAP_Authentication_and_Authorization/">L D a P Authentication and Authorization</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/authentication_authorization_accounting/RADIUS_AAA/">R a D I U S a a A</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/authentication_authorization_accounting/SSH_for_Remote_Access/">S S H for Remote Access</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/authentication_authorization_accounting/TACACS_Plus/">T a C a C S Plus</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/authentication_authorization_accounting/User_Accounts/">User Accounts</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/authentication_authorization_accounting/Using_sudo_to_Delegate_Privileges/">Using Sudo to Delegate Privileges</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/netfilter_acls/default_cumulus_linux_acl_config/Default_Cumulus_Linux_ACL_Configuration/">Default Cumulus Linux a C L Configuration</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/netfilter_acls/default_cumulus_linux_acl_config/Filtering_Learned_MAC_Addresses/">Filtering Learned M a C Addresses</a>
    </li>
    
  </ul>

    </li>
    

    
    <li>
      <a href="/Cumulus-Linux/whats-new/">What&#39;s New</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/cumulus-linux-index/Cumulus_Linux_Index/">Cumulus Linux Index</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/quick-start/Quick_Start_Guide/">Quick Start Guide</a>
    </li>
    
  </ul>
 
  <ul>
    
    <li><a href="/NetQ/UI_User_Guide/">
    U I User Guide</a> 
  <ul>
    
    <li><a href="/NetQ/UI_User_Guide/monitor_the_network/">
    Monitor the Network</a> 
  <ul>
    

    
    <li>
      <a href="/NetQ/UI_User_Guide/monitor_the_network/monitor_alarm_events/Monitor_Alarm_Events/">Monitor Alarm Events</a>
    </li>
    
    <li>
      <a href="/NetQ/UI_User_Guide/monitor_the_network/monitor_informational_events/Monitor_Informational_Events/">Monitor Informational Events</a>
    </li>
    
    <li>
      <a href="/NetQ/UI_User_Guide/monitor_the_network/monitor_network_health/Monitor_Network_Health/">Monitor Network Health</a>
    </li>
    
    <li>
      <a href="/NetQ/UI_User_Guide/monitor_the_network/monitor_network_inventory/Monitor_Network_Inventory/">Monitor Network Inventory</a>
    </li>
    
    <li>
      <a href="/NetQ/UI_User_Guide/monitor_the_network/monitor_network_protocols/Monitor_Network_Layer_Protocols/">Monitor Network Layer Protocols</a>
    </li>
    
  </ul>

    </li>
    

    
    <li>
      <a href="/NetQ/UI_User_Guide/monitor_switches/Monitor_Switches/">Monitor Switches</a>
    </li>
    
    <li>
      <a href="/NetQ/UI_User_Guide/netq_ui_overview/NetQ_User_Interface_Overview/">Net Q User Interface Overview</a>
    </li>
    
    <li>
      <a href="/NetQ/UI_User_Guide/ui_preface/UI_Preface/">U I Preface</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/NetQ/cli_user_guide/">
    Cli User Guide</a> 
  <ul>
    

    
    <li>
      <a href="/NetQ/cli_user_guide/CLI_Preface/CLI_Preface/">C L I Preface</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/automate_common_tasks/Automate_Common_and_Repetitive_Tasks/">Automate Common and Repetitive Tasks</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/command_line_overview/NetQ_Command_Line_Overview/">Net Q Command Line Overview</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/monitor_containter_environments/Monitor_Container_Environments/">Monitor Container Environments</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/monitor_data_link_layer/Monitor_Data_Link_Layer_Devices_and_Protocols/">Monitor Data Link Layer Devices and Protocols</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/monitor_linux_hosts/Monitor_Linux_Hosts/">Monitor Linux Hosts</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/monitor_network_health/Monitor_Overall_Network_Health/">Monitor Overall Network Health</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/monitor_network_layer/Monitor_Network_Protocols_and_Services/">Monitor Network Protocols and Services</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/monitor_physical_layer/Monitor_Physical_Layer_Components/">Monitor Physical Layer Components</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/monitor_switch_hardware/Monitor_Switch_Hardware_and_Software/">Monitor Switch Hardware and Software</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/monitor_virtual_overlays/Monitor_Virtual_Network_Overlays/">Monitor Virtual Network Overlays</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/resolve_issues/Resolve_Issues/">Resolve Issues</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/resolve_issues/Resolve_MLAG_Issues/">Resolve M L a G Issues</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/resolve_issues/investiage_netq_issues/Investigate_NetQ_Issues/">Investigate Net Q Issues</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/resolve_issues/methods_for_diagnosing_issues/Methods_for_Diagnosing_Network_Issues/">Methods for Diagnosing Network Issues</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/NetQ/deployment_guide/">
    Deployment Guide</a> 
  <ul>
    

    
    <li>
      <a href="/NetQ/deployment_guide/config_optional_netq/Configuring_Optional_NetQ_Capabilities/">Configuring Optional Net Q Capabilities</a>
    </li>
    
    <li>
      <a href="/NetQ/deployment_guide/deployment_preface/Deployment_Preface/">Deployment Preface</a>
    </li>
    
    <li>
      <a href="/NetQ/deployment_guide/install_netq/Install_NetQ/">Install Net Q</a>
    </li>
    
    <li>
      <a href="/NetQ/deployment_guide/maintain_netq/Maintain_NetQ/">Maintain Net Q</a>
    </li>
    
    <li>
      <a href="/NetQ/deployment_guide/netq_primer/Cumulus_NetQ_Primer/">Cumulus Net Q Primer</a>
    </li>
    
  </ul>

    </li>
    

    
    <li>
      <a href="/NetQ/Release_Notes/Cumulus_NetQ_2.0_Release_Notes/">Cumulus Net Q 2.0 Release Notes</a>
    </li>
    
    <li>
      <a href="/NetQ/getting_started/Getting_Started_with_the_Cumulus_NetQ_Appliance/">Getting Started With the Cumulus Net Q Appliance</a>
    </li>
    
    <li>
      <a href="/NetQ/software_installation_guide/Cumulus_NetQ_Appliance_Software_Installation_Guide/">Cumulus Net Q Appliance Software Installation Guide</a>
    </li>
    
  </ul>








</nav>

    </aside>

    <div class="book-page">
      <header class="align-center justify-between book-header">
  <label for="menu-control">
    <img src="/svg/menu.svg" />
  </label>
  <strong>Cumulus Hyperconverged Solution With Nutanix</strong>
</header>

      
<article class="markdown">

<h1 id="cumulus-hyperconverged-solution-with-nutanix">Cumulus Hyperconverged Solution with Nutanix</h1>

<p>The Cumulus Hyperconverged Solution (HCS) in Cumulus Linux supports
automated integration with the Nutanix Prism Management solution and the
Nutanix AHV hypervisor. Cumulus HCS automatically configures ports
attached to Nutanix nodes, provisions networking and manages VLANs with
Nutanix Prism and Nutanix AHV.</p>

<p>In addition, you can augment the deployment with:</p>

<ul>
<li><a href="https://cumulusnetworks.com/cumulus-on-a-stick/">Cumulus on a
Stick</a> for <a href="Zero_Touch_Provisioning_-_ZTP">zero
touch provisioning</a> Nutanix and
Cumulus HCS without any user interaction or additional equipment.</li>
<li><a href="https://docs.cumulusnetworks.com/display/NETQ/Cumulus+NetQ">Cumulus
NetQ</a>
for network telemetry and unprecedented real-time and
historic visibility into dynamic changes in both the network and
virtual machines.</li>
<li>Out-of-band management and IPMI access using <a href="https://docs.cumulusnetworks.com/display/RMP/Cumulus+RMP">Cumulus
RMP</a> or a
generic Cumulus Linux switch, enabling the full provisioning of a
zero-touch data and management network, eliminating any network
deployment delays when standing up a Nutanix cluster.</li>
</ul>

<p>Cumulus HCS has two major components:</p>

<ul>
<li><strong>Nutanix LLDP Switch Agent</strong>. When enabled, the agent listens for
directly connected Nutanix servers via LLDP and enables MLAG bonding
on the relevant ports.</li>

<li><p><strong>Nutanix Webhook VLAN Provisioner</strong>. Cumulus Linux switches
register with the Nutanix CVM and wait to receive Nutanix webhooks.
When a new VM is deployed on a server in the cluster, the CVM sends
a message to the Cumulus Linux switch with the physical server name
and relevant VLANs. The switch then dynamically provisions the
configuration on the ports of the specific physical server.</p>

<p>Cumulus HCS periodically polls Nutanix Prism for information about
VMs in the cluster. When a new VM is discovered, the service
automatically identifies the physical Nutanix server hosting the VM
and discovers any VLANs required for the VM. The service then
automatically adds these VLANs to the default <a href="VLAN-aware_Bridge_Mode">VLAN-aware
bridge</a>, the MLAG peer link and the
automatically created bond to the Nutanix node. When a VM is powered
off, removed or moved, and the associated VLAN has no other VMs, the
VLAN is automatically removed from the bridge, peer link and dynamic
bond.  </p></li>
</ul>

<h2 id="contents">Contents</h2>

<p><img src="images/icons/grey_arrow_down.png" alt="" />{.expand-control-image}This topic
covers &hellip;</p>

<ul>
<li><a href="#CumulusHyperconvergedSolutionwithNutanix-Prerequisites">Prerequisites</a></li>
<li><a href="#CumulusHyperconvergedSolutionwithNutanix-ConfigureCumulusHCSandNutanix">Configure Cumulus HCS and
Nutanix</a>

<ul>
<li><a href="#CumulusHyperconvergedSolutionwithNutanix-ConfiguretheServicewithZTP">Configure the Service with
ZTP</a></li>
<li><a href="#CumulusHyperconvergedSolutionwithNutanix-ConfiguretheServiceManually">Configure the Service
Manually</a></li>
<li><a href="#CumulusHyperconvergedSolutionwithNutanix-chs_settingsCumulusHCSConfigurationSettings">Cumulus HCS Configuration
Settings</a></li>
</ul></li>
<li><a href="#CumulusHyperconvergedSolutionwithNutanix-ConfigureUplinks">Configure
Uplinks</a></li>
<li><a href="#CumulusHyperconvergedSolutionwithNutanix-AddLocalDefaultGateways">Add Local Default
Gateways</a></li>
<li><a href="#CumulusHyperconvergedSolutionwithNutanix-Out-of-bandSolutions">Out-of-band
Solutions</a>

<ul>
<li><a href="#CumulusHyperconvergedSolutionwithNutanix-CumulusRMP">Cumulus
RMP</a></li>
<li><a href="#CumulusHyperconvergedSolutionwithNutanix-OtherCumulusLinux1GSwitches">Other Cumulus Linux 1G
Switches</a></li>
</ul></li>
<li><a href="#CumulusHyperconvergedSolutionwithNutanix-TroubleshootCumulusHCS">Troubleshoot Cumulus
HCS</a>

<ul>
<li><a href="#CumulusHyperconvergedSolutionwithNutanix-VerifyDynamicBondsAreBeingCreated">Verify Dynamic Bonds Are Being
Created</a></li>
<li><a href="#CumulusHyperconvergedSolutionwithNutanix-VerifyLLDPMessagesAreBeingReceived">Verify LLDP Messages Are Being
Received</a></li>
<li><a href="#CumulusHyperconvergedSolutionwithNutanix-ViewDetailedNutanixLLDPInformation">View Detailed Nutanix LLDP
Information</a></li>
</ul></li>
<li><a href="#CumulusHyperconvergedSolutionwithNutanix-Caveats">Caveats</a></li>
</ul>

<h2 id="prerequisites">Prerequisites</h2>

<ul>
<li>2 <a href="https://cumulusnetworks.com/hcl">Cumulus Networks-compatible
switches</a> running Cumulus Linux
3.7.3 or later</li>
<li>Nutanix AOS 5.5.8 or later</li>
<li>Nutanix AHV 20170830.185 or later</li>
<li>LLDP enabled on Nutanix (which is the default in 5.5.8 and later)</li>
<li>IP connectivity between the Cumulus Linux switches and the Nutanix
controller VMs (CVMs)</li>
<li><a href="Multi-Chassis_Link_Aggregation_-_MLAG">MLAG</a> enabled on the Cumulus
Linux switches</li>
</ul>

<p>Cumulus HCS runs on any platform. However, this chapter assumes a
typical Nutanix deployment with the following configuration:</p>

<ul>
<li>Leaf switches with 48 x 10G or 25G ports</li>
<li>Four or more 40G or 100G uplinks</li>
<li>Nutanix servers are attached to any of the 10G or 25G ports</li>
<li>MLAG peer link is on the first two uplink ports: swp49 and swp50</li>
<li>Connections to other infrastructure are on ports swp51 and above</li>
<li>The eth0 management interface is configured for <a href="Management_VRF">management
VRF</a> via DHCP</li>
<li>For automatic configuration, the gateway IP addresses for all VMs,
including the CVM, do not exist on the Cumulus Linux switches.</li>
</ul>

<p>The example configuration utilizes the following topology. All
configuration focuses on the leaf01 and leaf02 switches. Configurations
for spine01 and spine02 are not included.</p>

<p><img src="attachments/9012165/9012183.png" alt="" /></p>

<h2 id="configure-cumulus-hcs-and-nutanix">Configure Cumulus HCS and Nutanix</h2>

<p>The method you choose for configuring Cumulus HCS and Nutanix depends
upon whether or not you already have Cumulus Linux installed on your
switches, which are named leaf01 and leaf02 in the example configuration
above.</p>

<ul>
<li>If you have bare-metal switches without Cumulus Linux installed,
follow the steps below for configuring a bare-metal switch with ZTP.</li>
<li>If Cumulus Linux is already installed on your switches, follow the
steps below for manually configuring an existing Cumulus Linux
switch.</li>
</ul>

<h3 id="configure-the-service-with-ztp">Configure the Service with ZTP</h3>

<p>The following steps describe how to use zero touch provisioning to
install Cumulus Linux and fully configure Cumulus HCS and Nutanix on
your network. </p>

<p>To do this, you need a Cumulus on a Stick disk image and a USB stick
with at least 1GB of storage.</p>

<ol>
<li>Insert the USB stick into your computer and copy the Cumulus on a
Stick files onto it.</li>

<li><p>On the USB stick, open the ztp_config.txt file in a text editor and
set your Nutanix username and password and the server IP address,
then save and close the file.</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text"># Fill in the parameters below to allow for ZTP to 
# automatically configure the switch for Nutanix
#
# The username for the Nutanix API. Likely the username you use to login to Prism. (Required)
NUTANIX_USERNAME=admin
# The password for the user. (Required)
NUTANIX_PASSWORD=nutanix/4u
# The IP address of a Nutanix CVM or the CVM anycast/cluster IP. (Required)
NUTANIX_IP=10.1.1.123
# IP address and subnet mask of this switch in the CVM subnet. Used to communicate to the Prism API.
SWITCH_CVM_IP=10.1.1.254/24
# If you do not want to use DHCP on the switch eth0, define the static switch IP and mask below. (Optional)
#SWITCH_MANAGEMENT_IP=10.0.0.11/24
# If you define a static IP, what is the gateway the switch should use for management traffic? (Optional)
#SWITCH_DEFAULT_GATEWAY=10.1.1.1
# If you have Layer 2 connections to existing infrastructure, define them here. Separate the interfaces with a comma. (Optional)
UPLINKS=swp51,swp52
# It is assumed that ports swp49 and swp50 will be used for the inter-switch link. If you have other ports, define them here. (Optional)
#PEERLINK=swp49,swp50</code></pre></div></li>

<li><p>Place the USB stick into the Cumulus Linux switch (leaf01) and power
on the switch. Cumulus Linux is automatically installed, including
the license and a baseline configuration. The switch reboots
multiple times during this process. Depending on your specific
hardware platform, this process can take up to 20 minutes. After the
installation completes, the LEDs corresponding to the ports
connected to the Nutanix nodes illuminate in green.</p></li>

<li><p>When the installation completes, remove the USB stick and repeat
this procedure on the other Cumulus Linux switch (leaf02).</p></li>
</ol>

<h3 id="configure-the-service-manually">Configure the Service Manually</h3>

<p>If Cumulus Linux is already installed on your switches, follow the steps
below to configure Cumulus Linux, Nutanix and Cumulus HCS.</p>

<ol>
<li><p>Configure MLAG on both the leaf01 and leaf02 nodes. The <code>sys-mac</code> is
a MAC address from the Cumulus Networks reserved MAC address space
and must be the same on both MLAG peers. If you are deploying more
than one pair of switches with MLAG, the <code>sys-mac</code> must be unique
for each pair of MLAG-configured switches.</p>

<p><strong>Configure MLAG for leaf01</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@leaf01:~$ net add interface swp49,swp50 mtu 9216
cumulus@leaf01:~$ net add clag peer sys-mac 44:38:39:FF:40:00 interface swp49,swp50 primary
cumulus@leaf01:~$ net commit</code></pre></div>
<p><strong>Configure MLAG for leaf02</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@leaf02:~$ net add interface swp49,swp50 mtu 9216
cumulus@leaf02:~$ net add clag peer sys-mac 44:38:39:FF:40:00 interface swp49,swp50 secondary
cumulus@leaf02:~$ net commit</code></pre></div></li>

<li><p>Configure the default layer 2 bridge. Add a unique IP address to
each leaf in the same subnet as the CVM.</p>

<p><strong>Configure the bridge on leaf01</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@leaf01:~$ net add bridge bridge ports peerlink
cumulus@leaf01:~$ net add bridge bridge pvid 1
cumulus@leaf01:~$ net add vlan 1 ip address 10.1.1.201/24
cumulus@leaf01:~$ net commit</code></pre></div>
<p><strong>Configure the bridge on leaf02</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@leaf02:~$ net add bridge bridge ports peerlink
cumulus@leaf02:~$ net add bridge bridge pvid 1
cumulus@leaf02:~$ net add vlan 1 ip address 10.1.1.202/24
cumulus@leaf02:~$ net commit</code></pre></div>
<p>In both configurations the <code>pvid</code> value of <em>1</em> indicates the native
VLAN ID. If you don&rsquo;t know the value for the native VLAN ID, use
<em>1</em>.</p></li>

<li><p>Edit the <code>/etc/default/cumulus-hyperconverged</code> file and set the
Nutanix username, password and server IP address. Do this on both
switches (leaf01 and leaf02). Cumulus Linux uses the settings in
this file to authenticate and communicate with the Nutanix cluster.</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@leaf02:~$ sudo nano /etc/default/cumulus-hyperconverged

### /etc/default/cumulus-hyperconverged config file
# username for Prism (required)
USERNAME=admin
# password for Prism (required)
PASSWORD=nutanixpassword
# CVM address used by the service (required)
SERVER=10.1.1.11
# Hook server address (optional)
#HOOK_SERVER=10.0.0.0
# Hook port (optional)
#HOOK_PORT=9440
# Socket timeout (optional)
#SOCKET_TIMEOUT=10.0.0.0
# single/multi rack configuration (optional)
VXLAN_CONFIG=False
# loglevel: verbose/debug (optional)
LOGLEVEL=verbose
# periodic sync timeout (optional)
#PERIODIC_SYNC_TIMEOUT=60</code></pre></div>
<p>These settings are defined
<a href="#CumulusHyperconvergedSolutionwithNutanix-chs_settings">below</a>.</p>

<p>The server IP address may be a specific Nutanix CVM address or the
virtual cluster IP address.</p></li>

<li><p>Enable and start Cumulus HCS on leaf01 and leaf02.</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@leaf01:~$ sudo systemctl enable cumulus-hyperconverged
cumulus@leaf01:~$ sudo systemctl start cumulus-hyperconverged</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@leaf02:~$ sudo systemctl enable cumulus-hyperconverged
cumulus@leaf02:~$ sudo systemctl start cumulus-hyperconverged</code></pre></div></li>

<li><p>Verify that the service is running on leaf01 and leaf02.</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@leaf01:~$ sudo systemctl status cumulus-hyperconverged
● cumulus-hyperconverged.service - Cumulus Linux Hyperconverged Daemon
   Loaded: loaded (/lib/systemd/system/cumulus-hyperconverged.service; enabled)
   Active: active (running) since Mon 2019-01-07 03:36:26 UTC; 56min ago
 Main PID: 4206 (cumulus-hyperco)
   CGroup: /system.slice/cumulus-hyperconverged.service
           ├─4206 /usr/bin/python /usr/bin/cumulus-hyperconverged
           └─6300 /usr/sbin/lldpcli -f json watch</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@leaf02:~$ sudo systemctl status cumulus-hyperconverged
● cumulus-hyperconverged.service - Cumulus Linux Hyperconverged Daemon
   Loaded: loaded (/lib/systemd/system/cumulus-hyperconverged.service; enabled)
   Active: active (running) since Mon 2019-01-07 03:36:26 UTC; 56min ago
 Main PID: 4207 (cumulus-hyperco)
   CGroup: /system.slice/cumulus-hyperconverged.service
           ├─4207 /usr/bin/python /usr/bin/cumulus-hyperconverged
           └─4300 /usr/sbin/lldpcli -f json watch</code></pre></div>
<p>If the service fails to start, you may find more information in the
service&rsquo;s log file. View the log with sudo journalctl -u
cumulus-hyperconverged.</p></li>

<li><p>Enable the server-facing ports to accept inbound LLDP frames and
configure jumbo MTU on both leaf01 and leaf02.</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@leaf01:~$ net add interface swp1-48 mtu 9216
cumulus@leaf01:~$ net commit</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@leaf02:~$ net add interface swp1-48 mtu 9216
cumulus@leaf02:~$ net commit</code></pre></div></li>
</ol>

<p>At this point, the service is fully configured. It may take up to 60
seconds for LLDP frames to be received to trigger Cumulus HCS.</p>

<h3 id="cumulus-hcs-configuration-settings">Cumulus HCS Configuration Settings</h3>

<p>Some of the settings you can configure include:</p>

<ul>
<li>HOOK_SERVER: the source IP the switch uses when communicating with
the Nutanix API. By default, it follows the routing table.</li>
<li>HOOK_PORT: the port on which the Nutanix CVM is running. The
default is 9440. </li>
<li>SOCKET_TIMEOUT: the amount of time to wait for a timeout when
attempting to communicate with the Nutanix API. The default
is 10 seconds.</li>
<li>VXLAN_CONFIG: when set to TRUE, Cumulus HCS automatically
provisions VXLAN VNIs as well as VLANs. </li>
<li>LOGLEVEL: describes the logging level. Verbose and Debug are
acceptable values. Verbose provides information about bond and VLAN
creation while Debug helps in troubleshooting by providing more
information from sources like LLDP and the Nutanix webhook. </li>
<li>PERIODIC_SYNC_TIMEOUT: how long before Cumulus HCS times out
dynamic configurations without contacting the Nutanix API. The
default is 60 seconds.</li>
</ul>

<h2 id="configure-uplinks">Configure Uplinks</h2>

<p>How you configure uplinks depends upon whether you configured Cumulus
HCS with ZTP or manually.</p>

<p>If you used ZTP, you can edit the ZTP settings file to define the uplink
ports and the VLANs assigned to those uplinks.</p>

<p>If you manually configured the service, you need to enable the uplinks
and define the associated VLANs, as shown below. You need to configure
both leaf01 and leaf02.</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@leaf01:~$ net add interface swp51-52 mtu 9216
cumulus@leaf01:~$ net add interface swp51-52 bridge vids 1-2999,4000-4094
cumulus@leaf01:~$ net add interface swp51-52 bridge pvid 1
cumulus@leaf01:~$ net commit</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@leaf02:~$ net add interface swp51-52 mtu 9216
cumulus@leaf02:~$ net add interface swp51-52 bridge vids 1-2999,4000-4094
cumulus@leaf02:~$ net add interface swp51-52 bridge pvid 1
cumulus@leaf02:~$ net commit</code></pre></div>
<p>In this example, all VLANs are allowed on the uplink ports. Configuring
any set of VLANs is allowed. Be aware that <a href="VLAN-aware-Bridge-Mode_8362673.html#VLAN-awareBridgeMode-vlan_range">VLANs 3000-3999 are
reserved</a>
on Cumulus Linux. This example assumes the untagged or native VLAN is
VLAN ID (<code>pvid</code>) <em>1</em>. Change the VLAN ID as needed. </p>

<h2 id="add-local-default-gateways">Add Local Default Gateways</h2>

<p>You can add one or more local default gateways on both switches to
provide a redundant solution, as shown below. It does not matter whether
you configured Cumulus HCS with ZTP or manually. ZTP does not add any
gateway configuration.</p>

<p>To provide redundant gateways for the dual-attached Nutanix servers,
Cumulus Linux relies on Virtual Router Redundancy (VRR). VRR enables
hosts to communicate with any redundant router without reconfiguration,
running dynamic routing protocols, or running router redundancy
protocols. This means that redundant routers will respond to Address
Resolution Protocol (ARP) requests from hosts. Routers are configured to
respond in an identical manner, but if one fails, the other redundant
routers will continue to respond, leaving the hosts with the impression
that nothing has changed.</p>

<p><strong>Configure leaf01</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@leaf01:~$ net add vlan 1 ip address 10.1.1.11/24
cumulus@leaf01:~$ net add vlan 1 ip address-virtual 00:00:5e:00:01:01 10.1.1.1/24
cumulus@leaf01:~$ net commit</code></pre></div>
<p><strong>Configure leaf02</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@leaf02:~$ net add vlan 1 ip address 10.1.1.12/24
cumulus@leaf02:~$ net add vlan 1 ip address-virtual 00:00:5e:00:01:01 10.1.1.1/24
cumulus@leaf02:~$ net commit</code></pre></div>
<p>The first configuration line defines the IP address assigned to each
switch, which is required and must be unique. On leaf01, this IP address
is 10.1.1.<sup>11</sup>&frasl;<sub>24</sub>; on leaf02, it is 10.1.1.<sup>12</sup>&frasl;<sub>24</sub>.</p>

<p>The second line defines the virtual IP address that is used as the
default gateway address for any hosts in this VLAN. On both leaf01 and
leaf02 this IP address is 10.1.1.<sup>1</sup>&frasl;<sub>24</sub>. The address-virtual MAC address
is assigned from a reserved pool of Cumulus Networks MAC addresses. The
address must start with 00:00:05:00:01: and end with any hex value
between 00 and ff. Both leaf01 and leaf02 must have the same MAC
address. Outside of this switch pair, this MAC address must be unique
and only be assigned to a single switch pair in your network.</p>

<h2 id="out-of-band-solutions">Out-of-band Solutions</h2>

<p>You can configure out-of-band management in one of two ways:</p>

<ul>
<li>Using Cumulus RMP, which is the recommended way.</li>
<li>Running Cumulus Linux on a supported 1G non-Cumulus RMP switch.</li>
</ul>

<h3 id="cumulus-rmp">Cumulus RMP</h3>

<p>Cumulus RMP is a ready-to-deploy solution that enables out-of-band
management for web-scale networks. With Cumulus RMP, you can directly
manage and support Nutanix systems in the rack without relying on the
rest of the network.</p>

<p>To deploy Nutanix with Cumulus RMP, connect the Nutanix 1G IPMI, 1G
Shared IPMI and 1G ports to the Cumulus RMP switch. No additional
configuration is required.</p>

<p>Cumulus RMP does not support MLAG or active/active connections across
Cumulus RMP switches. Connections across more than one Cumulus RMP
switch rely on traditional spanning tree protocol for redundancy.</p>

<h3 id="other-cumulus-linux-1g-switches">Other Cumulus Linux 1G Switches</h3>

<p>If you want to use a non-Cumulus RMP 1G switch that supports Cumulus
Linux for out-of-band management, you must manually install the Cumulus
Linux software and license and set up the baseline configuration. The
default Cumulus on a Stick image has this information. </p>

<p>Once you install the software, you can use the following command to
configure all ports for a single, untagged management VLAN, including
any uplinks.  </p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@oob-switch:~$ net add interface swp1-52 bridge access 1</code></pre></div>
<p>You can assign a management IP address to this same untagged bridge
interface. Use an appropriate IP address for your infrastructure.</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@oob-switch:~$ net add vlan 1 ip address 192.0.2.1/24</code></pre></div>
<p>Apply the configuration:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@oob-switch:~$ net commit</code></pre></div>
<p>In both configurations the value of <em>1</em> indicates the native or untagged
VLAN ID. If you want to use a different VLAN ID, just replace the 1 in
both commands with the desired VLAN ID.</p>

<h2 id="troubleshoot-cumulus-hcs">Troubleshoot Cumulus HCS</h2>

<p>Some ways you can troubleshoot Cumulus HCS include:</p>

<ul>
<li>Checking that bonds are being dynamically created.</li>
<li>Ensuring LLDP messages are being received.</li>
<li>Verifying the Cumulus HCS configuration. </li>
</ul>

<h3 id="verify-dynamic-bonds-are-being-created">Verify Dynamic Bonds Are Being Created</h3>

<p>Use the net show interface bonds command to verify that bonds are being
dynamically created. The following example shows that three bonds,
bond_swp1, bond_swp2 and bond_swp3 are created automatically, which
means that Cumulus HCS is operating correctly. The name of every
dynamically created bond begins with bond_ and ends with the interface
name.</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@leaf01:~$ net show interface bonds
    Name       Speed   MTU  Mode     Summary
--  ---------  -----  ----  -------  ----------------------------------
UP  bond_swp1  1G     1500  802.3ad  Bond Members: swp1(UP)
UP  bond_swp2  1G     1500  802.3ad  Bond Members: swp2(UP)
UP  bond_swp3  1G     1500  802.3ad  Bond Members: swp3(UP)
UP  peerlink   2G     1500  802.3ad  Bond Members: swp49(UP), swp50(UP)</code></pre></div>
<h3 id="verify-lldp-messages-are-being-received">Verify LLDP Messages Are Being Received</h3>

<p>If bonds are not being created,
then <a href="Link_Layer_Discovery_Protocol">LLDP</a> messages may not be getting
through. You can check for this possibility using the <code>net show lldp</code>
command: </p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@leaf01:~$ net show lldp
LocalPort  Speed  Mode           RemoteHost       RemotePort
---------  -----  -------------  ---------------  ----------
swp1       1G     BondMember     NTNX-e08c61ec-A  ens3
swp2       1G     BondMember     NTNX-d618a06d-A  ens3
swp3       1G     BondMember     NTNX-4e6eac27-A  ens3
swp49      1G     BondMember     leaf02           swp49
swp50      1G     BondMember     leaf02           swp50
swp52      1G     NotConfigured  spine01          swp1
swp52      1G     NotConfigured  spine02          swp1</code></pre></div>
<h3 id="view-detailed-nutanix-lldp-information">View Detailed Nutanix LLDP Information</h3>

<p>Cumulus HCS replies on the LLDP SysDescr field to identify a Nutanix
host. Run the <code>net show lldp &lt;swp&gt;</code> command to view the complete LLDP
details of the Nutanix node and verify the SysDescr field.</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@leaf01:~$ net show lldp swp1
-------------------------------------------------------------------------------
LLDP neighbors:
-------------------------------------------------------------------------------
Interface:    swp1, via: LLDP, RID: 37, Time: 0 day, 01:42:23
  Chassis:
    ChassisID:    mac 2c:c2:60:50:f6:8a
    SysName:      NTNX-e08c61ec-A
    SysDescr:     CentOS Linux 7 (Core) Linux 4.4.77-1.el7.nutanix.20180425.199.x86_64 #1 SMP Thu Apr 26 01:01:53 UTC 2018 x86_64
    MgmtIP:       10.1.1.10
    MgmtIP:       fe80::2ec2:60ff:fe50:f68a
    Capability:   Bridge, on
    Capability:   Router, off
    Capability:   Wlan, off
    Capability:   Station, off
  Port:
    PortID:       mac 2c:c2:60:50:f6:8a
    PortDescr:    ens3
    TTL:          120
    PMD autoneg:  supported: yes, enabled: yes
      Adv:          10Base-T, HD: yes, FD: yes
      Adv:          100Base-TX, HD: yes, FD: yes
      Adv:          1000Base-T, HD: no, FD: yes
      MAU oper type: 1000BaseTFD - Four-pair Category 5 UTP, full duplex mode
-------------------------------------------------------------------------------</code></pre></div>
<h2 id="caveats">Caveats</h2>

<ul>
<li>Reloading Cumulus HCS causes the bond interfaces to rebuild. For the
stability of the Nutanix cluster, do not reload the service on both
leaf switches simultaneously.</li>
</ul>

<p> </p>

<p> </p>

<p> </p>

<h2 id="attachments">Attachments:</h2>

<p><img src="images/icons/bullet_blue.gif" alt="" />{width=&ldquo;8&rdquo; height=&ldquo;8&rdquo;} <a href="attachments/9012165/9012183.png">Cumulus Nutanix
topo.png</a> (image/png)</p>
</article>

      
<div class="align-center book-git-footer justify-between">
  
  <div>
    <a href="https://github.com/cawleyflower/testDocs/commit/0f1fa77f244c4b4642688df1f5e961e88daa6e08" title='Last modified March 4, 2019 16:11 EST by Cawleyflower' target="_blank" rel="noopener">
      <img src="/svg/code-merge.svg" /> Last Modified Mar 4, 2019
    </a>
  </div>
  
  
</div>


    </div>

    
  
  
  <aside class="book-toc fixed">
    <nav id="TableOfContents">
<ul>
<li><a href="#cumulus-hyperconverged-solution-with-nutanix">Cumulus Hyperconverged Solution with Nutanix</a>
<ul>
<li><a href="#contents">Contents</a></li>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#configure-cumulus-hcs-and-nutanix">Configure Cumulus HCS and Nutanix</a>
<ul>
<li><a href="#configure-the-service-with-ztp">Configure the Service with ZTP</a></li>
<li><a href="#configure-the-service-manually">Configure the Service Manually</a></li>
<li><a href="#cumulus-hcs-configuration-settings">Cumulus HCS Configuration Settings</a></li>
</ul></li>
<li><a href="#configure-uplinks">Configure Uplinks</a></li>
<li><a href="#add-local-default-gateways">Add Local Default Gateways</a></li>
<li><a href="#out-of-band-solutions">Out-of-band Solutions</a>
<ul>
<li><a href="#cumulus-rmp">Cumulus RMP</a></li>
<li><a href="#other-cumulus-linux-1g-switches">Other Cumulus Linux 1G Switches</a></li>
</ul></li>
<li><a href="#troubleshoot-cumulus-hcs">Troubleshoot Cumulus HCS</a>
<ul>
<li><a href="#verify-dynamic-bonds-are-being-created">Verify Dynamic Bonds Are Being Created</a></li>
<li><a href="#verify-lldp-messages-are-being-received">Verify LLDP Messages Are Being Received</a></li>
<li><a href="#view-detailed-nutanix-lldp-information">View Detailed Nutanix LLDP Information</a></li>
</ul></li>
<li><a href="#caveats">Caveats</a></li>
<li><a href="#attachments">Attachments:</a></li>
</ul></li>
</ul>
</nav>
  </aside>



  </main>

  
  
</body>

</html>
