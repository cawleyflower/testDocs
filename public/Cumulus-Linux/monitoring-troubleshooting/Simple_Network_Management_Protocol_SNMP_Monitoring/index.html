<!DOCTYPE html><html>

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simple Network Management Protocol S N M P Monitoring | Cumulus Networks Documentation</title>

<link href="https://fonts.googleapis.com/css?family=Oxygen|Oxygen+Mono:300,400,700" rel="stylesheet">
<link rel="stylesheet" href="/normalize.min.css">

<link rel="stylesheet" href="/book.min.50a619ce4c0e99594908d162684f42218608aa6fde2bd83cca5025d59ba535e3.css">

<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>

<body>
  <input type="checkbox" style="display: none" id="menu-control" />
  <main class="flex container">

    <aside class="book-menu fixed">
      <nav role="navigation">
<h2 class="book-brand">
  <a href="http://example.org/">Cumulus Networks Documentation</a>
</h2>



    


  
  
    
    
  
 
  <ul>
    
    <li><a href="/Cumulus-Linux/installation-management/">
    Installation Management</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/installation-management/Adding_and_Updating_Packages/">Adding and Updating Packages</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/installation-management/Installing_a_New_Cumulus_Linux_Image/">Installing a New Cumulus Linux Image</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/installation-management/Managing_Cumulus_Linux_Disk_Images/">Managing Cumulus Linux Disk Images</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/installation-management/Upgrading_Cumulus_Linux/">Upgrading Cumulus Linux</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/installation-management/Using_Snapshots/">Using Snapshots</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/installation-management/Zero_Touch_Provisioning_-_ZTP/">Zero Touch Provisioning Z T P</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/Cumulus-Linux/layer1-switch-ports/">
    Layer1 Switch Ports</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/802.1X_Interfaces/">802.1 X Interfaces</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/Buffer_and_Queue_Management/">Buffer and Queue Management</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/DHCP_Relays/">D H C P Relays</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/DHCP_Servers/">D H C P Servers</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/Facebook_Voyager_Optical_Interfaces/">Facebook Voyager Optical Interfaces</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/Prescriptive_Topology_Manager_-_PTM/">Prescriptive Topology Manager P T M</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/interface_configuration_and_management/Interface_Configuration_and_Management/">Interface Configuration and Management</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer1-switch-ports/interface_configuration_and_management/switch_port_attributes/Switch_Port_Attributes/">Switch Port Attributes</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/Cumulus-Linux/layer2/">
    Layer2</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/layer2/Copy_of_Prescriptive_Topology_Manager_-_PTM/">Copy of Prescriptive Topology Manager P T M</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/Copy_of_Spanning_Tree_and_Rapid_Spanning_Tree/">Copy of Spanning Tree and Rapid Spanning Tree</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/Ethernet_Bridging_-_VLANs/">Ethernet Bridging v L a Ns</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/IGMP_and_MLD_Snooping/">I G M P and M L D Snooping</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/LACP_Bypass/">L a C P Bypass</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/Link_Layer_Discovery_Protocol/">Link Layer Discovery Protocol</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/Multi-Chassis_Link_Aggregation_-_MLAG/">Multi Chassis Link Aggregation M L a G</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/Spanning_Tree_and_Rapid_Spanning_Tree/">Spanning Tree and Rapid Spanning Tree</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/Virtual_Router_Redundancy_-_VRR/">Virtual Router Redundancy v R R</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/bonding_link_aggregation/Bonding_-_Link_Aggregation/">Bonding Link Aggregation</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/ethernet_bridging_vlans/Traditional_Bridge_Mode/">Traditional Bridge Mode</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/ethernet_bridging_vlans/VLAN-aware_Bridge_Mode/">V L a N Aware Bridge Mode</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/ethernet_bridging_vlans/VLAN_Tagging/">V L a N Tagging</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/link_layer_discovery_protocol/voice_vlan/Voice_VLAN/">Voice v L a N</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer2/virtual_router_redundancy/ifplugd/ifplugd/">Ifplugd</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/Cumulus-Linux/layer3/">
    Layer3</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/layer3/Address_Resolution_Protocol_-_ARP/">Address Resolution Protocol a R P</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Bidirectional_Forwarding_Detection_-_BFD/">Bidirectional Forwarding Detection B F D</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Border_Gateway_Protocol_-_BGP/">Border Gateway Protocol B G P</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Configuring_FRRouting/">Configuring F R Routing</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Equal_Cost_Multipath_Load_Sharing_-_Hardware_ECMP/">Equal Cost Multipath Load Sharing Hardware E C M P</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/FRRouting_Overview/">F R Routing Overview</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/GRE_Tunneling/">G R E Tunneling</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Introduction_to_Routing_Protocols/">Introduction to Routing Protocols</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Management_VRF/">Management v R F</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Network_Topology/">Network Topology</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Open_Shortest_Path_First_-_OSPF/">Open Shortest Path First O S P F</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Open_Shortest_Path_First_v3_-_OSPFv3/">Open Shortest Path First V3 O S P Fv3</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Policy-based_Routing/">Policy Based Routing</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Protocol_Independent_Multicast_-_PIM/">Protocol Independent Multicast P I M</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Redistribute_Neighbor/">Redistribute Neighbor</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Routing/">Routing</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Segment_Routing/">Segment Routing</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/Virtual_Routing_and_Forwarding_-_VRF/">Virtual Routing and Forwarding v R F</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/configuring_frrouting/comparing_nclu_and_vtysh_commands/Comparing_NCLU_and_vtysh_Commands/">Comparing N C L U and Vtysh Commands</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/layer3/frrouting_overview/Upgrading_from_Quagga_to_FRRouting/">Upgrading From Quagga to F R Routing</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/Cumulus-Linux/monitoring-troubleshooting/">
    Monitoring Troubleshooting</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/ASIC_Monitoring/">A S I C Monitoring</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/FRRouting_Log_Message_Reference/">F R Routing Log Message Reference</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Monitoring_Best_Practices/">Monitoring Best Practices</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Monitoring_System_Hardware/">Monitoring System Hardware</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Monitoring_Virtual_Device_Counters/">Monitoring Virtual Device Counters</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Network_Troubleshooting/">Network Troubleshooting</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Resource_Diagnostics_Using_cl-resource-query/">Resource Diagnostics Using Cl Resource Query</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Simple_Network_Management_Protocol_SNMP_Monitoring/" class="active">Simple Network Management Protocol S N M P Monitoring</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Single_User_Mode_-_Boot_Recovery/">Single User Mode Boot Recovery</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Troubleshooting_Network_Interfaces/">Troubleshooting Network Interfaces</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/Understanding_the_cl-support_Output_File/">Understanding the Cl Support Output File</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/monitoring_system_hardware/network_switch_port_led_and_stats_led/Network_Switch_Port_LED_and_Status_LED_Guidelines/">Network Switch Port L E D and Status L E D Guidelines</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/network_troubleshooting/monitoring_system_statistics/Monitoring_System_Statistics_and_Network_Traffic_with_sFlow/">Monitoring System Statistics and Network Traffic With S Flow</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/network_troubleshooting/using_nclu_to_troubleshoot/Using_NCLU_to_Troubleshoot_Your_Network_Configuration/">Using N C L U to Troubleshoot Your Network Configuration</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/simple_network_management/using_nutanix_prisim_as_monitoring_tool/Using_Nutanix_Prism_as_a_Monitoring_Tool/">Using Nutanix Prism as a Monitoring Tool</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/switchd_Log_Message_Reference/">Switchd Log Message Reference</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/troubleshooting_network_interfaces/monitoring_interfaces_and_transcievers_using_ethtool/Monitoring_Interfaces_and_Transceivers_Using_ethtool/">Monitoring Interfaces and Transceivers Using Ethtool</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/understanding_cl-support_output_file/troubleshooting_log_files/Troubleshooting_Log_Files/">Troubleshooting Log Files</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/monitoring-troubleshooting/understanding_cl-support_output_file/troubleshooting_the_etc_directory/Troubleshooting_the_etc_Directory/">Troubleshooting the Etc Directory</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/Cumulus-Linux/network-solutions/">
    Network Solutions</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/network-solutions/Anycast_Design_Guide/">Anycast Design Guide</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-solutions/Cumulus_Hyperconverged_Solution_with_Nutanix/">Cumulus Hyperconverged Solution With Nutanix</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-solutions/Cumulus_Networks_Services_Demos/">Cumulus Networks Services Demos</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-solutions/Data_Center_Host_to_ToR_Architecture/">Data Center Host to to R Architecture</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-solutions/Docker_on_Cumulus_Linux/">Docker on Cumulus Linux</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-solutions/OpenStack_Neutron_ML2_and_Cumulus_Linux/">Open Stack Neutron M L2 and Cumulus Linux</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-solutions/RDMA_over_Converged_Ethernet_-_RoCE/">R D M a Over Converged Ethernet Ro C E</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/Cumulus-Linux/network-visualization/">
    Network Visualization</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/network-visualization/Eng_Update_of_VXLAN_Hyperloop/">Eng Update of v X L a N Hyperloop</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/Ethernet_Virtual_Private_Network_-_EVPN/">Ethernet Virtual Private Network E v P N</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/Hybrid_Cloud_Connectivity_with_QinQ_and_VXLANs/">Hybrid Cloud Connectivity With Qin Q and v X L a Ns</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/LNV_Full_Example/">L N v Full Example</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/Lightweight_Network_Virtualization_Overview/">Lightweight Network Virtualization Overview</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/Static_VXLAN_Configurations/">Static v X L a N Configurations</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/VXLAN_Routing/">V X L a N Routing</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/VXLAN_Scale/">V X L a N Scale</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/VXLAN_Tunnel_DSCP_Operations__DRAFT/">V X L a N Tunnel D S C P Operations — D R a F T</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/Virtualization_Integrations/">Virtualization Integrations</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/static_vxlan_configurations/static_mac_bindings/Static_MAC_Bindings_with_VXLAN/">Static M a C Bindings With v X L a N</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/static_vxlan_configurations/static_vxlan_tunnels/Static_VXLAN_Tunnels/">Static v X L a N Tunnels</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/virtualization_integrations/integrating_hardware_vteps_vmware_nsx-mh/Integrating_Hardware_VTEPs_with_VMware_NSX-MH/">Integrating Hardware v T E Ps With v Mware N S X M H</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/virtualization_integrations/integrating_vteps_midonet_openstack/Integrating_Hardware_VTEPs_with_Midokura_MidoNet_and_OpenStack/">Integrating Hardware v T E Ps With Midokura Mido Net and Open Stack</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/virtualization_integrations/integrating_vteps_vmware_nsx-v/Integrating_Hardware_VTEPs_with_VMware_NSX-V/">Integrating Hardware v T E Ps With v Mware N S X V</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/network-visualization/virtualization_integrations/ovsdb_server_high_availability/OVSDB_Server_High_Availability/">O v S D B Server High Availability</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/Cumulus-Linux/system-config/">
    System Config</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/system-config/Authentication_Authorization_and_Accounting/">Authentication Authorization and Accounting</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Configuring_a_Global_Proxy/">Configuring a Global Proxy</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Configuring_switchd/">Configuring Switchd</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Copy_of_Netfilter_-_ACLs/">Copy of Netfilter a C Ls</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/HTTP_API/">H T T P a P I</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Netfilter_-_ACLs/">Netfilter a C Ls</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Network_Command_Line_Utility_-_NCLU/">Network Command Line Utility N C L U</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Power_over_Ethernet_-_PoE/">Power Over Ethernet Po E</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Services_and_Daemons_in_Cumulus_Linux/">Services and Daemons in Cumulus Linux</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Setting_Date_and_Time/">Setting Date and Time</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/authentication_authorization_accounting/LDAP_Authentication_and_Authorization/">L D a P Authentication and Authorization</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/authentication_authorization_accounting/RADIUS_AAA/">R a D I U S a a A</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/authentication_authorization_accounting/SSH_for_Remote_Access/">S S H for Remote Access</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/authentication_authorization_accounting/TACACS_Plus/">T a C a C S Plus</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/authentication_authorization_accounting/User_Accounts/">User Accounts</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/authentication_authorization_accounting/Using_sudo_to_Delegate_Privileges/">Using Sudo to Delegate Privileges</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/netfilter_acls/default_cumulus_linux_acl_config/Default_Cumulus_Linux_ACL_Configuration/">Default Cumulus Linux a C L Configuration</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/netfilter_acls/default_cumulus_linux_acl_config/Filtering_Learned_MAC_Addresses/">Filtering Learned M a C Addresses</a>
    </li>
    
  </ul>

    </li>
    

    
    <li>
      <a href="/Cumulus-Linux/whats-new/">What&#39;s New</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/cumulus-linux-index/Cumulus_Linux_Index/">Cumulus Linux Index</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/quick-start/Quick_Start_Guide/">Quick Start Guide</a>
    </li>
    
  </ul>








</nav>

    </aside>

    <div class="book-page">
      <header class="align-center justify-between book-header">
  <label for="menu-control">
    <img src="/svg/menu.svg" />
  </label>
  <strong>Simple Network Management Protocol S N M P Monitoring</strong>
</header>

      
<article class="markdown">

<h1 id="simple-network-management-protocol-snmp-monitoring">Simple Network Management Protocol (SNMP) Monitoring</h1>

<p>Cumulus Linux uses the open source Net-SNMP agent <code>snmpd</code>, version 5.7,
which provides support for most of the common industry-wide MIBs,
including interface counters and TCP/UDP IP stack data.</p>

<h2 id="contents">Contents</h2>

<p><img src="images/icons/grey_arrow_down.png" alt="" />{.expand-control-image}This topic
describes &hellip;</p>

<ul>
<li><a href="#SimpleNetworkManagementProtocol(SNMP)Monitoring-History">History</a></li>
<li><a href="#SimpleNetworkManagementProtocol(SNMP)Monitoring-IntroductiontoSimpleNetworkManagementProtocol">Introduction to Simple Network Management
Protocol</a>

<ul>
<li><a href="#SimpleNetworkManagementProtocol(SNMP)Monitoring-SNMPManagers">SNMP
Managers</a></li>
<li><a href="#SimpleNetworkManagementProtocol(SNMP)Monitoring-SNMPAgents">SNMP
Agents</a></li>
<li><a href="#SimpleNetworkManagementProtocol(SNMP)Monitoring-ManagementInformationBase(MIB)">Management Information Base
(MIB)</a></li>
</ul></li>
<li><a href="#SimpleNetworkManagementProtocol(SNMP)Monitoring-GettingStarted">Getting
Started</a></li>
<li><a href="#SimpleNetworkManagementProtocol(SNMP)Monitoring-ConfigureSNMP">Configure
SNMP</a>

<ul>
<li><a href="#SimpleNetworkManagementProtocol(SNMP)Monitoring-ConfigureSNMPwithNCLU">Configure SNMP with
NCLU</a></li>
</ul></li>
<li><a href="#SimpleNetworkManagementProtocol(SNMP)Monitoring-ConfigureSNMPManually">Configure SNMP
Manually</a>

<ul>
<li><a href="#SimpleNetworkManagementProtocol(SNMP)Monitoring-StarttheSNMPDaemon">Start the SNMP
Daemon</a></li>
<li><a href="#SimpleNetworkManagementProtocol(SNMP)Monitoring-ConfigureSNMPwithManagementVRF(usedpriortoCumulusLinux3.6)">Configure SNMP with Management VRF (used prior to Cumulus Linux
3.6)</a></li>
<li><a href="#SimpleNetworkManagementProtocol(SNMP)Monitoring-SetuptheCustomCumulusNetworksMIBs">Set up the Custom Cumulus Networks
MIBs</a></li>
<li><a href="#SimpleNetworkManagementProtocol(SNMP)Monitoring-public_communitySettheCommunityString">Set the Community
String</a></li>
</ul></li>
<li><a href="#SimpleNetworkManagementProtocol(SNMP)Monitoring-frrEnableSNMPSupportforFRRouting">Enable SNMP Support for
FRRouting</a>

<ul>
<li><a href="#SimpleNetworkManagementProtocol(SNMP)Monitoring-Enablethe.1.3.6.1.2.1Range">Enable the .1.3.6.1.2.1
Range</a></li>
<li><a href="#SimpleNetworkManagementProtocol(SNMP)Monitoring-ConfigureSNMPv3">Configure
SNMPv3</a></li>
</ul></li>
<li><a href="#SimpleNetworkManagementProtocol(SNMP)Monitoring-ManuallyConfigureSNMPTraps(Non-NCLU)">Manually Configure SNMP Traps
(Non-NCLU)</a>

<ul>
<li><a href="#SimpleNetworkManagementProtocol(SNMP)Monitoring-GenerateEventNotificationTraps">Generate Event Notification
Traps</a></li>
<li><a href="#SimpleNetworkManagementProtocol(SNMP)Monitoring-snmptrapd.conf">snmptrapd.conf</a></li>
</ul></li>
<li><a href="#SimpleNetworkManagementProtocol(SNMP)Monitoring-supported_mibsSupportedMIBs">Supported
MIBs</a></li>
<li><a href="#SimpleNetworkManagementProtocol(SNMP)Monitoring-passpersistPassPersistScripts">Pass Persist
Scripts</a></li>
<li><a href="#SimpleNetworkManagementProtocol(SNMP)Monitoring-Troubleshooting">Troubleshooting</a></li>
</ul>

<h2 id="history">History</h2>

<p>SNMP is an IETF standards-based network management architecture and
protocol that traces its roots back to Carnegie-Mellon University in
1982. Since then, it has been modified by programmers at the University
of California. In 1995, this code was also made publicly available as
the UCD project. After that, <code>ucd-snmp</code> was extended by work done at the
University of Liverpool as well as later in Denmark. In late 2000, the
project name changed to <code>net-snmp</code> and became a fully-fledged
collaborative open source project. The version used by Cumulus Networks
is based on the latest <code>net-snmp</code> 5.7 branch with added custom MIBs and
pass-through and pass-persist scripts (<a href="#SimpleNetworkManagementProtocol(SNMP)Monitoring-passpersist">see
below</a> for
more information on pass persist scripts).</p>

<h2 id="introduction-to-simple-network-management-protocol">Introduction to Simple Network Management Protocol</h2>

<p>SNMP Management servers gather information from different systems in a
consistent manner and the paths to the relevant information are
standardized in IETF RFCs. SNMPs longevity is due to the fact that it
standardizes the objects collected from devices, the protocol used for
transport, and architecture of the management systems. The most widely
used, and most insecure, versions of SNMP are versions 1 and 2c and
their popularity is largely due to implementations that have been in use
for decades. SNMP version 3 is the recommended version because of its
advanced security features. In general, a network being profiled by SNMP
Management Stations mainly consist of devices containing SNMP agents.
The agent running on Cumulus Linux switches and routers is the snmpd
daemon.</p>

<h3 id="snmp-managers">SNMP Managers</h3>

<p>An SNMP Network Management System (NMS) is a computer that is configured
to poll SNMP agents (in this case, Cumulus Linux switches and routers)
to gather information and present it. This manager can be any machine
that can send query requests to SNMP agents with the correct
credentials. This NMS can be a large set of monitoring suite or as
simple as some scripts that collect and display data. The managers
generally poll the agents and the agents respond with the data. There
are a variety of polling command-line tools (snmpget, snmpgetnext,
snmpwalk, snmpbulkget, snmpbulkwalk, and so on).  SNMP agents can also
send unsolicited Traps/Inform messages to the SNMP Manager based on
predefined criteria (like link changes).</p>

<h3 id="snmp-agents">SNMP Agents</h3>

<p>The SNMP agents (<code>snmpd</code>) running on the switches do the bulk of the
work and are responsible for gathering information about the local
system and storing data in a format that can be queried updating an
internal database called the <em>management information base</em>, or MIB. The
MIB is a standardized, hierarchical structure that stores information
that can be queried. Parts of the MIB tree are available and provided to
incoming requests originating from an NMS host that has authenticated
with the correct credentials. You can configure the Cumulus Linux switch
with usernames and credentials to provide authenticated and encrypted
responses to NMS requests. The <code>snmpd</code>  agent can also proxy requests
and act as a <strong>master agent</strong> to sub-agents running on other daemons
(FRR, LLDP).</p>

<h3 id="management-information-base-mib">Management Information Base (MIB)</h3>

<p>The MIB is a database that is implemented on the daemon (or agent) and
follows IETF RFC standards to which the manager and agents adhere. It is
a hierarchical structure that, in many areas, is globally standardized,
but also flexible enough to allow vendor-specific additions.  Cumulus
Networks implements a number of custom enterprise MIB tables and these
are defined in text files located on the switch and in files named
<code>/usr/share/snmp/mibs/Cumulus*</code>. The MIB structure is best understood as
a top-down hierarchical tree. Each branch that forks off is labeled with
both an identifying number (starting with 1) and an identifying string
that is unique for that level of the hierarchy. These strings and
numbers can be used interchangeably. A specific node of the tree can be
traced from the unnamed root of the tree to the node in question. The
parent IDs (numbers or strings) are strung together, starting with the
most general to form an address for the MIB Object. Each junction in the
hierarchy is represented by a dot in this notation so that the address
ends up being a series of ID strings or numbers separated by dots. This
entire address is known as an object identifier (OID).</p>

<p>Hardware vendors that embed SNMP agents in their devices sometimes
implement custom branches with their own fields and data points.
However, there are standard MIB branches that are well defined and can
be used by any device. The standard branches discussed here are all
under the same parent branch structure. This branch defines information
that adheres to the MIB-2 specification, which is a revised standard for
compliant devices. You can use various online and command-line tools to
translate between numbers and string and to also provide definitions for
the various MIB Objects. For example, you can view the <code>sysLocation</code>
object in the system table with either a string of numbers
<strong>1.3.6.1.2.1.1.6</strong> or the string representation
<strong>iso.org.dod.internet.mgmt.mib-2.system.sysLocation. </strong>You can view the
definition with the snmptranslate (1) command (found in the snmp Debian
package).</p>

<p><strong>snmptranslate Command</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-plain" data-lang="plain">/home/cumulus# snmptranslate -Td -On SNMPv2-MIB::sysLocation                                                                                                                                                                                                                                                                                      
.1.3.6.1.2.1.1.6
sysLocation OBJECT-TYPE
  -- FROM       SNMPv2-MIB
  -- TEXTUAL CONVENTION DisplayString
  SYNTAX        OCTET STRING (0..255) 
  DISPLAY-HINT  &#34;255a&#34;
  MAX-ACCESS    read-write
  STATUS        current
  DESCRIPTION   &#34;The physical location of this node (e.g., &#39;telephone
            closet, 3rd floor&#39;).  If the location is unknown, the
            value is the zero-length string.&#34;
::= { iso(1) org(3) dod(6) internet(1) mgmt(2) mib-2(1) system(1) 6 }

/home/cumulus# snmptranslate  -Tp -IR   system
+--system(1)
   |
   +-- -R-- String    sysDescr(1)
   |        Textual Convention: DisplayString
   |        Size: 0..255
   +-- -R-- ObjID     sysObjectID(2)
   +-- -R-- TimeTicks sysUpTime(3)
   |  |
   |  +--sysUpTimeInstance(0)
   |
   +-- -RW- String    sysContact(4)
   |        Textual Convention: DisplayString
   |        Size: 0..255
   +-- -RW- String    sysName(5)
   |        Textual Convention: DisplayString
   |        Size: 0..255
   +-- -RW- String    sysLocation(6)
   |        Textual Convention: DisplayString
   |        Size: 0..255
   +-- -R-- INTEGER   sysServices(7)
   |        Range: 0..127
   +-- -R-- TimeTicks sysORLastChange(8)
   |        Textual Convention: TimeStamp</code></pre></div>
<p>The section <code>1.3.6.1 </code>or <code> iso.org.dod.internet</code> is the OID that defines
internet resources. The<code> 2 </code>or<code> mgmt </code>that follows is for a management
subcategory. The <code>1</code> or <code>mib-2</code> under that defines the MIB-2
specification.    And finally, the 1 or system is the parent for a
number of child objects (sysDescr, sysObjectID, sysUpTime, sysContact,
sysName, sysLocation, sysServices, and so on).</p>

<h2 id="getting-started">Getting Started</h2>

<p>The simplest use case for using SNMP consists of creating a readonly
community password and enabling a listening address for the loopback
address (this is the default listening-address provided).  This allows
for testing functionality of <code>snmpd</code> before extending the listening
addresses to IP addresses reachable from outside the switch or router.
This first sample configuration adds a listening address on the loopback
interface (this is not a change from the default so we get a message
stating that the configuration has not changed), sets a simple community
password (SNMPv2) for testing, changes the system-name object in the
system table, commits the change, checks the status of <code>snmpd</code>, and gets
the first MIB object in the system table:</p>

<p><code>cumulus@router1:~$ net add snmp-server listening-address localhost</code></p>

<p><code>Configuration has not changed </code></p>

<p><code>cumulus@router1:~$ net add snmp-server readonly-community mynotsosecretpassword access any</code></p>

<p><code>cumulus@router1:~$ net add snmp-server system-name my little router</code></p>

<p><code>cumulus@router1:~$ net commit</code></p>

<p><code> </code></p>

<p><code>cumulus@router1:~$ net show snmp-server status</code></p>

<p><code> </code></p>

<p><code>Simple Network Management Protocol (SNMP) Daemon.</code></p>

<p><code>---------------------------------  ----------------</code></p>

<p><code>Current Status                     active (running)</code></p>

<p><code>Reload Status                      enabled</code></p>

<p><code>Listening IP Addresses             localhost</code></p>

<p><code>Main snmpd PID                     13669</code></p>

<p><code>Version 1 and 2c Community String  Configured</code></p>

<p><code>Version 3 Usernames                Not Configured</code></p>

<p><code>---------------------------------  ---------------- </code></p>

<p><code> </code></p>

<p><code>cumulus@router1:~$ snmpgetnext -v 2c -c mynotsosecretpassword localhost SNMPv2-MIB::sysName</code></p>

<p><code>SNMPv2-MIB::sysName.0 = STRING: my little router</code></p>

<h2 id="configure-snmp">Configure SNMP</h2>

<p>For external SNMP NMS systems to poll Cumulus Linux switches and
routers, you must configure the SNMP agent (snmpd) running on the switch
with one or more IP addresses (with
<code>net add snmp-server listening-address &lt;ip&gt;</code>) on which the agent
listens. You must configure these IP addresses on interfaces that have
link state UP. By default, the SNMP configuration has a listening
address of localhost (or 127.0.0.1), which allows the daemon to respond
to SNMP requests originating on the switch itself. This is a useful
method of checking the configuration for SNMP without exposing the
switch to attacks from the outside. The only other required
configuration is a readonly community password (configured with
<code>net add snmp-server readonly-community &lt;password&gt; access &lt;ip | any&gt;</code><code>)</code>,
that allows polling of the various MIB objects on the device itself.
SNMPv3 is recommended since SNMPv2c (with a community string) exposes
the password in the <code>GetRequest</code> and <code>GetResponse</code> packets. SNMPv3 does
not expose the username passwords and has the option of encrypting the
packet contents.</p>

<p>Cumulus Linux 3.4 and later releases support configuring SNMP with NCLU.
While NCLU does not provide functionality to configure every single
<code>snmpd</code> feature, it is the recommended method of configuring <code>snmpd</code>.
You are not restricted to using NCLU for configuration and can edit the
<code>/etc/snmp/snmpd.conf</code> file and control <code>snmpd</code> with <code>systemctl</code>
commands. For Cumulus Linux versions earlier than 3.0, <code>snmpd</code> has a
default configuration that listens to incoming requests on all
interfaces.</p>

<p>Cumulus Linux 3.6 and later releases support configuring VRFs for
listening-addresses as well as Trap/Inform support. If management VRF is
enabled on the switch, this places the eth0 interface in the management
VRF. When configuring the listening-address for snmp-server, you must
specify an additional parameter to enable listening on the eth0
interface with the following command:</p>

<p><code>cumulus@router1:~$ net add snmp-server listening-address 10.10.10.10 vrf mgmt</code></p>

<p>These additional parameters are described in detail below.</p>

<p>You must add a default community string for v1 or v2c environments or
the <code>snmpd</code> daemon does not respond to any requests. For security
reasons, the default configuration configures <code>snmpd</code> to listen to SNMP
requests on the loopback interface so access to the switch is restricted
to requests originating from the switch itself. The only required
commands for <code>snmpd</code> to function are a <code>listening-address</code> and either a
<code>username</code> or a<code>readonly-community</code> string.</p>

<h3 id="configure-snmp-with-nclu">Configure SNMP with NCLU</h3>

<p>The table below highlights the structure of NCLU commands available for
configuring SNMP. An example command set is provided below the table.
NCLU restarts the <code>snmpd</code> daemon after configuration changes are made
and committed.</p>

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Command</th>
<th>Summary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>net del all</code> or <code>net del snmp-server all</code></td>
<td>Removes all entries in the <code>/etc/snmp/snmpd.conf</code> file and replaces them with defaults. The defaults remove all SNMPv3 usernames, readonly-communities, and a listening-address of localhost is configured.</td>
</tr>
<tr class="even">
<td><code>net add snmp-server listening-address (localhost|localhost-v6)</code></td>
<td><p>For security reasons, the localhost is set to a listening address 127.0.0.1 by default so that the SNMP agent only responds to requests originating on the switch itself. You can also configure listening only on the IPv6 localhost address with localhost-v6. When using IPv6 addresses or localhost, you can use a <code>readonly-community-v6</code> for v1 and v2c requests. For v3 requests, you can use the <code>username</code> command to restrict access.</p>
<div class="code panel pdl" style="border-width: 1px;">
<div class="codeContent panelContent pdl">
<pre class="plain" data-syntaxhighlighter-params="brush: plain; gutter: false; theme: Confluence" data-theme="Confluence" style="brush: plain; gutter: false; theme: Confluence"><code>net add snmp-server listening-address localhost
net add snmp-server listening-address localhost-v6</code></pre>
</div>
</div></td>
</tr>
<tr class="odd">
<td><code>net add snmp-server listening-address (all|all-v6)</code></td>
<td><p>Configures the <code>snmpd</code> agent to listen on all interfaces for either IPv4 or IPv6 UDP port 161 SNMP requests. This command removes all other individual IP addresses configured.</p>
<p>Note: This command does not allow <code>snmpd</code> to cross VRF table boundaries. To listen on IP addresses in different VRF tables, use multiple listening-address commands each with a VRF name, as shown below.</p>
<div class="code panel pdl" style="border-width: 1px;">
<div class="codeContent panelContent pdl">
<pre class="plain" data-syntaxhighlighter-params="brush: plain; gutter: false; theme: Confluence" data-theme="Confluence" style="brush: plain; gutter: false; theme: Confluence"><code>net add snmp-server listening-address all
net add snmp-server listening-address all-v6</code></pre>
</div>
</div></td>
</tr>
<tr class="even">
<td><code>net add snmp-server listening-address IP_ADDRESS IP_ADDRESS ...</code></td>
<td><p>Sets <code>snmpd</code> to listen to a specific IPv4 or IPv6 address, or a group of addresses with space separated values, for incoming SNMP queries. If VRF tables are used, be sure to specify an IP address with an associated VRF name, as shown below. If you omit a VRF name, the default VRF is used.</p>
<div class="code panel pdl" style="border-width: 1px;">
<div class="codeContent panelContent pdl">
<pre class="plain" data-syntaxhighlighter-params="brush: plain; gutter: false; theme: Confluence" data-theme="Confluence" style="brush: plain; gutter: false; theme: Confluence"><code>net add snmp-server listening-address 10.10.10.10</code></pre>
</div>
</div>
<div class="code panel pdl" style="border-width: 1px;">
<div class="codeContent panelContent pdl">
<pre class="plain" data-syntaxhighlighter-params="brush: plain; gutter: false; theme: Confluence" data-theme="Confluence" style="brush: plain; gutter: false; theme: Confluence"><code>net add snmp-server listening-address 10.10.10.10 44.44.44.44</code></pre>
</div>
</div></td>
</tr>
<tr class="odd">
<td><p><code>net add snmp-server listening-address IP_ADDRESS vrf VRF_NAME</code></p></td>
<td><p>Sets snmpd to listen to a specific IPv4 or IPv6 address on an interface within a particular VRF. With VRFs, identical IP addresses can exist in different VRF tables. This command restricts listening to a particular IP address within a particular VRF. If the VRF name is not given, the default VRF is used.</p>
<div class="code panel pdl" style="border-width: 1px;">
<div class="codeContent panelContent pdl">
<pre class="plain" data-syntaxhighlighter-params="brush: plain; gutter: false; theme: Confluence" data-theme="Confluence" style="brush: plain; gutter: false; theme: Confluence"><code>net add snmp-server listening-address 10.10.10.10 vrf mgmt</code></pre>
</div>
</div></td>
</tr>
<tr class="even">
<td><p><code>net add snmp-server username [user name] (auth-none|auth-md5|auth-sha)   [(encrypt-des|encrypt-aes) ] (oid |view )</code></p></td>
<td><p>Creates an SNMPv3 username and the necessary credentials for access. You can restrict a user to a particular OID tree or predefined view name if these are specified. If you specify auth-none, no authentication password is required. Otherwise, an MD5 or SHA password is required for access to the MIB objects. If specified, an encryption password is used to hide the contents of the request and response packets.</p>
<div class="code panel pdl" style="border-width: 1px;">
<div class="codeContent panelContent pdl">
<pre class="plain" data-syntaxhighlighter-params="brush: plain; gutter: false; theme: Confluence" data-theme="Confluence" style="brush: plain; gutter: false; theme: Confluence"><code>net add snmp-server username testusernoauth  auth-none
net add snmp-server username testuserauth    auth-md5  myauthmd5password 
net add snmp-server username testuserboth    auth-md5  mynewmd5password   encrypt-aes  myencryptsecret 
net add snmp-server username limiteduser1    auth-md5  md5password1       encrypt-aes  myaessecret       oid 1.3.6.1.2.1.1</code></pre>
</div>
</div></td>
</tr>
<tr class="odd">
<td><code>net add snmp-server viewname [view name] (included | excluded) [OID or name]</code></td>
<td><p>Creates a view name that is used in readonly-community to restrict MIB tree exposure. By itself, this view definition has no effect; however, when linked to an SNMPv3 username or community password, and a host from a restricted subnet, any SNMP request with that username and password must have a source IP address within the configured subnet.</p>
<p>Note: OID can be either a string of period separated decimal numbers or a unique text string that identifies an SNMP MIB object. Some MIBs are not installed by default; you must install them either by hand or with the latest Debian package called snmp-mibs-downloader. You can remove specific view name entries with the delete command or with just a view name to remove all entries matching that view name. You can define a specific view name multiple times and fine tune to provide or restrict access using the included or excluded command to specify branches of certain MIB trees.</p>
<div class="code panel pdl" style="border-width: 1px;">
<div class="codeContent panelContent pdl">
<pre class="plain" data-syntaxhighlighter-params="brush: plain; gutter: false; theme: Confluence" data-theme="Confluence" style="brush: plain; gutter: false; theme: Confluence"><code>net add snmp-server viewname cumulusOnly included .1.3.6.1.4.1.40310
net add snmp-server viewname cumulusCounters included .1.3.6.1.4.1.40310.2

net add snmp-server readonly-community simplepassword access any view cumulusOnly
net add snmp-server username testusernoauth  auth-none view cumulusOnly
net add snmp-server username limiteduser1    auth-md5  md5password1 encrypt-aes  myaessecret  view cumulusCounters</code></pre>
</div>
</div></td>
</tr>
<tr class="even">
<td><code>net add snmp-server (readonly-community | readonly-community-v6) [password] access (any | localhost | [network])         [(view [view name]) or [oid [oid or name])</code></td>
<td><p>This command defines the password required for SNMP version 1 or 2c requests for GET or GETNEXT.  By default, this provides access to the full OID tree for such requests, regardless of from where they were sent. There is no default password set, so <code>snmpd</code> does not respond to any requests that arrive. Users often specify a source IP address token to restrict access to only that host or network given. You can specify a view name to restrict the subset of the OID tree.</p>
<p>Examples of <code>readonly-community </code>commands are shown below. The first command sets the read only community string to <code>simplepassword</code> for SNMP requests and this restricts requests to those sourced from hosts in the 10.10.10.0/24 subnet and restricts viewing to the <em>mysystem</em> view name defined with the <code>viewname</code> command. The second example creates a read-only community password <em>showitall</em> that allows access to the entire OID tree for requests originating from any source IP address.</p>
<div class="code panel pdl" style="border-width: 1px;">
<div class="codeContent panelContent pdl">
<pre class="text" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence" style="brush: text; gutter: false; theme: Confluence"><code>net add snmp-server viewname mysystem included 1.3.6.1.2.1.1
net add snmp-server readonly-community simplepassword access 10.10.10.0/24 view mysystem

net add snmp-server readonly-community showitall access any</code></pre>
</div>
</div></td>
</tr>
<tr class="odd">
<td><code>net add snmp-server trap-destination (localhost | [ipaddress]) [vrf vrf name] community-password  [password]  [version [1 | 2c]]</code></td>
<td><p>For SNMP versions 1 and 2C, this command sets the SNMP Trap destination IP address. Multiple destinations can exist, but you must set up at least one to enable SNMP Traps to be sent. Removing all settings disables SNMP traps. The default version is 2c, unless otherwise configured. You must include a VRF name with the IP address to force Traps to be sent in a non-default VRF table.</p>
<div class="code panel pdl" style="border-width: 1px;">
<div class="codeContent panelContent pdl">
<pre class="text" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence" style="brush: text; gutter: false; theme: Confluence"><code>net add snmp-server trap-destination 10.10.10.10 community-password mynotsosecretpassword version 1
net add snmp-server trap-destination 20.20.20.20 vrf mgmt community-password mymanagementvrfpassword version 2c
 </code></pre>
</div>
</div></td>
</tr>
<tr class="even">
<td><p><code>net add snmp-server trap-destination (localhost | [ipaddress]) [vrf vrf name] username &lt;v3 username&gt; (auth-md5|auth-sha) &lt;authentication password&gt; [(encrypt-des|encrypt-aes) &lt;encryption password&gt;] engine-id &lt;text&gt; [inform]</code></p></td>
<td><p>For SNMPv3 Trap and Inform messages, this command configures the trap destination IP address (with an optional VRF name). You must define the authentication type and password. The encryption type and password are optional. You must specify the engine ID/user name pair. The <code>inform </code>keyword is used to specify an Inform message where the SNMP agent waits for an acknowledgement.</p>
<p>For Traps, the engine ID/user name is for the CL switch <strong>sending</strong> the traps. This can be found at the end of the <code>/var/lib/snmp/snmpd.conf</code> file labelled <code>oldEngineID</code>. Configure this same engine ID/user name (with authentication and encryption passwords) for the Trap daemon receiving the trap to validate the received Trap.</p>
<div class="code panel pdl" style="border-width: 1px;">
<div class="codeContent panelContent pdl">
<pre class="text" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence" style="brush: text; gutter: false; theme: Confluence"><code>net add snmp-server trap-destination 10.10.10.10 username myv3userrsion auth-md5 md5password1 encrypt-aes myaessecret engine-id  0x80001f888070939b14a514da5a00000000
net add snmp-server trap-destination 20.20.20.20 vrf mgmt username mymgmtvrfusername auth-md5 md5password2 encrypt-aes myaessecret2 engine-id  0x80001f888070939b14a514da5a00000000</code></pre>
</div>
</div>
<p>For Inform messages (Informs are acknowledged version 3 Traps), the engine ID/user name is the one used to create the username on the <strong>receiving Trap daemon server</strong>. The Trap receiver sends the response for the Trap message using its own engine ID/user name. In practice, the trap daemon generates the usernames with its own engine ID and after these are created, the SNMP server (or agent) needs to use these engine ID/user names when configuring the Inform messages so that they are correctly authenticated and the correct response is sent to the <code>snmpd</code> agent that sent it.</p>
<div class="code panel pdl" style="border-width: 1px;">
<div class="codeContent panelContent pdl">
<pre class="text" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence" style="brush: text; gutter: false; theme: Confluence"><code>net add snmp-server trap-destination 10.10.10.10 username myv3userrsion auth-md5 md5password1 encrypt-aes myaessecret engine-id  0x80001f888070939b14a514da5a00000000 inform
net add snmp-server trap-destination 20.20.20.20 vrf mgmt username mymgmtvrfusername auth-md5 md5password2 encrypt-aes myaessecret2 engine-id  0x80001f888070939b14a514da5a00000000 inform</code></pre>
</div>
</div></td>
</tr>
<tr class="odd">
<td><code>net add snmp-server trap-link-up [check-frequency [seconds]]</code></td>
<td><p>Enables notifications for interface link-up to be sent to SNMP Trap destinations.</p>
<div class="code panel pdl" style="border-width: 1px;">
<div class="codeContent panelContent pdl">
<pre class="plain" data-syntaxhighlighter-params="brush: plain; gutter: false; theme: Confluence" data-theme="Confluence" style="brush: plain; gutter: false; theme: Confluence"><code>net add snmp-server trap-link-up check-frequency 15</code></pre>
</div>
</div></td>
</tr>
<tr class="even">
<td><code>net add snmp-server trap-link-down [check-frequency [seconds]]</code></td>
<td><p>Enables notifications for interface link-down to be sent to SNMP Trap destinations.</p>
<div class="code panel pdl" style="border-width: 1px;">
<div class="codeContent panelContent pdl">
<pre class="plain" data-syntaxhighlighter-params="brush: plain; gutter: false; theme: Confluence" data-theme="Confluence" style="brush: plain; gutter: false; theme: Confluence"><code>net add snmp-server trap-link-down check-frequency 10</code></pre>
</div>
</div></td>
</tr>
<tr class="odd">
<td><code>net add snmp-server trap-snmp-auth-failures</code></td>
<td><p>Enables SNMP Trap notifications to be sent for every SNMP authentication failure.</p>
<div class="code panel pdl" style="border-width: 1px;">
<div class="codeContent panelContent pdl">
<pre class="plain" data-syntaxhighlighter-params="brush: plain; gutter: false; theme: Confluence" data-theme="Confluence" style="brush: plain; gutter: false; theme: Confluence"><code>net add snmp-server trap-snmp-auth-failures</code></pre>
</div>
</div></td>
</tr>
<tr class="even">
<td><p><code>net add snmp-server trap-cpu-load-average one-minute [threshold] five-minute [5-min-threshold]</code></p>
<p><code>        fifteen-minute [15-min-threshold]</code></p></td>
<td><p>Enables a trap when the cpu-load-average exceeds the configured threshold. You can only use integers or floating point numbers.</p>
<div class="code panel pdl" style="border-width: 1px;">
<div class="codeContent panelContent pdl">
<pre class="plain" data-syntaxhighlighter-params="brush: plain; gutter: false; theme: Confluence" data-theme="Confluence" style="brush: plain; gutter: false; theme: Confluence"><code>net add snmp-server trap-cpu-load-average one-minute 4.34 five-minute 2.32 fifteen-minute 6.5</code></pre>
</div>
</div></td>
</tr>
</tbody>
</table>

<p>This table describes system setting configuration commands for
SNMPv2-MIB.</p>

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Command</th>
<th>Summary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>net add snmp-server system-location [string]</code></td>
<td><p>Sets the system physical location for the node in the SNMPv2-MIB system table.</p>
<div class="code panel pdl" style="border-width: 1px;">
<div class="codeContent panelContent pdl">
<pre class="plain" data-syntaxhighlighter-params="brush: plain; gutter: false; theme: Confluence" data-theme="Confluence" style="brush: plain; gutter: false; theme: Confluence"><code>net add snmp-server system-location  My private bunker</code></pre>
</div>
</div></td>
</tr>
<tr class="even">
<td><code>net add snmp-server system-contact [string]</code></td>
<td><p>Sets the identification of the contact person for this managed node, together with information on how to contact this person.</p>
<div class="code panel pdl" style="border-width: 1px;">
<div class="codeContent panelContent pdl">
<pre class="plain" data-syntaxhighlighter-params="brush: plain; gutter: false; theme: Confluence" data-theme="Confluence" style="brush: plain; gutter: false; theme: Confluence"><code>net add snmp-server system-contact user X at myemail@example.com</code></pre>
</div>
</div></td>
</tr>
<tr class="odd">
<td><code>net add snmp-server system-name [string]</code></td>
<td><p>Sets an administratively-assigned name for the managed node. By convention, this is the fully-qualified domain name of the node.</p>
<div class="code panel pdl" style="border-width: 1px;">
<div class="codeContent panelContent pdl">
<pre class="plain" data-syntaxhighlighter-params="brush: plain; gutter: false; theme: Confluence" data-theme="Confluence" style="brush: plain; gutter: false; theme: Confluence"><code>net add snmp-server system-name CumulusBox number 1,543,567</code></pre>
</div>
</div></td>
</tr>
</tbody>
</table>

<p>The example commands below enable an SNMP agent to listen on all IPv4
addresses with a community string password, set the trap destination
host IP address, and create four types of SNMP traps.</p>
<div class="highlight"><pre class="chroma"><code class="language-plain" data-lang="plain">cumulus@switch:~$ net add snmp-server listening-address all
cumulus@switch:~$ net add snmp-server readonly-community tempPassword access any
cumulus@switch:~$ net add snmp-server trap-destination 1.1.1.1 community-password mypass version 2c
cumulus@switch:~$ net add snmp-server trap-link-up check-frequency 15
cumulus@switch:~$ net add snmp-server trap-link-down check-frequency 10
cumulus@switch:~$ net add snmp-server trap-cpu-load-average one-minute 7.45 five-minute 5.14
cumulus@switch:~$ net add snmp-server trap-snmp-auth-failures</code></pre></div>
<h2 id="configure-snmp-manually">Configure SNMP Manually</h2>

<p>If you need to manually edit the SNMP configuration; for example, if the
necessary option has not been implemented in NCLU, you need to edit the
configuration directly, which is stored in
the <code>/etc/snmp/snmpd.conf</code> file.</p>

<p>Use caution when editing this file. The next time you use NCLU to update
your SNMP configuration, if NCLU is unable to correctly parse the
syntax, some of the options might be overwritten. </p>

<p>Make sure you do not delete the <code>snmpd.conf</code> file; this can cause issues
with the package manager the next time you update Cumulus Linux.</p>

<p>The SNMP daemon, <code>snmpd</code>, uses the <code>/etc/snmp/snmpd.conf</code> configuration
file for most of its configuration. The syntax of the most important
keywords are defined in the following table.</p>

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Syntax</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>agentaddress</strong></td>
<td><p><strong>Required.</strong> This command sets the protocol, IP address, and the port for <code>snmpd</code> to listen for <strong>incoming</strong> requests. The IP address must exist on an interface that has link UP on the switch where <code>snmpd</code> is being used. By default, this is set to <em>udp:127.0.0.1:161</em>, which means <code>snmpd</code> listens on the loopback interface and only responds to requests (<code>snmpwalk</code>, <code>snmpget</code>, <code>snmpgetnext</code>) originating from the switch. A wildcard setting of <em>udp:161,udp6:161</em> forces <code>snmpd</code> to listen on all IPv4 and IPv6 interfaces for incoming SNMP requests. You can configure multiple IP addresses as comma-separated values; for example, <em>udp:66.66.66.66:161,udp:77.77.77.77:161,udp6:[2001::1]:161.</em> You can use multiple lines to define listening addresses. To bind to a particular IP address within a particular VRF table, follow the IP address with a <code>%</code> and the name of the VRF table (for example, <code>10.10.10.10%mgmt</code>).</p></td>
</tr>
<tr class="even">
<td><p><strong>rocommunity</strong></p></td>
<td><p><strong>Required.</strong> This command defines the password that is required for SNMP version 1 or 2c requests for GET or GETNEXT.  By default, this provides access to the full OID tree for such requests, regardless of from where they were sent. There is no default password set, so <code>snmpd</code> does not respond to any requests that arrive. Specify a source IP address token to restrict access to only that host or network given. Specify a view name (as defined above) to restrict the subset of the OID tree.</p>
<p>Examples of <code>rocommunity</code> commands are shown below. The first command sets the read only community string to <code>simplepassword</code> for SNMP requests sourced from the 10.10.10.0/24 subnet and restricts viewing to the <em>systemonly</em> view name defined previously with the <code>view</code> command. The second example creates a read-only community password that allows access to the entire OID tree from any source IP address.</p>
<div class="code panel pdl" style="border-width: 1px;">
<div class="codeContent panelContent pdl">
<pre class="text" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence" style="brush: text; gutter: false; theme: Confluence"><code>rocommunity simplepassword 10.10.10.0/24 -V systemonly

rocommunity cumulustestpassword</code></pre>
</div>
</div></td>
</tr>
<tr class="odd">
<td><strong>view</strong></td>
<td><p>This command defines a view name that specifies a subset of the overall OID tree. You can reference this restricted view by name in the <code>rocommunity</code> command to link the view to a password that is used to see this restricted OID subset. By default, the <code>snmpd.conf</code> file contains numerous views with the <em>systemonly</em> view name.</p>
<div class="code panel pdl" style="border-width: 1px;">
<div class="codeContent panelContent pdl">
<pre class="text" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence" style="brush: text; gutter: false; theme: Confluence"><code>view   systemonly  included   .1.3.6.1.2.1.1 

view   systemonly  included   .1.3.6.1.2.1.2

view   systemonly  included   .1.3.6.1.2.1.3 </code></pre>
</div>
</div>
<p>The <em>systemonly</em> view is used by <code>rocommunity</code> to create a password for access to only these branches of the OID tree.</p></td>
</tr>
<tr class="even">
<td><p><strong>trapsink</strong></p>
<p><strong>trap2sink</strong></p></td>
<td><p>This command defines the IP address of the notification (or trap) receiver for either SNMPv1 traps or SNMPv2 traps. If you specify several sink directives, multiple copies of each notification (in the appropriate formats) are generated. You must configure a trap server to receive and decode these trap messages (for example, <code>snmptrapd</code>). You can configure the address of the trap receiver with a different protocol and port but this is most often left out. The defaults are to use the well-known UDP packets and port 162.</p></td>
</tr>
<tr class="odd">
<td><p><strong>createuser</strong></p>
<p><strong>iquerysecName</strong></p>
<p><strong>rouser</strong></p></td>
<td><p>These three commands define an internal SNMPv3 username that is required for <code>snmpd</code> to send traps. This username is required to authorize the DisMan service even though SNMPv3 is not being configured for use. The example <code>snmpd.conf</code> configuration shown below creates <em>snmptrapusernameX</em> as the username (this is just an example username) using the <code>createUser</code> command. <code>iquerysecname</code> defines the default SNMPv3 username to be used when making internal queries to retrieve monitored expressions. <code>rouser</code> specifies the username for these SNMPv3 queries. All three are required for <code>snmpd</code> to retrieve information and send built-in traps or for those configured with the <code>monitor</code> command shown below in the examples.</p>
<div class="code panel pdl" style="border-width: 1px;">
<div class="codeContent panelContent pdl">
<pre class="text" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence" style="brush: text; gutter: false; theme: Confluence"><code>createuser snmptrapusernameX

iquerysecname snmptrapusernameX

rouser snmptrapusernameX</code></pre>
</div>
</div></td>
</tr>
<tr class="even">
<td><p><strong>linkUpDownNotifications yes</strong></p></td>
<td><p>This command enables link up and link down trap notifications, assuming the other trap configurations settings are set. This command configures the Event MIB tables to monitor the ifTable for network interfaces being taken up or down, and triggering a <em>linkUp</em> or <em>linkDown</em> notification as appropriate. This is equivalent to the following configuration:</p>
<div class="code panel pdl" style="border-width: 1px;">
<div class="codeContent panelContent pdl">
<pre class="text" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence" style="brush: text; gutter: false; theme: Confluence"><code>notificationEvent  linkUpTrap    linkUp   ifIndex ifAdminStatus ifOperStatus

notificationEvent  linkDownTrap  linkDown ifIndex ifAdminStatus ifOperStatus 

monitor  -r 60 -e linkUpTrap   &quot;Generate linkUp&quot; ifOperStatus != 2

monitor  -r 60 -e linkDownTrap &quot;Generate linkDown&quot; ifOperStatus == 2</code></pre>
</div>
</div></td>
</tr>
<tr class="odd">
<td><p><strong>defaultMonitors yes</strong></p></td>
<td><p>This command configures the Event MIB tables to monitor the various UCD-SNMP-MIB tables for problems (as indicated by the appropriate xxErrFlag column objects) and send a trap. This assumes you have downloaded the <code>snmp-mibs-downloader</code> Debian package and commented out <code>mibs</code> from the <code>/etc/snmp/snmp.conf</code> file (#mibs). This command is exactly equivalent to the following configuration:</p>
<div class="code panel pdl" style="border-width: 1px;">
<div class="codeContent panelContent pdl">
<pre class="text" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence" style="brush: text; gutter: false; theme: Confluence"><code>monitor   -o prNames -o prErrMessage &quot;process table&quot; prErrorFlag != 0

monitor   -o memErrorName -o memSwapErrorMsg &quot;memory&quot; memSwapError != 0

monitor   -o extNames -o extOutput &quot;extTable&quot; extResult != 0

monitor   -o dskPath -o dskErrorMsg &quot;dskTable&quot; dskErrorFlag != 0

monitor   -o laNames -o laErrMessage  &quot;laTable&quot; laErrorFlag != 0

monitor   -o fileName -o fileErrorMsg  &quot;fileTable&quot; fileErrorFlag != 0</code></pre>
</div>
</div></td>
</tr>
</tbody>
</table>

<h3 id="start-the-snmp-daemon">Start the SNMP Daemon</h3>

<p>Use the recommended process described below to start <code>snmpd</code> and monitor
it using <code>systemctl</code>.</p>

<p>To start the SNMP daemon:</p>

<ol>
<li><p>Start the <code>snmpd</code> daemon:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ sudo systemctl start snmpd.service</code></pre></div></li>

<li><p>Configure the <code>snmpd</code> daemon to start automatically after reboot:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ sudo systemctl enable snmpd.service</code></pre></div></li>

<li><p>To enable <code>snmpd</code> to restart automatically after failure:</p>

<ol>
<li>Create a file called
<code>/etc/systemd/system/snmpd.service.d/restart.conf</code>.</li>

<li><p>Add the following lines:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">[Service]
Restart=always
RestartSec=60</code></pre></div></li>

<li><p>Run <code>sudo systemctl daemon-reload</code>.</p></li>
</ol></li>
</ol>

<p>After the service starts, you can use SNMP to manage various components
on the switch.</p>

<h3 id="configure-snmp-with-management-vrf-used-prior-to-cumulus-linux-3-6">Configure SNMP with Management VRF (used prior to Cumulus Linux 3.6)</h3>

<p>When you configure <a href="https://docs.cumulusnetworks.com/display/DOCS/Management+VRF">Management
VRF</a>, you
need to be aware of the interface IP addresses on which SNMP is
listening. If you set listening-address to all, the <code>snmpd</code> daemon
responds to incoming requests on all interfaces that are in the default
VRF. If you prefer to listen on a limited number of IP addresses,
Cumulus Networks recommends that you run only one instance of
the <code>snmpd</code> daemon and specify the VRF name along with the
listening-address. You can configure IP addresses in different VRFs and
a single SNMP daemon listens on multiple IP addresses each with its own
VRF. Because SNMP has native VRF awareness, using systemctl commands to
manage snmpd in different VRFs is no longer necessary.</p>

<p>SNMP configuration in NCLU is VRF aware so you can configure the
<code>snmpd</code> daemon to listen to incoming SNMP requests on a particular IP
address within particular VRFs. Because interfaces in a particular VRF
(routing table) are not aware of interfaces in a different VRF,
the <code>snmpd</code> daemon only responds to polling requests and sends traps on
the interfaces of the VRF on which it is configured. </p>

<p>When management VRF is configured, configure the listening-address with
a VRF name as shown above.  This allows snmpd to receive and respond to
SNMP polling requests on eth0. </p>

<p>Prior to CL 3.6, you could not configure a VRF name in the
listening-address or the trap-destination commands. To manually handle
VRF functionality, you had to do the following:</p>

<ol>
<li>Configure all the required SNMP settings with NCLU. Pay particular
attention to the listening-address configuration setting, which
should contain one or more IP addresses that belong to interfaces
within a single VRF (if management VRF is configured, this is
typically the IP address of eth0 ). You can use IP addresses other
than eth0, but the interfaces for these IP addresses must be in the
same VRF (typically the management VRF).</li>

<li><p>Commit the changes to start the <code>snmpd</code> daemon in the default VRF.</p></li>

<li><p>Manually stop the <code>snmpd</code> daemon from running in the default VRF.</p></li>

<li><p>Manually restart the <code>snmpd</code>  daemon in the management VRF.</p></li>
</ol>

<p>Running Multiple Instances of snmpd</p>

<p>Prior to CL 3.6, more complex configurations may have been needed; for
example, you can run more than one <code>snmpd</code> daemon (one in each VRF
designed to receive SNMP polling requests). Cumulus Networks does
not recommend this for memory and cpu resource reasons. However, if this
is required, you must use a separate configuration file with each
instance of the <code>snmpd</code> daemon. You can use a copy of the
<code>/etc/snmp/snmpd.conf</code> file. When you use this file, start
an <code>snmpd</code> daemon with the following command:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ sudo /usr/sbin/snmpd -y -LS 0-4 d -Lf /dev/null -u snmp -g snmp -I -smux -p /run/snmpd.pid -C -c &lt;new snmp config filename&gt; (edited)</code></pre></div>
<p>To use management VRF, you need to configure the IP address of eth0 as
the listening-address. In the example below, eth0 IP address is
10.10.10.10. You can also add other <code>snmp-server</code> configurations, then
commit the changes.</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ net add snmp-server listening-address 10.10.10.10
cumulus@switch:~$ net add snmp-server readonly-community tempPassword access any
cumulus@switch:~$ net pending
cumulus@switch:~$ net commit</code></pre></div>
<p>This restarts the <code>snmpd</code> daemon in the default VRF. Then, to run
<code>snmpd</code> in the correct VRF, stop the daemon in the default VRF (or stop
any other <code>snmpd</code> daemons that happen to be running), then restart
<code>snmpd</code> in the management VRF so that it can respond to requests on
interfaces only in that VRF. Make sure that only one instance of the
<code>snmpd</code> daemon is running and that it is running in the desired VRF.
Assuming the Management VRF has been enabled, the following example
shows how to stop <code>snmpd</code> and restart it in the management VRF.</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:mgmt-vrf:~$ systemctl stop snmpd.service
cumulus@switch:mgmt-vrf:~$ systemctl disable snmpd.service
cumulus@switch:mgmt-vrf:~$ ps aux | grep snmpd
cumulus@switch:mgmt-vrf:~$ 
cumulus@switch:mgmt-vrf:~$ systemctl start snmpd@mgmt.service
cumulus@switch:mgmt-vrf:~$ systemctl enable snmpd.service
cumulus@switch:mgmt-vrf:~$ systemctl status snmpd@mgmt.service
root@switch:mgmt-vrf:/home/cumulus# systemctl status snmpd@mgmt.service                                                                                                                                                                                                                                                                               ● snmpd@mgmt.service - Simple Network Management Protocol (SNMP) Daemon.                                                                                                                                                                                                                                                                                       Loaded: loaded (/lib/systemd/system/snmpd.service; disabled)                                                                                                                                                                                                                                                                                               Drop-In: /run/systemd/generator/snmpd@.service.d                                                                                                                                                                                                                                                                                                                     └─vrf.conf
   Active: active (running) since Thu 2017-12-07 20:05:41 UTC; 2min 22s ago                                                                                                                                                                                                                                                                                  Main PID: 30880 (snmpd)
   CGroup: /system.slice/system-snmpd.slice/snmpd@mgmt.service                                                                                                                                                                                                                                                                                                         └─30880 /usr/sbin/snmpd -y -LS 0-4 d -Lf /dev/null -u snmp -g snmp -I -smux -p /run/snmpd.pid -f
                                                                                                                                                                                                                                                                                                                                                            Dec 07 20:05:41 cel-redxp-01 systemd[1]: Started Simple Network Management Protocol (SNMP) Daemon..
 
cumulus@switch:mgmt-vrf:~$ ps aux | grep snmpd
snmp     30880  0.4  0.3  57176 12276 ?        Ss   20:05   0:00 /usr/sbin/snmpd -y -LS 0-4 d -Lf /dev/null -u snmp -g snmp -I -smux -p /run/snmpd.pid -f</code></pre></div>
<h3 id="set-up-the-custom-cumulus-networks-mibs">Set up the Custom Cumulus Networks MIBs</h3>

<p>No changes are required in the <code>/etc/snmp/snmpd.conf</code> file on the switch
to support the custom Cumulus Networks MIBs. The following lines are
already included by default and provide support for both the Cumulus
Counters and the Cumulus Resource Query MIBs.</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">sysObjectID 1.3.6.1.4.1.40310
pass_persist .1.3.6.1.4.1.40310.1 /usr/share/snmp/resq_pp.py
pass_persist .1.3.6.1.4.1.40310.2 /usr/share/snmp/cl_drop_cntrs_pp.py</code></pre></div>
<p>However, you need to copy several files to the NMS server for the custom
Cumulus MIB to be recognized on NMS server.</p>

<ul>
<li><p><code>/usr/share/snmp/mibs/Cumulus-Snmp-MIB.txt</code></p></li>

<li><p><code>/usr/share/snmp/mibs/Cumulus-Counters-MIB.txt</code></p></li>

<li><p><code>/usr/share/snmp/mibs/Cumulus-Resource-Query-MIB.txt</code></p></li>
</ul>

<h3 id="set-the-community-string">Set the Community String</h3>

<p>The <code>snmpd</code> authentication for versions 1 and 2 is disabled by default
in Cumulus Linux. You can enable this password (called a community
string) by setting <strong>rocommunity</strong> (for read-only access)
or <strong>rwcommunity</strong> (for read-write access). Setting a community string
is required. </p>

<p>To enable read-only querying by a client:</p>

<ol>
<li><p>Open the <code>/etc/snmp/snmpd.conf</code> file in a text editor.</p></li>

<li><p>To allow read-only access, uncomment the following line, then save
the file:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">rocommunity public default -V systemonly</code></pre></div>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Keyword</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>rocommunity</td>
<td>Read-only community; <em>rwcommunity</em> is for read-write access.</td>
</tr>
<tr class="even">
<td>public</td>
<td><p>Plain text password/community string.</p>
<div>
<div>
<p>Cumulus Networks strongly recommends you change this password to something else.</p>
</div>
</div></td>
</tr>
<tr class="odd">
<td>default</td>
<td>The <em>default</em> keyword allows connections from any system. The <em>localhost</em> keyword allows requests only from the local host. A restricted source can either be a specific hostname (or address), or a subnet, represented as IP/MASK (like 10.10.10.0/255.255.255.0), or IP/BITS (like 10.10.10.0/24), or the IPv6 equivalents.</td>
</tr>
<tr class="even">
<td>systemonly</td>
<td>The name of this particular SNMP view. This is a user-defined value.</td>
</tr>
</tbody>
</table></li>

<li><p>Restart <code>snmpd</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ sudo systemctl restart snmpd.service</code></pre></div></li>
</ol>

<h2 id="enable-snmp-support-for-frrouting">Enable SNMP Support for FRRouting</h2>

<p>SNMP supports Routing MIBs in <a href="FRRouting_Overview">FRRouting</a>. To enable
SNMP support for FRRouting, you need to:</p>

<ul>
<li>Configure <a href="http://www.net-snmp.org/docs/README.agentx.html">AgentX</a>
(ASX) access in FRRouting</li>
<li>The default <code>/etc/snmp/snmpd.conf</code> configuration already enables
agentx and sets the correct permissions</li>
</ul>

<p>Enabling FRRouting includes support for BGP. However, if you plan on
using the BGP4 MIB, be sure to provide access to the MIB tree
1.3.6.1.2.1.15.</p>

<p>At this time, SNMP does not support monitoring BGP unnumbered neighbors.</p>

<p>If you plan on using the OSPFv2 MIB, provide access to 1.3.6.1.2.1.14
and to 1.3.6.1.2.1.191 for the OSPv3 MIB.</p>

<p>To enable SNMP support for FRRouting:</p>

<ol>
<li><p>Configure AgentX access in FRRouting:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ net add routing agentx
cumulus@switch:~$ net pending
cumulus@switch:~$ net commit</code></pre></div></li>

<li><p>Update the SNMP configuration to enable FRRouting to respond to SNMP
requests. Open the <code>/etc/snmp/snmpd.conf</code> file in a text editor and
verify that the following configuration exists:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">agentxsocket /var/agentx/master 
agentxperms 777 777 snmp snmp
master agentx</code></pre></div>
<p>Make sure that the <code>/var/agentx</code> directory is world-readable and
world-searchable (octal mode 755).</p></li>

<li><p>Optionally, you might need to expose various MIBs:</p>

<ul>
<li>For the BGP4 MIB, allow access to <code>1.3.6.1.2.1.15</code></li>
<li>For the OSPF MIB,  allow access to <code>1.3.6.1.2.1.14</code> </li>
<li>For the OSPFV3 MIB, allow access to <code>1.3.6.1.2.1.191</code> </li>
</ul></li>
</ol>

<p>To verify the configuration, run <code>snmpwalk</code>. For example, if you have a
running OSPF configuration with routes, you can check this OSPF-MIB
first from the switch itself with:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ sudo snmpwalk -v2c -cpublic localhost 1.3.6.1.2.1.14</code></pre></div>
<h3 id="enable-the-1-3-6-1-2-1-range">Enable the .1.3.6.1.2.1 Range</h3>

<p>Some MIBs, including storage information, are not included by default in
<code>snmpd.conf</code> in Cumulus Linux. This results in some default views on
common network tools (like <code>librenms</code>) to return less than optimal data.
You can include more MIBs by enabling all the .1.3.6.1.2.1 range. This
simplifies the configuration file, removing concern that any required
MIBs will be missed by the monitoring system. Various MIBs were added to
version 3.0 and include the following: ENTITY and ENTITY-SENSOR MIB and
parts of the BRIDGE-MIB and Q-BRIDGE-MIBs. These are included in the
default configuration.</p>

<p>This configuration grants access to a large number of MIBs, including
all SNMPv2-MIB, which might reveal more data than expected. In addition
to being a security vulnerability, it might consume more CPU resources.</p>

<p>To enable the .1.3.6.1.2.1 range, make sure the view name commands
include the required MIB objects.</p>

<h3 id="configure-snmpv3">Configure SNMPv3</h3>

<p>SNMPv3 is often used to enable authentication and encryption, as
community strings in versions 1 and 2c are sent in plaintext. SNMPv3
usernames are added to the <code>/etc/snmp/snmpd.conf</code> file, along with
plaintext authentication and encryption pass phrases.</p>

<p>The NCLU command structures for configuring SNMP user passwords are:</p>
<div class="highlight"><pre class="chroma"><code class="language-plain" data-lang="plain">cumulus@switch:~$ net add snmp-server username &lt;username&gt; [auth-none] | [(auth-md5 | auth-sha) &lt;auth-password&gt;]
cumulus@switch:~$ net add snmp-server username &lt;username&gt; auth-(none | sha | md5)  (oid &lt;OID&gt; | view &lt;view&gt;)</code></pre></div>
<p>The example below definines five users, each with a different
combination of authentication and encryption:</p>
<div class="highlight"><pre class="chroma"><code class="language-plain" data-lang="plain">cumulus@switch:~$ net add snmp-server username user1 auth-none
cumulus@switch:~$ net add snmp-server username user2 auth-md5 user2password
cumulus@switch:~$ net add snmp-server username user3 auth-md5 user3password encrypt-des user3encryption
cumulus@switch:~$ net add snmp-server username user666 auth-sha user666password encrypt-aes user666encryption
cumulus@switch:~$ net add snmp-server username user999 auth-md5 user999password encrypt-des user999encryption
cumulus@switch:~$ net add snmp-server username user1 auth-none oid 1.3.6.1.2.1
cumulus@switch:~$ net add snmp-server username user1 auth-none oid system 
cumulus@switch:~$ net add snmp-server username user2 auth-md5 test1234 view testview  oid 1.3.6.1.2.1
cumulus@switch:~$ net add snmp-server username user3 auth-sha testshax encrypt-aes testaesx oid 1.3.6.1.2.1
cumulus@switch:~$ net pending
cumulus@switch:~$ net commit</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text"># simple no auth user
#createuser user1

# user with MD5 authentication
#createuser user2 MD5 user2password

# user with MD5 for auth and DES for encryption
#createuser user3 MD5 user3password DES user3encryption

# user666 with SHA for authentication and AES for encryption
createuser user666 SHA user666password AES user666encryption

# user999 with MD5 for authentication and DES for encryption
createuser user999 MD5 user999password DES user999encryption

# restrict users to certain OIDs
# (Note: creating rouser or rwuser will give
# access regardless of the createUser command above. However,
# createUser without rouser or rwuser will not provide any access).
rouser user1 noauth 1.3.6.1.2.1
rouser user2 auth 1.3.6.1.2.1
rwuser user3 priv 1.3.6.1.2.1
rwuser user666
rwuser user999</code></pre></div>
<p>After configuring user passwords and restarting the <code>snmpd</code> daemon, you
can check user access with a client.</p>

<p>The <code>snmp</code> Debian package contains <code>snmpget</code>, <code>snmpwalk</code>, and other
programs that are useful for checking daemon functionality from the
switch itself or from another workstation.</p>

<p>The following commands check the access for each user defined above from
the localhost:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text"># check user1 which has no authentication or encryption (NoauthNoPriv)
snmpget -v 3 -u user1 -l NoauthNoPriv localhost 1.3.6.1.2.1.1.1.0
snmpwalk -v 3 -u user1 -l NoauthNoPriv localhost 1.3.6.1.2.1.1

# check user2 which has authentication but no encryption (authNoPriv)
snmpget -v 3 -u user2 -l authNoPriv -a MD5 -A user2password localhost 1.3.6.1.2.1.1.1.0
snmpget -v 3 -u user2 -l authNoPriv -a MD5 -A user2password localhost 1.3.6.1.2.1.2.1.0
snmpwalk -v 3 -u user2 -l authNoPriv -a MD5 -A user2password localhost 1.3.6.1.2.1
  
# check user3 which has both authentication and encryption (authPriv)
snmpget -v 3 -u user3 -l authPriv -a MD5 -A user3password -x DES -X user3encryption localhost .1.3.6.1.2.1.1.1.0
snmpwalk -v 3 -u user3 -l authPriv -a MD5 -A user3password -x DES -X user3encryption localhost .1.3.6.1.2.1
snmpwalk -v 3 -u user666 -l authPriv -a SHA -x AES -A user666password -X user666encryption localhost 1.3.6.1.2.1.1
snmpwalk -v 3 -u user999 -l authPriv -a MD5 -x DES -A user999password -X user999encryption localhost 1.3.6.1.2.1.1</code></pre></div>
<p>The following procedure shows a slightly more secure method of
configuring SNMPv3 users without creating cleartext passwords:</p>

<ol>
<li><p>Install the <code>net-snmp-config</code> script that is in <code>libsnmp-dev</code>
package:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ sudo -E apt-get update
cumulus@switch:~$ sudo -E apt-get install libsnmp-dev</code></pre></div></li>

<li><p>Stop the daemon:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ sudo systemctl stop snmpd.service</code></pre></div></li>

<li><p>Use the <code>net-snmp-config</code> command to create two users, one with MD5
and DES, and the next with SHA and AES. </p>

<p>The minimum password length is eight characters and the arguments
<code>-a</code> and <code>-x</code> have different meanings in <code>net-snmp-config</code> than
<code>snmpwalk</code>.</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ sudo net-snmp-config --create-snmpv3-user -a md5authpass -x desprivpass -A MD5 -X DES userMD5withDES 
cumulus@switch:~$ sudo net-snmp-config --create-snmpv3-user -a shaauthpass -x aesprivpass -A SHA -X AES userSHAwithAES
cumulus@switch:~$ sudo systemctl start snmpd.service</code></pre></div></li>
</ol>

<p>This adds a <code>createUser</code> command in <code>/var/lib/snmp/snmpd.conf</code>. Do
<strong>not</strong> edit this file by hand unless you are removing usernames. It
also adds the rwuser in <code>/usr/share/snmp/snmpd.conf</code>. You can edit this
file and restrict access to certain parts of the MIB by adding <em>noauth</em>,
<em>auth</em> or <em>priv</em> to allow unauthenticated access, require
authentication, or to enforce use of encryption.</p>

<p>The <code>snmpd</code> daemon reads the information from the
<code>/var/lib/snmp/snpmd.conf</code> file and then the line is removed
(eliminating the storage of the master password for that user) and
replaced with the key that is derived from it (using the EngineID). This
key is a localized key, so that if it is stolen it cannot be used to
access other agents. To remove the two users <code>userMD5withDES</code> and
<code>userSHAwithAES</code>, stop the <code>snmpd</code> daemon and edit
the <code>/var/lib/snmp/snmpd.conf</code> and <code>/usr/share/snmp/snmpd.conf</code> files.
Remove the lines containing the username, then restart the <code>snmpd</code>
daemon as in step 3 above.</p>

<p>From a client, you access the MIB with the correct credentials. (The
roles of <code>-x</code>, <code>-a</code> and <code>-X</code> and <code>-A</code> are reversed on the client side as
compared with the <code>net-snmp-config</code> command used above.)</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">snmpwalk -v 3 -u userMD5withDES -l authPriv -a MD5 -x DES -A md5authpass -X desprivpass localhost 1.3.6.1.2.1.1.1
snmpwalk -v 3 -u userSHAwithAES -l authPriv -a SHA -x AES -A shaauthpass -X aesprivpass localhost 1.3.6.1.2.1.1.1</code></pre></div>
<h2 id="manually-configure-snmp-traps-non-nclu">Manually Configure SNMP Traps (Non-NCLU)</h2>

<h3 id="generate-event-notification-traps">Generate Event Notification Traps</h3>

<p>The Net-SNMP agent provides a method to generate SNMP trap events using
the Distributed Management (DisMan) Event MIB for various system events,
including:</p>

<ul>
<li>Link up/down.</li>
<li>Exceeding the temperature sensor threshold, CPU load, or memory
threshold.</li>
<li>Other SNMP MIBs.</li>
</ul>

<p>To enable specific types of traps, you need to create the following
configurations in <code>/etc/snmp/snmpd.conf</code>.</p>

<h4 id="define-access-credentials">Define Access Credentials</h4>

<p>An SNMPv3 username is required to authorize the DisMan service even
though you are not configuring SNMPv3 here. The example <code>snmpd.conf</code>
configuration shown below creates *trapusername* as the username using
the <code>createUser</code> command. <code>iquerySecName</code> defines the default SNMPv3
username to be used when making internal queries to retrieve monitored
expressions. <code>rouser</code> specifies which username to use for these SNMPv3
queries.  All three are required for <code>snmpd</code> to retrieve information and
send traps (even with the <code>monitor</code> command shown below in the
examples). Add the following lines to your <code>/etc/snmp/snmpd.conf</code>
configuration file: </p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">createuser trapusername
iquerysecname trapusername
rouser trapusername</code></pre></div>
<p><code>iquerysecname</code> specifies the default SNMPv3 username to be used when
making internal queries to retrieve any necessary information — either
for evaluating the monitored expression or building a notification
payload. These internal queries always use SNMPv3, even if normal
querying of the agent is done using SNMPv1 or SNMPv2c. Note that this
user must also be explicitly created via <code>createUser</code> and given
appropriate access rights, for <code>rouser</code>, for example. The
<code>iquerysecname</code> directive is purely concerned with defining which user
should be used, not with actually setting this user up.</p>

<h4 id="define-trap-receivers"><strong>Define Trap Receivers</strong></h4>

<p>The following configuration defines the trap receiver IP address where
SNMPv2 traps are sent:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">trap2sink 192.168.1.1 public
# For SNMPv1 Traps, use
# trapsink  192.168.1.1  public </code></pre></div>
<p>Although the traps are sent to an SNMPV2 receiver, the SNMPv3 user is
still required. Starting with Net-SNMP 5.3, <code>snmptrapd</code> no longer
accepts all traps by default. <code>snmptrapd</code> must be configured with
authorized SNMPv1/v2c community strings and/or SNMPv3 users.
Non-authorized traps/informs are dropped. Refer to
the <a href="http://www.net-snmp.org/docs/man/snmptrapd.conf.html">snmptrapd.conf(5) manual
page</a> for details.</p>

<p>It is possible to define multiple trap receivers and to use the domain
name instead of an IP address in the <code>trap2sink</code> directive.</p>

<p>Restart the <code>snmpd</code> service to apply the changes.</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ sudo systemctl restart snmpd.service</code></pre></div>
<h4 id="snmp-version-3-trap-and-inform-messages">SNMP Version 3 Trap and Inform Messages</h4>

<p>You can configure SNMPv3 trap and inform messages with
the <code>trapsess </code>configuration command. Inform messages are traps that are
acknowledged by the receiving trap daemon. You configure inform messages
with the<code> -Ci </code>parameter. You must specify the EngineID of the receiving
trap server with the <code>-e</code> field.</p>

<p><strong>SNMPv3 TRAP/INFORM</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">trapsess -Ci -e 0x80ccff112233445566778899 -v3 -l authPriv  -u trapuser1 -a MD5 -A trapuser1password -x DES -X trapuser1encryption 192.168.1.1</code></pre></div>
<p>The SNMP trap receiving daemon must have usernames, authentication
passwords, and encryption passwords created with its own EngineID. You
must configure this trap server EngineID in the switch <code>snmpd</code> daemon
sending the trap and inform messages. You specify the level of
authentication and encryption for SNMPv3 trap and inform messages
with <code>-l</code> (<code>NoauthNoPriv, authNoPriv,</code> or <code>authPriv</code>).</p>

<p>You can define multiple trap receivers and use the domain name instead
of an IP address in the <code>trap2sink</code> directive.</p>

<p>After you complete the configuration, restart the <code>snmpd</code> service to
apply the changes:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ sudo systemctl restart snmpd.service</code></pre></div>
<h4 id="source-traps-from-a-different-source-ip-address">Source Traps from a Different Source IP Address</h4>

<p>When client SNMP programs (such as <code>snmpget</code>, <code>snmpwalk</code>, or
<code>snmptrap</code>) are run from the command line, or when <code>snmpd</code> is configured
to send a trap (based on <code>snmpd.conf</code>), you can configure a <em>clientaddr</em>
in <code>snmp.conf</code> that allows the SNMP client programs or <code>snmpd</code> (for
traps) to source requests from a different source IP address.</p>

<p><code>snmptrap</code>, <code>snmpget</code>, <code>snmpwalk</code> and <code>snmpd</code> itself must be able to
bind to this address.</p>

<p>For more information, read the the <code>snmp.conf</code> man page:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">clientaddr [&lt;transport-specifier&gt;:]&lt;transport-address&gt;
              specifies the source address to be used by command-line applica‐
              tions when sending SNMP requests. See snmpcmd(1) for more infor‐
              mation about the format of addresses.
              This value is also used by snmpd when generating notifications.</code></pre></div>
<h4 id="monitor-fans-power-supplies-and-transformers">Monitor Fans, Power Supplies, and Transformers</h4>

<p>An SNMP agent (<code>snmpd</code>) waits for incoming SNMP requests and responds to
them. If no requests are received, an agent does not initiate any
actions. However, various commands can configure <code>snmpd</code> to send traps
based on preconfigured settings (<code>load</code>, <code>file</code>, <code>proc</code>, <code>disk</code>, or
<code>swap</code> commands), or customized <code>monitor</code> commands.</p>

<p>From the <code>snmpd.conf</code> man page, the <code>monitor</code> command is defined this
way:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">monitor [OPTIONS] NAME EXPRESSION

              defines  a  MIB  object to monitor.  If the EXPRESSION condition holds then 
              this will trigger the corresponding event, and either send a notification or
              apply a SET assignment (or both).  Note that the event will only be triggered once,
              when the expression first matches.  This monitor entry will not fire again until the
              monitored condition first becomes false, and then matches again.  NAME is an administrative
              name for this expression, and is used for indexing the mteTriggerTable (and related tables).
              Note also that such monitors use an internal SNMPv3 request to retrieve the values
              being monitored (even  if  normal  agent  queries  typically  use SNMPv1 or SNMPv2c).
              See the iquerySecName token described above.

       EXPRESSION
              There are three types of monitor expression supported by the Event MIB - existence, boolean and threshold tests.

              OID | ! OID | != OID

                     defines  an  existence(0)  monitor  test.  A bare OID specifies a present(0) test,
                     which will fire when (an instance of) the monitored OID is created.  An expression
                     of the form ! OID specifies an absent(1) test, which will fire when the monitored
                     OID is delected.  An expression of the form != OID specifies a changed(2) test,
                     which will fire whenever the monitored value(s) change.  Note that there must be
                     whitespace before the OID token.

              OID OP VALUE

                     defines a boolean(1) monitor test.  OP should be one of the defined comparison operators
                     (!=, ==, &lt;, &lt;=, &gt;, &gt;=) and VALUE should be an integer value to compare against.  Note that
                     there must be whitespace around the OP token.  A comparison such as OID !=0 will not be
                     handled correctly.

              OID MIN MAX [DMIN DMAX]

                     defines a threshold(2) monitor test.  MIN and MAX are integer values, specifying
                     lower and upper thresholds.  If the value of the monitored OID falls below the lower
                     threshold (MIN) or rises above the upper threshold (MAX), then the monitor entry will
                     trigger the corresponding event.

                     Note that the rising threshold event will only be re-armed when the monitored value
                     falls below the lower threshold (MIN).  Similarly, the falling threshold event will
                     be re-armed by the upper threshold (MAX).

                     The optional parameters DMIN and DMAX configure a pair of similar threshold tests,
                     but working with the delta differences between successive sample values.

       OPTIONS

              There are various options to control the behaviour of the monitored expression.  These include:
              -D     indicates that the expression should be evaluated using delta differences between sample
                     values (rather than the values themselves).
              -d OID  or  -di OID
                     specifies a discontinuity marker for validating delta differences.  A -di object instance
                     will be used exactly as given.  A -d object will have the instance subidentifiers from
                     the corresponding (wildcarded) expression object appended.  If the -I flag is specified,
                     then there is no difference between these two options. This option also implies -D.
              -e EVENT
                     specifies the event to be invoked when this monitor entry is triggered.  If this option
                     is not given, the monitor entry will generate one of the standard notifications defined
                     in the DISMAN-EVENT-MIB.
              -I     indicates that the monitored expression should be applied to the specified OID as a
                     single instance.  By default, the OID will be treated as a wildcarded object, and the
                     monitor expanded to cover all matching instances.
              -i OID or -o OID
                     define additional varbinds to be added to the notification payload when this monitor
                     trigger fires.  For a wildcarded expression, the suffix of the matched instance will be
                     added to any OIDs specified using -o, while OIDs specified using -i will be treated
                     as exact instances.  If the -I flag is specified,  then  there  is  no difference between
                     these two options.
                     See strictDisman for details of the ordering of notification payloads.
              -r FREQUENCY
                     monitors the given expression every FREQUENCY, where FREQUENCY is in seconds or optionally
                     suffixed by one of s (for seconds), m (for minutes), h (for hours), d (for days),
                     or w (for weeks).  By default, the expression will be evaluated every 600s (10 minutes).
              -S     indicates that the monitor expression should not be evaluated when the agent first starts up.
                     The first evaluation will be done once the first repeat interval has expired.
              -s     indicates that the monitor expression should be evaluated when the agent first starts up.
                     This is the default behaviour.
                     Note:  Notifications triggered by this initial evaluation will be sent before the coldStart trap.
              -u SECNAME
                     specifies a security name to use for scanning the local host, instead of the default
                     iquerySecName.  Once again, this user must be explicitly created and given suitable access rights.</code></pre></div>
<p>You can configure<code>snmpd </code>to monitor the operational status of an Entity
MIB or Entity-Sensor MIB. You can determine the operational status,
given as a value of <em>ok(1)</em>, *unavailable(2)* or <em>nonoperational(3)</em>, by
adding the following example configuration to <code>/etc/snmp/snmpd.conf</code> and
adjusting the values:</p>

<ul>
<li><p>Using the <code>entPhySensorOperStatus</code> integer:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text"># without installing extra MIBS we can check the check Fan1 status
# if the Fan1 index is 100011001, monitor this specific OID (-I) every 10 seconds (-r), and defines additional information to be included in the trap (-o).
monitor -I -r 10  -o 1.3.6.1.2.1.47.1.1.1.1.7.100011001 &#34;Fan1 Not OK&#34;  1.3.6.1.2.1.99.1.1.1.5.100011001 &gt; 1
# Any Entity Status non OK (greater than 1)
monitor  -r 10  -o 1.3.6.1.2.1.47.1.1.1.1.7  &#34;Sensor Status Failure&#34;  1.3.6.1.2.1.99.1.1.1.5 &gt; 1</code></pre></div></li>

<li><p>Using the OID name:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text"># for a specific fan called Fan1 with an index 100011001
monitor -I -r 10  -o entPhysicalName.100011001 &#34;Fan1 Not OK&#34;  entPhySensorOperStatus.100011001 &gt; 1
# for any Entity Status not OK ( greater than 1)
monitor  -r 10  -o entPhysicalName  &#34;Sensor Status Failure&#34;  entPhySensorOperStatus &gt; 1</code></pre></div>
<p>You can use the OID name if the <code>snmp-mibs-downloader</code> package is
installed.</p>

<p>The <code>entPhySensorOperStatus</code> integer can be found by walking the
<code>entPhysicalName</code> table.</p></li>

<li><p>To get all sensor information, run <code>snmpwalk</code> on the
<code>entPhysicalName</code> table. For example:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@leaf01:~$ snmpwalk -v 2c -cpublic localhost .1.3.6.1.2.1.47.1.1.1.1.7
iso.3.6.1.2.1.47.1.1.1.1.7.100000001 = STRING: &#34;PSU1Temp1&#34;
iso.3.6.1.2.1.47.1.1.1.1.7.100000002 = STRING: &#34;PSU2Temp1&#34;
iso.3.6.1.2.1.47.1.1.1.1.7.100000003 = STRING: &#34;Temp1&#34;
iso.3.6.1.2.1.47.1.1.1.1.7.100000004 = STRING: &#34;Temp2&#34;
iso.3.6.1.2.1.47.1.1.1.1.7.100000005 = STRING: &#34;Temp3&#34;
iso.3.6.1.2.1.47.1.1.1.1.7.100000006 = STRING: &#34;Temp4&#34;
iso.3.6.1.2.1.47.1.1.1.1.7.100000007 = STRING: &#34;Temp5&#34;
iso.3.6.1.2.1.47.1.1.1.1.7.100011001 = STRING: &#34;Fan1&#34;
iso.3.6.1.2.1.47.1.1.1.1.7.100011002 = STRING: &#34;Fan2&#34;
iso.3.6.1.2.1.47.1.1.1.1.7.100011003 = STRING: &#34;Fan3&#34;
iso.3.6.1.2.1.47.1.1.1.1.7.100011004 = STRING: &#34;Fan4&#34;
iso.3.6.1.2.1.47.1.1.1.1.7.100011005 = STRING: &#34;Fan5&#34;
iso.3.6.1.2.1.47.1.1.1.1.7.100011006 = STRING: &#34;Fan6&#34;
iso.3.6.1.2.1.47.1.1.1.1.7.100011007 = STRING: &#34;PSU1Fan1&#34;
iso.3.6.1.2.1.47.1.1.1.1.7.100011008 = STRING: &#34;PSU2Fan1&#34;
iso.3.6.1.2.1.47.1.1.1.1.7.110000001 = STRING: &#34;PSU1&#34;
iso.3.6.1.2.1.47.1.1.1.1.7.110000002 = STRING: &#34;PSU2&#34;</code></pre></div></li>
</ul>

<h4 id="enable-mib-to-oid-translation">Enable MIB to OID Translation</h4>

<p>MIB names can be used instead of OIDs, by installing the
<code>snmp-mibs-downloader</code>, to download SNMP MIBs to the switch prior to
enabling traps. This greatly improves the readability of the
<code>snmpd.conf</code> file.</p>

<ol>
<li><p>Open <code>/etc/apt/sources.list</code> in a text editor.</p></li>

<li><p>Add the <code>non-free</code> repository, then save the file:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ sudo deb http://ftp.us.debian.org/debian/ jessie main non-free</code></pre></div></li>

<li><p>Update the switch:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ sudo -E apt-get update</code></pre></div></li>

<li><p>Install the <code>snmp-mibs-downloader</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ sudo -E apt-get install snmp-mibs-downloader</code></pre></div></li>

<li><p>Open the <code>/etc/snmp/snmp.conf</code> file to verify that the <code>mibs :</code> line
is commented out:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">#
# As the snmp packages come without MIB files due to license reasons, loading
# of MIBs is disabled by default. If you added the MIBs you can reenable
# loading them by commenting out the following line.
#mibs :</code></pre></div></li>

<li><p>Open the <code>/etc/default/snmpd</code> file to verify that the <code>export MIBS=</code>
line is commented out:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text"># This file controls the activity of snmpd and snmptrapd

# Don&#39;t load any MIBs by default.
# You might comment this lines once you have the MIBs Downloaded.
#export MIBS=</code></pre></div></li>

<li><p>After you confirm the configuration, remove or comment out the
<code>non-free</code> repository in <code>/etc/apt/sources.list</code>.</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">#deb http://ftp.us.debian.org/debian/ jessie main non-free</code></pre></div></li>
</ol>

<h4 id="configure-link-up-down-notifications">Configure Link Up/Down Notifications</h4>

<p>The <code>linkUpDownNotifications</code> directive is used to configure link
up/down notifications when the operational status of the link changes.</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">linkUpDownNotifications yes</code></pre></div>
<p>The default frequency for checking link up/down is 60 seconds. You can
change the default frequency using the <code>monitor</code> directive directly
instead of the <code>linkUpDownNotifications</code> directive. See <code>man snmpd.conf</code>
for details.</p>

<h4 id="configure-temperature-notifications"><strong>Configure Temperature Notifications</strong></h4>

<p>Temperature sensor information for each available sensor is maintained
in the the lmSensors MIB. Each platform can contain a different number
of temperature sensors. The example below generates a trap event when
any temperature sensor exceeds a threshold of 68 degrees (centigrade).
It monitors each <code>lmTempSensorsValue</code>. When the threshold value is
checked and exceeds the <code>lmTempSensorsValue</code>, a trap is generated. The
<code>-o lmTempSenesorsDevice</code> option is used to instruct SNMP to also
include the lmTempSensorsDevice MIB in the generated trap. The default
frequency for the <code>monitor</code> directive is 600 seconds. You can change the
default frequency with the <code>-r</code> option.:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">monitor lmTemSensor -o lmTempSensorsDevice lmTempSensorsValue &gt; 68000</code></pre></div>
<p>To monitor the sensors individually, first use the <code>sensors</code> command to
determine which sensors are available to be monitored on the platform.</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ sudo sensors
  
CY8C3245-i2c-4-2e
Adapter: i2c-0-mux (chan_id 2)
fan5: 7006 RPM (min = 2500 RPM, max = 23000 RPM)
fan6: 6955 RPM (min = 2500 RPM, max = 23000 RPM)
fan7: 6799 RPM (min = 2500 RPM, max = 23000 RPM)
fan8: 6750 RPM (min = 2500 RPM, max = 23000 RPM)
temp1: +34.0 C (high = +68.0 C)
temp2: +28.0 C (high = +68.0 C)
temp3: +33.0 C (high = +68.0 C)
temp4: +31.0 C (high = +68.0 C)
temp5: +23.0 C (high = +68.0 C)</code></pre></div>
<p>Configure a <code>monitor</code> command for the specific sensor using the <code>-I</code>
option. The <code>-I</code> option indicates that the monitored expression is
applied to a single instance. In this example, there are five
temperature sensors available. Use the following directive to monitor
only temperature sensor 3 at 5 minute intervals.</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">monitor -I -r 300 lmTemSensor3 -o lmTempSensorsDevice.3 lmTempSensorsValue.3 &gt; 68000</code></pre></div>
<h4 id="configure-free-memory-notifications">Configure Free Memory Notifications</h4>

<p>You can monitor free memory using the following directives. The example
below generates a trap when free memory drops below 1,000,000KB. The
free memory trap also includes the amount of total real memory:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">monitor MemFreeTotal -o memTotalReal memTotalFree &lt;  1000000</code></pre></div>
<h4 id="configure-processor-load-notifications">Configure Processor Load Notifications</h4>

<p>To monitor CPU load for 1, 5, or 15 minute intervals, use the <code>load</code>
directive with the <code>monitor</code> directive. The following example generates
a trap when the 1 minute interval reaches 12%, the 5 minute interval
reaches 10%, or the 15 minute interval reaches 5%.</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">load 12 10 5</code></pre></div>
<h4 id="configure-disk-utilization-notifications">Configure Disk Utilization Notifications</h4>

<p>To monitor disk utilization for all disks, use the <code>includeAllDisks</code>
directive together with the <code>monitor</code> directive. The example code below
generates a trap when a disk is 99% full:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">includeAllDisks 1%
monitor -r 60 -o dskPath -o DiskErrMsg &#34;dskTable&#34; diskErrorFlag !=0</code></pre></div>
<h4 id="configure-authentication-notifications">Configure Authentication Notifications</h4>

<p>To generate authentication failure traps, use the <code>authtrapenable</code>
directive:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">authtrapenable 1</code></pre></div>
<h3 id="snmptrapd-conf">snmptrapd.conf</h3>

<p>Use the Net-SNMP trap daemon to <strong>receive</strong> SNMP traps.
The <code>/etc/snmp/snmptrapd.conf</code> file is used to configure how
<strong>incoming</strong> traps are processed. Starting with Net-SNMP release 5.3,
you must specify who is authorized to send traps and informs to the
notification receiver (and what types of processing these are allowed to
trigger). You can specify three processing types:</p>

<ul>
<li>*log* logs the details of the notification in a specified file to
standard output (or stderr), or through syslog (or similar).</li>
<li>*execute* passes the details of the trap to a specified handler
program, including embedded Perl.</li>
<li>*net* forwards the trap to another notification receiver.</li>
</ul>

<p>Typically, this configuration is *log,execute,net* to cover any style of
processing for a particular category of notification. But it is possible
(even desirable) to limit certain notification sources to selected
processing only.</p>

<p><code>authCommunity TYPES COMMUNITY [SOURCE [OID | -v VIEW ]]</code> authorizes
traps and SNMPv2c INFORM requests with the specified community to
trigger the types of processing listed. By default, this allows any
notification using this community to be processed. You can use the
SOURCE field to specify that the configuration only applies to
notifications received from particular sources. For more information
about specific configuration options within the file, look at the
<code>snmpd.conf(5)</code> man page with the following command:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ man 5 snmptrapd.conf</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">###############################################################################
#
# EXAMPLE-trap.conf:
#   An example configuration file for configuring the Net-SNMP snmptrapd agent.
#
###############################################################################
#
# This file is intended to only be an example.  If, however, you want
# to use it, it should be placed in /etc/snmp/snmptrapd.conf.
# When the snmptrapd agent starts up, this is where it will look for it.
#
# All lines beginning with a &#39;#&#39; are comments and are intended for you
# to read.  All other lines are configuration commands for the agent.

#
# PLEASE: read the snmptrapd.conf(5) manual page as well!
#
# this is the default (port 162) and defines the listening
# protocol and address  (e.g.  udp:10.10.10.10)
snmpTrapdAddr localhost
# 
# defines the actions and the community string 
authCommunity log,execute,net public</code></pre></div>
<h2 id="supported-mibs">Supported MIBs</h2>

<p>Below are the MIBs supported by Cumulus Linux, as well as suggested uses
for them. The overall Cumulus Linux MIB is defined in
the <code>/usr/share/snmp/mibs/Cumulus-Snmp-MIB.txt</code> file.</p>

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>MIB Name</th>
<th>Suggested Uses</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><a href="https://cumulusnetworks.com/static/mibs/BGP4-MIB.txt">BGP4-MIB</a>,</p>
<p><a href="https://cumulusnetworks.com/static/mibs/OSPFv2-MIB.txt">OSPFv2-MIB</a>,</p>
<p><a href="https://cumulusnetworks.com/static/mibs/OSPFv3-MIB.txt">OSPFv3-MIB</a>,</p>
<p><a href="https://cumulusnetworks.com/static/mibs/RIPv2-MIB.txt">RIPv2-MIB</a></p></td>
<td><p>You can enable FRRouting SNMP support to provide support for OSPF-MIB (RFC-1850), OSPFV3-MIB (RFC-5643), and BGP4-MIB (RFC-1657). See the <a href="#SimpleNetworkManagementProtocol(SNMP)Monitoring-frr">FRRouting section</a> above.</p></td>
</tr>
<tr class="even">
<td><a href="https://cumulusnetworks.com/static/mibs/CUMULUS-COUNTERS-MIB.txt">CUMULUS-COUNTERS-MIB</a></td>
<td><p>Discard counters: Cumulus Linux also includes its own counters MIB, defined in <code>/usr/share/snmp/mibs/Cumulus-Counters-MIB.txt</code>. It has the OID <code>.1.3.6.1.4.1.40310.2</code></p></td>
</tr>
<tr class="odd">
<td>CUMULUS-POE-MIB</td>
<td><p>The Cumulus Networks custom <a href="Power_over_Ethernet_-_PoE">Power over Ethernet</a> PoE MIB defined in the <code>/usr/share/snmp/mibs/Cumulus-POE-MIB.txt</code> file. For devices that provide PoE, this provides users with the system wide power information in <code>poeSystemValues</code> as well as per interface <code>PoeObjectsEntry</code> values for the <code>poeObjectsTable</code>. Most of this information comes from the <code>poectl</code> command. To enable this MIB, uncomment the following line in <code>/etc/snmp/snmpd.conf</code>:</p>
<div class="code panel pdl" style="border-width: 1px;">
<div class="codeContent panelContent pdl">
<pre class="text" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence" style="brush: text; gutter: false; theme: Confluence"><code>#pass_persist .1.3.6.1.4.1.40310.3 /usr/share/snmp/cl_poe_pp.py</code></pre>
</div>
</div></td>
</tr>
<tr class="even">
<td><a href="https://cumulusnetworks.com/static/mibs/CUMULUS-RESOURCE-QUERY-MIB.txt">CUMULUS-RESOURCE-QUERY-MIB</a></td>
<td><p>Cumulus Linux includes its own resource utilization MIB, which is similar to using<code> cl-resource-query</code>. This MIB monitors layer 3 entries by host, route, nexthops, ECMP groups, and layer 2 MAC/BDPU entries.The MIB is defined in <code>/usr/share/snmp/mibs/Cumulus-Resource-Query-MIB.txt</code> and has the OID <code>.1.3.6.1.4.1.40310.1.</code></p></td>
</tr>
<tr class="odd">
<td><p><a href="https://cumulusnetworks.com/static/mibs/CUMULUS-SNMP-MIB.txt">CUMULUS-SNMP-MIB</a></p></td>
<td>SNMP counters. For information on exposing CPU and memory information with SNMP, see this <a href="https://support.cumulusnetworks.com/hc/en-us/articles/203922988">knowledge base article</a>.</td>
</tr>
<tr class="even">
<td><a href="https://cumulusnetworks.com/static/mibs/DISMAN-EVENT-MIB.txt">DISMAN-EVENT-MIB</a></td>
<td>Trap monitoring</td>
</tr>
<tr class="odd">
<td><a href="https://cumulusnetworks.com/static/mibs/ENTITY-MIB.txt">ENTITY-MIB</a></td>
<td>From RFC 4133, the temperature sensors, fan sensors, power sensors, and ports are covered.</td>
</tr>
<tr class="even">
<td><a href="https://cumulusnetworks.com/static/mibs/ENTITY-SENSOR-MIB.txt">ENTITY-SENSOR-MIB</a></td>
<td>Physical sensor information (temperature, fan, and power supply) from RFC 3433.</td>
</tr>
<tr class="odd">
<td><a href="https://cumulusnetworks.com/static/mibs/HOST-RESOURCES-MIB.txt">HOST-RESOURCES-MIB</a></td>
<td><p>Users, storage, interfaces, process info, run parameters</p></td>
</tr>
<tr class="even">
<td><p><a href="https://cumulusnetworks.com/static/mibs/IEEE8021-BRIDGE-MIB.txt">IEEE8021-BRIDGE-MIB</a></p>
<p><a href="https://cumulusnetworks.com/static/mibs/IEEE8021-Q-BRIDGE-MIB.txt">IEEE8021-Q-BRIDGE-MIB</a></p></td>
<td>The <code>dot1dBasePortEntry</code> and <code>dot1dBasePortIfIndex</code> tables in the BRIDGE-MIB and <code>dot1qBase</code>, <code>dot1qFdbEntry</code>, <code>dot1qTpFdbEntry</code>, <code>dot1qTpFdbStatus</code>, and <code>dot1qVlanStaticName</code> tables in the Q-BRIDGE-MIB tables. You must uncomment the <code>bridge_pp.py pass_persist</code> script in <code>/etc/snmp/snmpd.conf</code>.</td>
</tr>
<tr class="odd">
<td><a href="https://cumulusnetworks.com/static/mibs/IEEE8023-LAG-MIB.txt">IEEE8023-LAG-MIB</a></td>
<td><p>Implementation of the IEEE 8023-LAG-MIB includes the <code>dot3adAggTable</code> and <code>dot3adAggPortListTable</code> tables. To enable this, edit <code>/etc/snmp/snmpd.conf</code> and uncomment or add the following lines:</p>
<div class="code panel pdl" style="border-width: 1px;">
<div class="codeContent panelContent pdl">
<pre class="text" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence" style="brush: text; gutter: false; theme: Confluence"><code>view systemonly included .1.2.840.10006.300.43
pass_persist .1.2.840.10006.300.43 /usr/share/snmp/ieee8023_lag_pp.py</code></pre>
</div>
</div></td>
</tr>
<tr class="even">
<td><p><a href="https://cumulusnetworks.com/static/mibs/IF-MIB.txt">IF-MIB</a></p></td>
<td><p>Interface description, type, MTU, speed, MAC, admin, operation status, counters</p>
<div>
<div>
<p>The IF-MIB cache is disabled by default. To enable the counter to reflect traffic statistics, remove the <code>-y</code> option from the <code>SNMPDOPTS</code> line in the <code>/etc/default/snmpd</code> file. The example below first shows the original line, commented out, then the modified line without the <code>-y</code> option:</p>
<div class="code panel pdl" style="border-width: 1px;">
<div class="codeContent panelContent pdl">
<pre class="text" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence" style="brush: text; gutter: false; theme: Confluence"><code>cumulus@switch:~$ cat /etc/default/snmpd
# SNMPDOPTS=&#39;-y -LS 0-4 d -Lf /dev/null -u snmp -g snmp -I -smux -p /run/snmpd.pid&#39;
SNMPDOPTS=&#39;-LS 0-4 d -Lf /dev/null -u snmp -g snmp -I -smux -p /run/snmpd.pid&#39;</code></pre>
</div>
</div>
</div>
</div></td>
</tr>
<tr class="odd">
<td><a href="https://cumulusnetworks.com/static/mibs/IP-FORWARD-MIB.txt">IP-FORWARD-MIB</a>  </td>
<td>IP routing table</td>
</tr>
<tr class="even">
<td><p><a href="https://cumulusnetworks.com/static/mibs/IP-MIB.txt">IP-MIB (includes ICMP)</a></p></td>
<td>IPv4, IPv4 addresses, counters, netmasks</td>
</tr>
<tr class="odd">
<td><a href="https://cumulusnetworks.com/static/mibs/IPV6-MIB.txt">IPv6-MIB</a></td>
<td>IPv6 counters</td>
</tr>
<tr class="even">
<td><a href="https://cumulusnetworks.com/static/mibs/LLDP-MIB.txt">LLDP-MIB</a></td>
<td>Layer 2 neighbor information from <code>lldpd</code> (you need to <a href="Link-Layer-Discovery-Protocol_8362650.html#LinkLayerDiscoveryProtocol-snmp">enable the SNMP subagent</a> in LLDP). You need to start <code>lldpd</code> with the <code>-x</code> option to enable connectivity to <code>snmpd</code> (AgentX).</td>
</tr>
<tr class="odd">
<td><p><a href="https://cumulusnetworks.com/static/mibs/LM-SENSORS-MIB.txt">LM-SENSORS MIB</a></p></td>
<td>Fan speed, temperature sensor values, voltages. This is deprecated since the ENTITY-SENSOR MIB has been added.</td>
</tr>
<tr class="even">
<td><a href="https://cumulusnetworks.com/static/mibs/NET-SNMP-AGENT-MIB.txt">NET-SNMP-AGENT-MIB</a></td>
<td>Agent timers, user, group config</td>
</tr>
<tr class="odd">
<td><p><a href="https://cumulusnetworks.com/static/mibs/NET-SNMP-EXTEND-MIB.txt">NET-SNMP-EXTEND-MIB</a></p></td>
<td>See <a href="https://support.cumulusnetworks.com/hc/en-us/articles/204507848">this knowledge base article</a> on extending NET-SNMP in Cumulus Linux to include data from power supplies, fans, and temperature sensors.</td>
</tr>
<tr class="even">
<td><p><a href="https://cumulusnetworks.com/static/mibs/NET-SNMP-VACM-MIB.txt">NET-SNMP-VACM-MIB</a></p></td>
<td>Agent timers, user, group config</td>
</tr>
<tr class="odd">
<td><p><a href="https://cumulusnetworks.com/static/mibs/NOTIFICATION-LOG-MIB.txt">NOTIFICATION-LOG-MIB</a></p></td>
<td>Local logging</td>
</tr>
<tr class="even">
<td><p><a href="https://cumulusnetworks.com/static/mibs/SNMP-FRAMEWORK-MIB.txt">SNMP-FRAMEWORK-MIB</a></p></td>
<td>Users, access</td>
</tr>
<tr class="odd">
<td><p><a href="https://cumulusnetworks.com/static/mibs/SNMP-MPD.txt">SNMP-MPD-MIB</a></p></td>
<td>Users, access</td>
</tr>
<tr class="even">
<td><a href="https://cumulusnetworks.com/static/mibs/SNMP-TARGET.txt">SNMP-TARGET-MIB</a></td>
<td> </td>
</tr>
<tr class="odd">
<td><p><a href="https://cumulusnetworks.com/static/mibs/SNMP-USER-BASED-SM.txt">SNMP-USER-BASED-SM-MIB</a></p></td>
<td>Users, access</td>
</tr>
<tr class="even">
<td><p><a href="https://cumulusnetworks.com/static/mibs/SNMP-VIEW-BASED-ACM.txt">SNMP-VIEW-BASED-ACM-MIB</a></p></td>
<td>Users, access</td>
</tr>
<tr class="odd">
<td><p><a href="https://cumulusnetworks.com/static/mibs/TCP-MIB.txt">TCP-MIB</a></p></td>
<td>TCP-related information</td>
</tr>
<tr class="even">
<td><a href="https://cumulusnetworks.com/static/mibs/UCD-SNMP-MIB.txt">UCD-SNMP-MIB</a></td>
<td>System memory, load, CPU, disk IO</td>
</tr>
<tr class="odd">
<td><p><a href="https://cumulusnetworks.com/static/mibs/UDP-MIB.txt">UDP-MIB</a></p></td>
<td>UDP-related information</td>
</tr>
</tbody>
</table>

<p>The ENTITY MIB does not show the chassis information in Cumulus Linux.</p>

<h2 id="pass-persist-scripts">Pass Persist Scripts</h2>

<p>The pass persist scripts in Cumulus Linux use the <a href="http://net-snmp.sourceforge.net/wiki/index.php/Tut:Extending_snmpd_using_shell_scripts#Pass_persist">pass_persist
extension</a>
to Net-SNMP. The scripts are stored in <code>/usr/share/snmp</code> and include:</p>

<ul>
<li>bgp4_pp.py</li>
<li>bridge_pp.py</li>
<li>cl_drop_cntrs_pp.py</li>
<li>cl_poe_pp.py</li>
<li>entity_pp.py</li>
<li>entity_sensor_pp.py</li>
<li>ieee8023_lag_pp.py</li>
<li>resq_pp.py</li>
<li>snmpifAlias_pp.py</li>
<li>sysDescr_pass.py</li>
</ul>

<p>All the scripts are enabled by default in Cumulus Linux, except for:</p>

<ul>
<li><code>bgp4_pp.py</code>, which is now handled by
<a href="FRRouting_Overview">FRRouting</a> instead of Quagga, so monitoring has
changed accordingly.</li>
<li><code>cl_poe_pp.py</code>, which is disabled by default as only certain
platforms that Cumulus Linux supports are capable of doing <a href="Power_over_Ethernet_-_PoE">Power
over Ethernet</a>.</li>
</ul>

<h2 id="troubleshooting">Troubleshooting</h2>

<p>Use the following commands to troubleshoot potential SNMP issues:</p>
<div class="highlight"><pre class="chroma"><code class="language-plain" data-lang="plain">cumulus@switch:~$ net show snmp-server status                               
Simple Network Management Protocol (SNMP) Daemon.
---------------------------------  ------------------------------------------------------------------------------------
Current Status                     failed (failed)
Reload Status                      enabled
Listening IP Addresses             localhost 9.9.9.9
Main snmpd PID                     0
Version 1 and 2c Community String  Configured
Version 3 Usernames                Not Configured
Last Logs (with Errors)            -- Logs begin at Thu 2017-08-03 16:23:05 UTC, end at Fri 2017-08-04 18:17:24 UTC. --
                                   Aug 04 18:17:19 cel-redxp-01 snmpd[8389]: Error opening specified endpoint &#34;9.9.9.9&#34;
                                   Aug 04 18:17:19 cel-redxp-01 snmpd[8389]: Server Exiting with code 1
---------------------------------  ------------------------------------------------------------------------------------</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-plain" data-lang="plain">cumulus@switch:~$ net show configuration snmp-server                                                            
snmp-server                                         
  listening-address 127.0.0.1                
  readonly-community public access default
  readonly-community allpass access any
  readonly-community temp2 access 1.1.1.1
  readonly-community temp2 access 2.2.2.2
  trap-destination 1.1.1.1 community-password public version 2c
  trap-link-up check-frequency 10
  trap-snmp-auth-failures</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-plain" data-lang="plain">cumulus@switch:~$ net show configuration commands
...
net add snmp-server listening-address all
net add snmp-server readonly-community allpass access any
net add snmp-server readonly-community temp2 access 1.1.1.1
net add snmp-server readonly-community temp2 access 2.2.2.2
net add snmp-server trap-destination 1.1.1.1 community-password public version 2c
net add snmp-server trap-link-up check-frequency 10
net add snmp-server trap-snmp-auth-failures
...</code></pre></div>
<h2 id="attachments">Attachments:</h2>

<p><img src="images/icons/bullet_blue.gif" alt="" />{width=&ldquo;8&rdquo; height=&ldquo;8&rdquo;} <a href="attachments/8362608/8362616.png">Screen Shot
2016-01-05 at 11.21.05 AM.png</a>
(image/png)<br />
<img src="images/icons/bullet_blue.gif" alt="" />{width=&ldquo;8&rdquo; height=&ldquo;8&rdquo;} <a href="attachments/8362608/8362615.png">Screen Shot
2016-01-05 at 11.39.49 AM.png</a>
(image/png)<br />
<img src="images/icons/bullet_blue.gif" alt="" />{width=&ldquo;8&rdquo; height=&ldquo;8&rdquo;} <a href="attachments/8362608/8362614.png">Screen Shot
2016-01-05 at 11.39.31 AM.png</a>
(image/png)<br />
<img src="images/icons/bullet_blue.gif" alt="" />{width=&ldquo;8&rdquo; height=&ldquo;8&rdquo;} <a href="attachments/8362608/8362613.png">Screen Shot
2016-01-05 at 11.45.38 AM.png</a>
(image/png)<br />
<img src="images/icons/bullet_blue.gif" alt="" />{width=&ldquo;8&rdquo; height=&ldquo;8&rdquo;} <a href="attachments/8362608/8362612.png">Screen Shot
2016-01-05 at 11.58.00 AM (1).png</a>
(image/png)<br />
<img src="images/icons/bullet_blue.gif" alt="" />{width=&ldquo;8&rdquo; height=&ldquo;8&rdquo;} <a href="attachments/8362608/8362611.png">Screen Shot
2016-01-05 at 1.07.48 PM.png</a>
(image/png)<br />
<img src="images/icons/bullet_blue.gif" alt="" />{width=&ldquo;8&rdquo; height=&ldquo;8&rdquo;} <a href="attachments/8362608/8362610.png">Screen Shot
2016-01-06 at 10.36.29 AM.png</a>
(image/png)</p>
</article>

      
<div class="align-center book-git-footer justify-between">
  
  <div>
    <a href="https://github.com/cawleyflower/testDocs/commit/0f1fa77f244c4b4642688df1f5e961e88daa6e08" title='Last modified March 4, 2019 16:11 EST by Cawleyflower' target="_blank" rel="noopener">
      <img src="/svg/code-merge.svg" /> Last Modified Mar 4, 2019
    </a>
  </div>
  
  
</div>


    </div>

    
  
  
  <aside class="book-toc fixed">
    <nav id="TableOfContents">
<ul>
<li><a href="#simple-network-management-protocol-snmp-monitoring">Simple Network Management Protocol (SNMP) Monitoring</a>
<ul>
<li><a href="#contents">Contents</a></li>
<li><a href="#history">History</a></li>
<li><a href="#introduction-to-simple-network-management-protocol">Introduction to Simple Network Management Protocol</a>
<ul>
<li><a href="#snmp-managers">SNMP Managers</a></li>
<li><a href="#snmp-agents">SNMP Agents</a></li>
<li><a href="#management-information-base-mib">Management Information Base (MIB)</a></li>
</ul></li>
<li><a href="#getting-started">Getting Started</a></li>
<li><a href="#configure-snmp">Configure SNMP</a>
<ul>
<li><a href="#configure-snmp-with-nclu">Configure SNMP with NCLU</a></li>
</ul></li>
<li><a href="#configure-snmp-manually">Configure SNMP Manually</a>
<ul>
<li><a href="#start-the-snmp-daemon">Start the SNMP Daemon</a></li>
<li><a href="#configure-snmp-with-management-vrf-used-prior-to-cumulus-linux-3-6">Configure SNMP with Management VRF (used prior to Cumulus Linux 3.6)</a></li>
<li><a href="#set-up-the-custom-cumulus-networks-mibs">Set up the Custom Cumulus Networks MIBs</a></li>
<li><a href="#set-the-community-string">Set the Community String</a></li>
</ul></li>
<li><a href="#enable-snmp-support-for-frrouting">Enable SNMP Support for FRRouting</a>
<ul>
<li><a href="#enable-the-1-3-6-1-2-1-range">Enable the .1.3.6.1.2.1 Range</a></li>
<li><a href="#configure-snmpv3">Configure SNMPv3</a></li>
</ul></li>
<li><a href="#manually-configure-snmp-traps-non-nclu">Manually Configure SNMP Traps (Non-NCLU)</a>
<ul>
<li><a href="#generate-event-notification-traps">Generate Event Notification Traps</a>
<ul>
<li><a href="#define-access-credentials">Define Access Credentials</a></li>
<li><a href="#define-trap-receivers"><strong>Define Trap Receivers</strong></a></li>
<li><a href="#snmp-version-3-trap-and-inform-messages">SNMP Version 3 Trap and Inform Messages</a></li>
<li><a href="#source-traps-from-a-different-source-ip-address">Source Traps from a Different Source IP Address</a></li>
<li><a href="#monitor-fans-power-supplies-and-transformers">Monitor Fans, Power Supplies, and Transformers</a></li>
<li><a href="#enable-mib-to-oid-translation">Enable MIB to OID Translation</a></li>
<li><a href="#configure-link-up-down-notifications">Configure Link Up/Down Notifications</a></li>
<li><a href="#configure-temperature-notifications"><strong>Configure Temperature Notifications</strong></a></li>
<li><a href="#configure-free-memory-notifications">Configure Free Memory Notifications</a></li>
<li><a href="#configure-processor-load-notifications">Configure Processor Load Notifications</a></li>
<li><a href="#configure-disk-utilization-notifications">Configure Disk Utilization Notifications</a></li>
<li><a href="#configure-authentication-notifications">Configure Authentication Notifications</a></li>
</ul></li>
<li><a href="#snmptrapd-conf">snmptrapd.conf</a></li>
</ul></li>
<li><a href="#supported-mibs">Supported MIBs</a></li>
<li><a href="#pass-persist-scripts">Pass Persist Scripts</a></li>
<li><a href="#troubleshooting">Troubleshooting</a></li>
<li><a href="#attachments">Attachments:</a></li>
</ul></li>
</ul>
</nav>
  </aside>



  </main>

  
  
</body>

</html>
