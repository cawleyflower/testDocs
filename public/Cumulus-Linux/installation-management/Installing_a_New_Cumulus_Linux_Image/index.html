<!DOCTYPE html><html>

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Installing a New Cumulus Linux Image | Cumulus Networks Documentation</title>

<link href="https://fonts.googleapis.com/css?family=Oxygen|Oxygen+Mono:300,400,700" rel="stylesheet">
<link rel="stylesheet" href="/normalize.min.css">

<link rel="stylesheet" href="/book.min.50a619ce4c0e99594908d162684f42218608aa6fde2bd83cca5025d59ba535e3.css">

<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>

<body>
  <input type="checkbox" style="display: none" id="menu-control" />
  <main class="flex container">

    <aside class="book-menu fixed">
      <nav role="navigation">
<h2 class="book-brand">
  <a href="http://example.org/">Cumulus Networks Documentation</a>
</h2>



    


  
  
    
  
 
  <ul>
    
    <li><a href="/Cumulus-Linux/installation-management/">
    Installation Management</a> 
  <ul>
    

    
    <li>
      <a href="/Cumulus-Linux/installation-management/Adding_and_Updating_Packages/">Adding and Updating Packages</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/installation-management/Installing_a_New_Cumulus_Linux_Image/" class="active">Installing a New Cumulus Linux Image</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/installation-management/Managing_Cumulus_Linux_Disk_Images/">Managing Cumulus Linux Disk Images</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/installation-management/Upgrading_Cumulus_Linux/">Upgrading Cumulus Linux</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/installation-management/Using_Snapshots/">Using Snapshots</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/installation-management/Zero_Touch_Provisioning_-_ZTP/">Zero Touch Provisioning Z T P</a>
    </li>
    
  </ul>

    </li>
    

    
    <li>
      <a href="/Cumulus-Linux/whats-new/">What&#39;s New</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/Quick_Start_Guide/">Quick Start Guide</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Network_Command_Line_Utility_-_NCLU/">Network Command Line Utility N C L U</a>
    </li>
    
    <li>
      <a href="/Cumulus-Linux/system-config/Setting_Date_and_Time/">Setting Date and Time</a>
    </li>
    
  </ul>
 
  <ul>
    
    <li><a href="/NetQ/UI_User_Guide/">
    U I User Guide</a> 
  <ul>
    
    <li><a href="/NetQ/UI_User_Guide/monitor_the_network/">
    Monitor the Network</a> 
  <ul>
    

    
    <li>
      <a href="/NetQ/UI_User_Guide/monitor_the_network/monitor_alarm_events/Monitor_Alarm_Events/">Monitor Alarm Events</a>
    </li>
    
    <li>
      <a href="/NetQ/UI_User_Guide/monitor_the_network/monitor_informational_events/Monitor_Informational_Events/">Monitor Informational Events</a>
    </li>
    
    <li>
      <a href="/NetQ/UI_User_Guide/monitor_the_network/monitor_network_health/Monitor_Network_Health/">Monitor Network Health</a>
    </li>
    
    <li>
      <a href="/NetQ/UI_User_Guide/monitor_the_network/monitor_network_inventory/Monitor_Network_Inventory/">Monitor Network Inventory</a>
    </li>
    
    <li>
      <a href="/NetQ/UI_User_Guide/monitor_the_network/monitor_network_protocols/Monitor_Network_Layer_Protocols/">Monitor Network Layer Protocols</a>
    </li>
    
  </ul>

    </li>
    

    
    <li>
      <a href="/NetQ/UI_User_Guide/monitor_switches/Monitor_Switches/">Monitor Switches</a>
    </li>
    
    <li>
      <a href="/NetQ/UI_User_Guide/netq_ui_overview/NetQ_User_Interface_Overview/">Net Q User Interface Overview</a>
    </li>
    
    <li>
      <a href="/NetQ/UI_User_Guide/ui_preface/UI_Preface/">U I Preface</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/NetQ/cli_user_guide/">
    Cli User Guide</a> 
  <ul>
    

    
    <li>
      <a href="/NetQ/cli_user_guide/CLI_Preface/CLI_Preface/">C L I Preface</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/automate_common_tasks/Automate_Common_and_Repetitive_Tasks/">Automate Common and Repetitive Tasks</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/command_line_overview/NetQ_Command_Line_Overview/">Net Q Command Line Overview</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/monitor_containter_environments/Monitor_Container_Environments/">Monitor Container Environments</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/monitor_data_link_layer/Monitor_Data_Link_Layer_Devices_and_Protocols/">Monitor Data Link Layer Devices and Protocols</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/monitor_linux_hosts/Monitor_Linux_Hosts/">Monitor Linux Hosts</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/monitor_network_health/Monitor_Overall_Network_Health/">Monitor Overall Network Health</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/monitor_network_layer/Monitor_Network_Protocols_and_Services/">Monitor Network Protocols and Services</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/monitor_physical_layer/Monitor_Physical_Layer_Components/">Monitor Physical Layer Components</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/monitor_switch_hardware/Monitor_Switch_Hardware_and_Software/">Monitor Switch Hardware and Software</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/monitor_virtual_overlays/Monitor_Virtual_Network_Overlays/">Monitor Virtual Network Overlays</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/resolve_issues/Resolve_Issues/">Resolve Issues</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/resolve_issues/Resolve_MLAG_Issues/">Resolve M L a G Issues</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/resolve_issues/investiage_netq_issues/Investigate_NetQ_Issues/">Investigate Net Q Issues</a>
    </li>
    
    <li>
      <a href="/NetQ/cli_user_guide/resolve_issues/methods_for_diagnosing_issues/Methods_for_Diagnosing_Network_Issues/">Methods for Diagnosing Network Issues</a>
    </li>
    
  </ul>

    </li>
    
    <li><a href="/NetQ/deployment_guide/">
    Deployment Guide</a> 
  <ul>
    

    
    <li>
      <a href="/NetQ/deployment_guide/config_optional_netq/Configuring_Optional_NetQ_Capabilities/">Configuring Optional Net Q Capabilities</a>
    </li>
    
    <li>
      <a href="/NetQ/deployment_guide/deployment_preface/Deployment_Preface/">Deployment Preface</a>
    </li>
    
    <li>
      <a href="/NetQ/deployment_guide/install_netq/Install_NetQ/">Install Net Q</a>
    </li>
    
    <li>
      <a href="/NetQ/deployment_guide/maintain_netq/Maintain_NetQ/">Maintain Net Q</a>
    </li>
    
    <li>
      <a href="/NetQ/deployment_guide/netq_primer/Cumulus_NetQ_Primer/">Cumulus Net Q Primer</a>
    </li>
    
  </ul>

    </li>
    

    
    <li>
      <a href="/NetQ/Release_Notes/Cumulus_NetQ_2.0_Release_Notes/">Cumulus Net Q 2.0 Release Notes</a>
    </li>
    
    <li>
      <a href="/NetQ/getting_started/Getting_Started_with_the_Cumulus_NetQ_Appliance/">Getting Started With the Cumulus Net Q Appliance</a>
    </li>
    
    <li>
      <a href="/NetQ/software_installation_guide/Cumulus_NetQ_Appliance_Software_Installation_Guide/">Cumulus Net Q Appliance Software Installation Guide</a>
    </li>
    
  </ul>








</nav>

    </aside>

    <div class="book-page">
      <header class="align-center justify-between book-header">
  <label for="menu-control">
    <img src="/svg/menu.svg" />
  </label>
  <strong>Installing a New Cumulus Linux Image</strong>
</header>

      
<article class="markdown">

<h1 id="installing-a-new-cumulus-linux-image">Installing a New Cumulus Linux Image</h1>

<p>This topic discusses how to install a new Cumulus Linux disk image
using <a href="http://www.onie.org/">ONIE</a>, an open source project (equivalent
to PXE on servers) that enables the installation of network operating
systems (NOS) on bare metal switches.</p>

<p>Before you install Cumulus Linux, the switch can be in two different
states:</p>

<ul>
<li>No image is installed on the switch (the switch is only
running ONIE).</li>
<li>Cumulus Linux is already installed on the switch but you want to use
ONIE to reinstall Cumulus Linux or upgrade to a newer version.</li>
</ul>

<p>The sections below describe some of the different ways you can install
the Cumulus Linux disk image, such as using a DHCP/web server, FTP, a
local file, or a USB drive. Steps are provided for both installing
directly from ONIE (if no image is installed on the switch) and from
Cumulus Linux (if the image is already installed on the switch), where
applicable. For additional methods to find and install the Cumulus Linux
image, see the <a href="http://opencomputeproject.github.io/onie/design-spec/discovery.html">ONIE Design
Specification</a>. </p>

<p>You can download a Cumulus Linux image from the <a href="http://cumulusnetworks.com/downloads/">Cumulus Networks
Downloads page</a>.</p>

<p>Installing the Cumulus Linux disk image is destructive; configuration
files on the switch are not saved; copy them to a different server
before installing.</p>

<h2 id="contents">Contents</h2>

<p><img src="images/icons/grey_arrow_down.png" alt="" />{.expand-control-image}This topic
describes &hellip;</p>

<ul>
<li><a href="#InstallingaNewCumulusLinuxImage-dhcp_optionsInstallUsingaDHCP/WebServerwithDHCPOptions">Install Using a DHCP/Web Server with DHCP
Options</a></li>
<li><a href="#InstallingaNewCumulusLinuxImage-dhcp_nooptsInstallUsingaDHCP/WebServerwithoutDHCPOptions">Install Using a DHCP/Web Server without DHCP
Options</a></li>
<li><a href="#InstallingaNewCumulusLinuxImage-web_nodhcpInstallUsingaWebServerwithnoDHCP">Install Using a Web Server with no
DHCP</a></li>
<li><a href="#InstallingaNewCumulusLinuxImage-ftpInstallUsingFTPWithoutaWebServer">Install Using FTP Without a Web
Server</a></li>
<li><a href="#InstallingaNewCumulusLinuxImage-localInstallUsingaLocalFile">Install Using a Local
File</a></li>
<li><a href="#InstallingaNewCumulusLinuxImage-usbInstallUsingaUSBDrive">Install Using a USB
Drive</a>

<ul>
<li><a href="#InstallingaNewCumulusLinuxImage-PrepareforUSBInstallation">Prepare for USB
Installation</a></li>
<li><a href="#InstallingaNewCumulusLinuxImage-Instructionsforx86Platforms">Instructions for x86
Platforms</a></li>
<li><a href="#InstallingaNewCumulusLinuxImage-InstructionsforARMPlatforms">Instructions for ARM
Platforms</a></li>
</ul></li>
<li><a href="#InstallingaNewCumulusLinuxImage-RelatedInformation">Related
Information</a></li>
</ul>

<p>In the following procedures:</p>

<ul>
<li>You can name your Cumulus Linux installer disk image using any of
the <a href="http://opencomputeproject.github.io/onie/design-spec/discovery.html#default-file-name-search-order">ONIE naming schemes mentioned
here</a>.</li>
<li>In the example commands, <code>[PLATFORM]</code> can be any supported Cumulus
Linux platform, such as <em>x86_64</em>, or <em>arm</em>.</li>
<li>Run the <code>sudo onie-install -h</code> command to show the ONIE installer
options.</li>
<li>After you install the Cumulus Linux disk image, you need to install
the license file. Refer to <a href="Quick-Start-Guide_8362542.html#QuickStartGuide-install-license">Install the
License</a>.</li>
</ul>

<h2 id="install-using-a-dhcp-web-server-with-dhcp-options">Install Using a DHCP/Web Server with DHCP Options</h2>

<p>To install Cumulus Linux using a DHCP/web server *with* DHCP options,
set up a DHCP/web server on your laptop and connect the eth0
management port of the switch to your laptop. After you connect the
cable, the installation proceeds as follows:</p>

<ol>
<li>The bare metal switch boots up and requests an IP address (DHCP
request).</li>
<li>The DHCP server acknowledges and responds with DHCP option 114 and
the location of the installation image.</li>
<li>ONIE downloads the Cumulus Linux disk image, installs, and reboots.</li>
<li>Success! You are now running Cumulus Linux.<br />
<img src="attachments/8362643/8362642.png" alt="" /></li>
</ol>

<p>The most common method is to send DHCP option 114 with the entire URL to
the web server (this can be the same system). However, there are many
other ways to use DHCP even if you do not have full control over
DHCP. <a href="https://opencomputeproject.github.io/onie/design-spec/discovery.html#partial-installer-urls">See the ONIE user
guide</a>
for help.</p>

<p>Here is an example DHCP configuration with an <a href="http://www.isc.org/downloads/dhcp/">ISC DHCP
server</a>:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">subnet 172.0.24.0 netmask 255.255.255.0 {
  range 172.0.24.20 172.0.24.200;
  option default-url = &#34;http://172.0.24.14/onie-installer-[PLATFORM]&#34;;
}</code></pre></div>
<p>Here is an example DHCP configuration
with <a href="http://www.thekelleys.org.uk/dnsmasq/doc.html">dnsmasq</a> (static
address assignment):</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">dhcp-host=sw4,192.168.100.14,6c:64:1a:00:03:ba,set:sw4
dhcp-option=tag:sw4,114,&#34;http://roz.rtplab.test/onie-installer-[PLATFORM]&#34;</code></pre></div>
<p>If you do not have a web server, you can use <a href="index">this free Apache
example</a>.</p>

<h2 id="install-using-a-dhcp-web-server-without-dhcp-options">Install Using a DHCP/Web Server without DHCP Options</h2>

<p>Follow the steps below if you have a laptop on the same network and the
switch can pull DHCP from the corporate network, but you *cannot* modify
DHCP options (maybe it is controlled by another team).</p>

<p><img src="images/icons/grey_arrow_down.png" alt="" />{.expand-control-image}Install from
ONIE</p>

<ol>
<li><p>Place the Cumulus Linux disk image in a directory on the web server.</p></li>

<li><p>Run the <code>onie-nos-install</code> command:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">ONIE:/ #onie-nos-install http://10.0.1.251/path/to/cumulus-install-[PLATFORM].bin</code></pre></div></li>
</ol>

<p><img src="images/icons/grey_arrow_down.png" alt="" />{.expand-control-image}Install from
Cumulus Linux</p>

<ol>
<li><p>Place the Cumulus Linux disk image in a directory on the web server.</p></li>

<li><p>From the Cumulus Linux command prompt, run the <code>onie-install</code>
command:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ sudo onie-install -a -i http://10.0.1.251/path/to/cumulus-install-[PLATFORM].bin &amp;&amp; sudo reboot</code></pre></div></li>
</ol>

<h2 id="install-using-a-web-server-with-no-dhcp">Install Using a Web Server with no DHCP</h2>

<p>Follow the steps below if your laptop is on the same network as the
switch eth0 interface but *no* DHCP server is available.</p>

<p><img src="images/icons/grey_arrow_down.png" alt="" />{.expand-control-image}Install from
ONIE</p>

<ol>
<li><p>ONIE is in <a href="http://opencomputeproject.github.io/onie/design-spec/discovery.html#installer-discovery-methods"><em>discovery
mode</em></a>.
You must disable discovery mode with the following command:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">onie# onie-discovery-stop</code></pre></div>
<p>On older ONIE versions, if the <code>onie-discovery-stop</code> command is not
supported, run:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">onie# /etc/init.d/discover.sh stop</code></pre></div></li>

<li><p>Assign a static address to eth0 with the <code>ip addr add</code> command:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">ONIE:/ #ip addr add 10.0.1.252/24 dev eth0</code></pre></div></li>

<li><p>Place the Cumulus Linux disk image in a directory on your web
server.</p></li>

<li><p>Run the installer manually (because there are no DHCP options):</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">ONIE:/ #onie-nos-install http://10.0.1.251/path/to/cumulus-install-[PLATFORM].bin</code></pre></div></li>
</ol>

<p><img src="images/icons/grey_arrow_down.png" alt="" />{.expand-control-image}Install from
Cumulus Linux</p>

<ol>
<li>Place the Cumulus Linux disk image in a directory on your web
server.</li>

<li><p>From the Cumulus Linux command prompt, run the <code>onie-install</code>
command:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ sudo onie-install -a -i http://10.0.1.251/path/to/cumulus-install-[PLATFORM].bin &amp;&amp; sudo reboot</code></pre></div></li>
</ol>

<h2 id="install-using-ftp-without-a-web-server">Install Using FTP Without a Web Server</h2>

<p>Follow the steps below if your laptop is on the same network as the
switch eth0 interface but *no* DHCP server is available.</p>

<p><img src="images/icons/grey_arrow_down.png" alt="" />{.expand-control-image}Install from
ONIE</p>

<ol>
<li><p>Set up DHCP or static addressing for eth0. The following example
assigns a static address to eth0:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">ONIE:/ #ip addr add 10.0.1.252/24 dev eth0</code></pre></div></li>

<li><p>If you are using static addressing, disable ONIE discovery mode:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">onie# onie-discovery-stop</code></pre></div>
<p>On older ONIE versions, if the <code>onie-discovery-stop</code> command is not
supported, run:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">onie# /etc/init.d/discover.sh stop</code></pre></div></li>

<li><p>Place the Cumulus Linux disk image into a TFTP or FTP directory.</p></li>

<li><p>If you are not using DHCP options, run one of the following commands
(<code>tftp</code> for TFTP or <code>ftp</code> for FTP):</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">ONIE# onie-nos-install ftp://local-ftp-server/cumulus-install-[PLATFORM].bin

ONIE# onie-nos-install tftp://local-tftp-server/cumulus-install-[PLATFORM].bin</code></pre></div></li>
</ol>

<p><img src="images/icons/grey_arrow_down.png" alt="" />{.expand-control-image}Install from
Cumulus Linux</p>

<ol>
<li>Place the Cumulus Linux disk image into a TFTP or FTP directory.</li>

<li><p>From the Cumulus Linux command prompt, run one of the
following commands (<code>tftp</code> for TFTP or <code>ftp</code> for FTP):</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ sudo onie-install -a -i ftp://local-ftp-server/cumulus-install-[PLATFORM].bin &amp;&amp; sudo reboot
 
cumulus@switch:~$ sudo onie-install -a -i tftp://local-ftp-server/cumulus-install-[PLATFORM].bin &amp;&amp; sudo reboot</code></pre></div></li>
</ol>

<h2 id="install-using-a-local-file">Install Using a Local File</h2>

<p>Follow the steps below to install the disk image referencing a local
file. </p>

<p><img src="images/icons/grey_arrow_down.png" alt="" />{.expand-control-image}Install from
ONIE</p>

<ol>
<li><p>Set up DHCP or static addressing for eth0. The following example
assigns a static address to eth0:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">ONIE:/ #ip addr add 10.0.1.252/24 dev eth0</code></pre></div></li>

<li><p>If you are using static addressing, disable ONIE discovery mode.</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">onie# onie-discovery-stop</code></pre></div>
<p>On older ONIE versions, if the <code>onie-discovery-stop</code> command is not
supported, run:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">onie# /etc/init.d/discover.sh stop</code></pre></div></li>

<li><p>Use <a href="http://en.wikipedia.org/wiki/Secure_copy">scp</a> to copy the
Cumulus Linux disk image to the switch. (Windows users can
use <a href="http://winscp.net/eng/index.php">WinScp</a>.)</p></li>

<li><p>Run the installer manually from ONIE:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">ONIE:/ #onie-nos-install /path/to/local/file/cumulus-install-[PLATFORM].bin</code></pre></div></li>
</ol>

<p><img src="images/icons/grey_arrow_down.png" alt="" />{.expand-control-image}Install from
Cumulus Linux</p>

<ol>
<li><p>Copy the Cumulus Linux disk image to the switch.</p></li>

<li><p>From the Cumulus Linux command prompt, run the <code>onie-install</code>
command:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">cumulus@switch:~$ sudo onie-install -a -i /path/to/local/file/cumulus-install-[PLATFORM].bin &amp;&amp; sudo reboot</code></pre></div></li>
</ol>

<h2 id="install-using-a-usb-drive">Install Using a USB Drive</h2>

<p>Follow the steps below to install the Cumulus Linux disk image using a
USB drive. Instructions are provided for x86 and ARM platforms.</p>

<p>Tips</p>

<ul>
<li>Installing Cumulus Linux using a USB drive is fine for a single
switch here and there but is not scalable. DHCP can scale to
hundreds of switch installs with zero manual input unlike USB
installs.</li>
<li>Cumulus Networks also provides Cumulus on a Stick, which packages
Cumulus Linux images with your license. You can download your
personalized ZIP file, transfer it to a USB drive, insert the drive
into your switch, apply power, and you are ready to go. See Cumulus
on a Stick for information.</li>
</ul>

<h3 id="prepare-for-usb-installation">Prepare for USB Installation</h3>

<ol>
<li>From the <a href="http://cumulusnetworks.com/downloads/">Cumulus Networks Downloads
page</a>, download the
appropriate Cumulus Linux image for your x86 or ARM platform.</li>

<li><p>From a computer, prepare your USB drive by formatting it using one
of the supported formats: FAT32, vFAT or EXT2. </p>

<p><img src="images/icons/grey_arrow_down.png" alt="" />{.expand-control-image}Optional:
Prepare a USB Drive inside Cumulus Linux</p>

<table>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="odd">
<td><div>
<div>
<p>Use caution when performing the actions below; it is possible to severely damage your system with the following utilities.</p>
</div>
</div>
<ol>
<li>Insert your USB drive into the USB port on the switch running Cumulus Linux and log in to the switch.</li>
<li><p>Examine output from <code>cat /proc/partitions</code> and <code>sudo fdisk -l [device]</code> to determine on which device your USB drive can be found. For example, <code>sudo fdisk -l /dev/sdb</code>.</p>
<div>
<div>
<p>These instructions assume your USB drive is the <code>/dev/sdb</code> device, which is typical if you insert the USB drive after the machine is already booted. However, if you insert the USB drive during the boot process, it is possible that your USB drive is the <code>/dev/sda</code> device. Make sure to modify the commands below to use the proper device for your USB drive.</p>
</div>
</div></li>
<li><p>Create a new partition table on the USB drive:</p>
<div class="code panel pdl" style="border-width: 1px;">
<div class="codeContent panelContent pdl">
<pre class="text" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence" style="brush: text; gutter: false; theme: Confluence"><code>sudo parted /dev/sdb mklabel msdos</code></pre>
</div>
</div>
<div>
<div>
<p>The <code>parted</code> utility should already be installed. However, if it is not, install it with: <code>sudo -E apt-get install parted</code></p>
</div>
</div></li>
<li><p>Create a new partition on the USB drive:</p>
<div class="code panel pdl" style="border-width: 1px;">
<div class="codeContent panelContent pdl">
<pre class="text" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence" style="brush: text; gutter: false; theme: Confluence"><code>sudo parted /dev/sdb -a optimal mkpart primary 0% 100%</code></pre>
</div>
</div></li>
<li><p>Format the partition to your filesystem of choice using <em>one</em> of the examples below:</p>
<div class="code panel pdl" style="border-width: 1px;">
<div class="codeContent panelContent pdl">
<pre class="text" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence" style="brush: text; gutter: false; theme: Confluence"><code>sudo mkfs.ext2 /dev/sdb1
sudo mkfs.msdos -F 32 /dev/sdb1
sudo mkfs.vfat /dev/sdb1</code></pre>
</div>
</div>
<div>
<div>
<p>To use <code>mkfs.msdos</code> or <code>mkfs.vfat</code>, you need to install the <code>dosfstools</code> package from the <a href="http://docs.cumulusnetworks.com/display/DOCS/Adding+and+Updating+Packages#AddingandUpdatingPackages-AddingPackagesfromAnotherRepository">Debian software repositories</a>, as they are not included by default.</p>
</div>
</div></li>
<li><p>To continue installing Cumulus Linux, mount the USB drive to move files.</p>
<div class="code panel pdl" style="border-width: 1px;">
<div class="codeContent panelContent pdl">
<pre class="text" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence" style="brush: text; gutter: false; theme: Confluence"><code>sudo mkdir /mnt/usb
sudo mount /dev/sdb1 /mnt/usb</code></pre>
</div>
</div></li>
</ol></td>
</tr>
</tbody>
</table>

<p> </p>

<hr />

<p> </p></li>

<li><p>Copy the Cumulus Linux disk image to the USB drive, then rename the
image file to:</p>

<ul>
<li><code>onie-installer-x86_64</code>, if installing on an x86 platform</li>
<li><code>onie-installer-arm</code>, if installing on an ARM platform</li>
</ul>

<p>You can also use any of the <a href="http://opencomputeproject.github.io/onie/design-spec/discovery.html#default-file-name-search-order">ONIE naming schemes mentioned
here</a>.</p>

<p>When using a Mac or Windows computer to rename the installation
file, the file extension might still be present. Make sure to remove
the file extension otherwise ONIE is not able to detect the file.</p></li>

<li><p>Insert the USB drive into the switch, then continue with the
appropriate instructions below for your x86 or ARM platform.</p></li>
</ol>

<h3 id="instructions-for-x86-platforms">Instructions for x86 Platforms</h3>

<p><img src="images/icons/grey_arrow_down.png" alt="" />{.expand-control-image}Click to
expand x86 instructions&hellip;</p>

<ol>
<li><p>Prepare the switch for installation:</p>

<ul>
<li>If the switch is offline, connect to the console and power on
the switch.</li>
<li>If the switch is already online in ONIE, use the <code>reboot</code>
command.</li>
</ul>

<p>SSH sessions to the switch get dropped after this step. To complete
the remaining instructions, connect to the console of the switch.
Cumulus Linux switches display their boot process to the console;
you need to monitor the console specifically to complete the next
step.</p></li>

<li><p>Monitor the console and select the ONIE option from the first GRUB
screen shown below.<br />
<img src="attachments/8362643/8365605.png" alt="" />{width=&ldquo;480&rdquo; height=&ldquo;250&rdquo;}</p></li>

<li><p>Cumulus Linux on x86 uses GRUB chainloading to present a second GRUB
menu specific to the ONIE partition. No action is necessary in this
menu to select the default option <em>ONIE: Install OS</em>.<br />
<img src="attachments/8362643/8365607.png" alt="" />{width=&ldquo;524&rdquo; height=&ldquo;250&rdquo;}</p></li>

<li><p>The USB drive is recognized and mounted automatically. The image
file is located and automatic installation of Cumulus Linux begins.
Here is some sample output:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">ONIE: OS Install Mode  ...

Version : quanta_common_rangeley-2014.05.05-6919d98-201410171013
Build  Date: 2014-10-17T10:13+0800
Info: Mounting kernel filesystems...  done.
Info: Mounting LABEL=ONIE-BOOT on /mnt/onie-boot  ...
initializing eth0...
scsi 6:0:0:0: Direct-Access  SanDisk Cruzer Facet 1.26 PQ: 0 ANSI: 6
sd 6:0:0:0: [sdb] 31266816 512-byte logical blocks: (16.0 GB/14.9 GiB)
sd 6:0:0:0: [sdb] Write Protect is off
sd 6:0:0:0: [sdb] Write cache: disabled, read cache: enabled, doesn&#39;t support DPO or FUA
sd 6:0:0:0: [sdb] Attached SCSI disk

&lt;...snip...&gt;

ONIE:  Executing installer: file://dev/sdb1/onie-installer-x86_64
Verifying image checksum ... OK.
Preparing image archive ... OK.
Dumping image info...
Control File Contents
=====================
Description: Cumulus  Linux
OS-Release:  3.0.0-3b46bef-201509041633-build
Architecture: amd64
Date:  Fri, 27 May 2016 17:10:30 -0700
Installer-Version:  1.2
Platforms: accton_as5712_54x accton_as6712_32x  mlx_sx1400_i73612 dell_s6000_s1220 dell_s4000_c2338 dell_s3000_c2338  cel_redstone_xp cel_smallstone_xp cel_pebble quanta_panther  quanta_ly8_rangeley quanta_ly6_rangeley quanta_ly9_rangeley  
Homepage: http://www.cumulusnetworks.com/</code></pre></div></li>

<li><p>After installation completes, the switch automatically reboots into
the newly installed instance of Cumulus Linux.</p></li>
</ol>

<h3 id="instructions-for-arm-platforms">Instructions for ARM Platforms</h3>

<p><img src="images/icons/grey_arrow_down.png" alt="" />{.expand-control-image}Click to
expand ARM instructions&hellip;</p>

<ol>
<li><p>Prepare the switch for installation:</p>

<ul>
<li><p>If the switch is offline, connect to the console and power on
the switch.</p></li>

<li><p>If the switch is already online in ONIE, use the <code>reboot</code>
command.</p></li>
</ul>

<p>SSH sessions to the switch get dropped after this step. To complete
the remaining instructions, connect to the console of the switch.
Cumulus Linux switches display their boot process to the console;
you need to monitor the console specifically to complete the next
step.</p></li>

<li><p>Interrupt the normal boot process before the countdown (shown below)
completes. Press any key to stop the autoboot.</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">U-Boot 2013.01-00016-gddbf4a9-dirty (Feb 14 2014 - 16:30:46) Accton: 1.4.0.5

CPU0: P2020, Version: 2.1, (0x80e20021)
Core: E500, Version: 5.1, (0x80211051)
Clock Configuration:
 CPU0:1200 MHz, CPU1:1200 MHz, 
 CCB:600 MHz,
 DDR:400 MHz (800 MT/s data rate) (Asynchronous), LBC:37.500 MHz
L1: D-cache 32 kB enabled
 I-cache 32 kB enabled

&lt;...snip…&gt;

USB: USB2513 hub OK
Hit any key to stop autoboot: 0</code></pre></div></li>

<li><p>A command prompt appears so that you can run commands. Execute the
following command:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">run onie_bootcmd</code></pre></div></li>

<li><p>The USB drive is recognized and mounted automatically. The image
file is located and automatic installation of Cumulus Linux begins.
Here is some sample output:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">Loading Open Network Install Environment …
Platform: arm-as4610_54p-r0
Version : 1.6.1.3
WARNING: adjusting available memory to 30000000
## Booting kernel from Legacy Image at ec040000 …
   Image Name:   as6701_32x.1.6.1.3
   Image Type:   ARM Linux Multi-File Image (gzip compressed)
   Data Size:    4456555 Bytes = 4.3 MiB
   Load Address: 00000000
   Entry Point:  00000000
   Contents:
      Image 0: 3738543 Bytes = 3.6 MiB
      Image 1: 706440 Bytes = 689.9 KiB
      Image 2: 11555 Bytes = 11.3 KiB
   Verifying Checksum ... OK
## Loading init Ramdisk from multi component Legacy Image at ec040000 …
## Flattened Device Tree from multi component Image at EC040000
   Booting using the fdt at 0xec47d388
   Uncompressing Multi-File Image ... OK
   Loading Ramdisk to 2ff53000, end 2ffff788 ... OK
   Loading Device Tree to 03ffa000, end 03fffd22 ... OK

&lt;...snip...&gt;

ONIE: Starting ONIE Service Discovery
ONIE: Executing installer: file://dev/sdb1/onie-installer-arm
Verifying image checksum ... OK.
Preparing image archive ... OK.
Dumping image info…
Control File Contents
=====================
Description: Cumulus Linux
OS-Release: 3.0.0-3b46bef-201509041633-build
Architecture: arm
Date: Fri, 27 May 2016 17:08:35 -0700
Installer-Version: 1.2
Platforms: accton_as4600_54t, accton_as6701_32x, accton_5652, accton_as5610_52x, dni_6448, dni_7448, dni_c7448n, cel_kennisis, cel_redstone, cel_smallstone, cumulus_p2020, quanta_lb9, quanta_ly2, quanta_ly2r, quanta_ly6_p2020
Homepage: http://www.cumulusnetworks.com/</code></pre></div></li>

<li><p>After installation completes, the switch automatically reboots into
the newly installed instance of Cumulus Linux.</p></li>
</ol>

<h2 id="related-information">Related Information</h2>

<ul>
<li><a href="http://opencomputeproject.github.io/onie/design-spec/">ONIE Design
Specification</a></li>
<li><a href="http://cumulusnetworks.com/downloads/">Cumulus Networks Downloads
page</a></li>
<li><a href="https://cumulusnetworks.com/cumulus-on-a-stick/">Cumulus on a
Stick</a></li>
<li><a href="Managing_Cumulus_Linux_Disk_Images">Managing Cumulus Linux Disk
Images</a></li>
</ul>

<p> </p>

<h2 id="attachments">Attachments:</h2>

<p><img src="images/icons/bullet_blue.gif" alt="" />{width=&ldquo;8&rdquo; height=&ldquo;8&rdquo;}
<a href="attachments/8362643/8362644.png">png_base64c818ed9707a3041b.png</a>
(image/png)<br />
<img src="images/icons/bullet_blue.gif" alt="" />{width=&ldquo;8&rdquo; height=&ldquo;8&rdquo;}
<a href="attachments/8362643/8362645.png">png_base64fcca65644256ad41.png</a>
(image/png)<br />
<img src="images/icons/bullet_blue.gif" alt="" />{width=&ldquo;8&rdquo; height=&ldquo;8&rdquo;} <a href="attachments/8362643/8362646.png">Screen Shot
2015-09-14 at 3.47.19 PM.png</a>
(image/png)<br />
<img src="images/icons/bullet_blue.gif" alt="" />{width=&ldquo;8&rdquo; height=&ldquo;8&rdquo;}
<a href="attachments/8362643/8362642.png">onie_install_dhcp.png</a> (image/png)<br />
<img src="images/icons/bullet_blue.gif" alt="" />{width=&ldquo;8&rdquo; height=&ldquo;8&rdquo;}
<a href="attachments/8362643/8365608.png">GNUx86.png</a> (image/png)<br />
<img src="images/icons/bullet_blue.gif" alt="" />{width=&ldquo;8&rdquo; height=&ldquo;8&rdquo;}
<a href="attachments/8362643/8365609.png">2GNUx86.png</a> (image/png)<br />
<img src="images/icons/bullet_blue.gif" alt="" />{width=&ldquo;8&rdquo; height=&ldquo;8&rdquo;}
<a href="attachments/8362643/8365610.png">GNUx86.png</a> (image/png)<br />
<img src="images/icons/bullet_blue.gif" alt="" />{width=&ldquo;8&rdquo; height=&ldquo;8&rdquo;}
<a href="attachments/8362643/8365611.png">2GNUx86.png</a> (image/png)<br />
<img src="images/icons/bullet_blue.gif" alt="" />{width=&ldquo;8&rdquo; height=&ldquo;8&rdquo;}
<a href="attachments/8362643/8365612.png">GNUx86.png</a> (image/png)<br />
<img src="images/icons/bullet_blue.gif" alt="" />{width=&ldquo;8&rdquo; height=&ldquo;8&rdquo;}
<a href="attachments/8362643/8365607.png">2GNUx86.png</a> (image/png)<br />
<img src="images/icons/bullet_blue.gif" alt="" />{width=&ldquo;8&rdquo; height=&ldquo;8&rdquo;}
<a href="attachments/8362643/8365605.png">GNUx86.png</a> (image/png)</p>
</article>

      

    </div>

    
  
  
  <aside class="book-toc fixed">
    <nav id="TableOfContents">
<ul>
<li><a href="#installing-a-new-cumulus-linux-image">Installing a New Cumulus Linux Image</a>
<ul>
<li><a href="#contents">Contents</a></li>
<li><a href="#install-using-a-dhcp-web-server-with-dhcp-options">Install Using a DHCP/Web Server with DHCP Options</a></li>
<li><a href="#install-using-a-dhcp-web-server-without-dhcp-options">Install Using a DHCP/Web Server without DHCP Options</a></li>
<li><a href="#install-using-a-web-server-with-no-dhcp">Install Using a Web Server with no DHCP</a></li>
<li><a href="#install-using-ftp-without-a-web-server">Install Using FTP Without a Web Server</a></li>
<li><a href="#install-using-a-local-file">Install Using a Local File</a></li>
<li><a href="#install-using-a-usb-drive">Install Using a USB Drive</a>
<ul>
<li><a href="#prepare-for-usb-installation">Prepare for USB Installation</a></li>
<li><a href="#instructions-for-x86-platforms">Instructions for x86 Platforms</a></li>
<li><a href="#instructions-for-arm-platforms">Instructions for ARM Platforms</a></li>
</ul></li>
<li><a href="#related-information">Related Information</a></li>
<li><a href="#attachments">Attachments:</a></li>
</ul></li>
</ul>
</nav>
  </aside>



  </main>

  
  
</body>

</html>
